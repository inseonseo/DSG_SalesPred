{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "8557d411",
   "metadata": {},
   "source": [
    "# 자연어 처리를 통한 EDA, Data Analysis, Visualization"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "cd48cd3a",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>제품</th>\n",
       "      <th>제품특성</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>B002-03509-00001</td>\n",
       "      <td>제품유형:일반식품 콜라겐 펩타이드:1000mg 종류:어류 분자량:300Da 섭취대상...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>B002-02376-00001</td>\n",
       "      <td>700mg x 28정</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>B002-03735-00001</td>\n",
       "      <td>제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 두 번 1일 총 섭...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>B002-03735-00003</td>\n",
       "      <td>제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 섭...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>B002-02769-00001</td>\n",
       "      <td>HCA:900mg 영양소 원료명(식약처고시):비타민B1 영양소 원료명(식약처고시):...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12773</th>\n",
       "      <td>B002-01994-00001</td>\n",
       "      <td>형태:액상형 구성:리필 등급:1종 용도:식기 용도:과일 용도:야채 용도:조리기구 용...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12774</th>\n",
       "      <td>B002-02600-00002</td>\n",
       "      <td>헤어타입:모든 모발용 주요제품특징:머릿결개선 세부제품특징:촉촉함(수분공급) 세부제품...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12775</th>\n",
       "      <td>B002-02372-00095</td>\n",
       "      <td>사용대상:여성용 타입:일자형 흡수량:20ml :1팩 32개</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12776</th>\n",
       "      <td>B002-01318-00002</td>\n",
       "      <td>피부타입:모든피부용 향계열:무향 주요제품특징:촉촉함(수분공급) 주요제품특징:풍부한 ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12777</th>\n",
       "      <td>B002-02473-00064</td>\n",
       "      <td>최소연령:4개월 단계별:2단계 종류:일반분유 제품형태:분말 포장형태:캔 용량:800...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>12778 rows × 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                     제품                                               제품특성\n",
       "0      B002-03509-00001  제품유형:일반식품 콜라겐 펩타이드:1000mg 종류:어류 분자량:300Da 섭취대상...\n",
       "1      B002-02376-00001                                        700mg x 28정\n",
       "2      B002-03735-00001  제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 두 번 1일 총 섭...\n",
       "3      B002-03735-00003  제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 섭...\n",
       "4      B002-02769-00001  HCA:900mg 영양소 원료명(식약처고시):비타민B1 영양소 원료명(식약처고시):...\n",
       "...                 ...                                                ...\n",
       "12773  B002-01994-00001  형태:액상형 구성:리필 등급:1종 용도:식기 용도:과일 용도:야채 용도:조리기구 용...\n",
       "12774  B002-02600-00002  헤어타입:모든 모발용 주요제품특징:머릿결개선 세부제품특징:촉촉함(수분공급) 세부제품...\n",
       "12775  B002-02372-00095                   사용대상:여성용 타입:일자형 흡수량:20ml :1팩 32개\n",
       "12776  B002-01318-00002  피부타입:모든피부용 향계열:무향 주요제품특징:촉촉함(수분공급) 주요제품특징:풍부한 ...\n",
       "12777  B002-02473-00064  최소연령:4개월 단계별:2단계 종류:일반분유 제품형태:분말 포장형태:캔 용량:800...\n",
       "\n",
       "[12778 rows x 2 columns]"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "product_info = pd.read_csv('product_info.csv') #load data\n",
    "product_info"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 321,
   "id": "45d1212e",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>제품</th>\n",
       "      <th>대분류</th>\n",
       "      <th>중분류</th>\n",
       "      <th>소분류</th>\n",
       "      <th>브랜드</th>\n",
       "      <th>2022-01-01</th>\n",
       "      <th>2022-01-02</th>\n",
       "      <th>2022-01-03</th>\n",
       "      <th>2022-01-04</th>\n",
       "      <th>...</th>\n",
       "      <th>2023-03-26</th>\n",
       "      <th>2023-03-27</th>\n",
       "      <th>2023-03-28</th>\n",
       "      <th>2023-03-29</th>\n",
       "      <th>2023-03-30</th>\n",
       "      <th>2023-03-31</th>\n",
       "      <th>2023-04-01</th>\n",
       "      <th>2023-04-02</th>\n",
       "      <th>2023-04-03</th>\n",
       "      <th>2023-04-04</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>B002-00001-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0007</td>\n",
       "      <td>B002-C003-0038</td>\n",
       "      <td>B002-00001</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>B002-00002-00001</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-00002</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>B002-00002-00002</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-00002</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>B002-00002-00003</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-00002</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>B002-00003-00001</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-00003</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15885</th>\n",
       "      <td>15885</td>\n",
       "      <td>B002-03799-00002</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0042</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15886</th>\n",
       "      <td>15886</td>\n",
       "      <td>B002-03799-00003</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15887</th>\n",
       "      <td>15887</td>\n",
       "      <td>B002-03799-00004</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15888</th>\n",
       "      <td>15888</td>\n",
       "      <td>B002-03799-00005</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15889</th>\n",
       "      <td>15889</td>\n",
       "      <td>B002-03799-00010</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0004</td>\n",
       "      <td>B002-C003-0020</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>15890 rows × 465 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          ID                제품             대분류             중분류  \\\n",
       "0          0  B002-00001-00001  B002-C001-0002  B002-C002-0007   \n",
       "1          1  B002-00002-00001  B002-C001-0003  B002-C002-0008   \n",
       "2          2  B002-00002-00002  B002-C001-0003  B002-C002-0008   \n",
       "3          3  B002-00002-00003  B002-C001-0003  B002-C002-0008   \n",
       "4          4  B002-00003-00001  B002-C001-0001  B002-C002-0001   \n",
       "...      ...               ...             ...             ...   \n",
       "15885  15885  B002-03799-00002  B002-C001-0003  B002-C002-0008   \n",
       "15886  15886  B002-03799-00003  B002-C001-0003  B002-C002-0008   \n",
       "15887  15887  B002-03799-00004  B002-C001-0003  B002-C002-0008   \n",
       "15888  15888  B002-03799-00005  B002-C001-0003  B002-C002-0008   \n",
       "15889  15889  B002-03799-00010  B002-C001-0002  B002-C002-0004   \n",
       "\n",
       "                  소분류         브랜드  2022-01-01  2022-01-02  2022-01-03  \\\n",
       "0      B002-C003-0038  B002-00001           0           0           0   \n",
       "1      B002-C003-0044  B002-00002           0           0           0   \n",
       "2      B002-C003-0044  B002-00002           0           0           0   \n",
       "3      B002-C003-0044  B002-00002           0           0           0   \n",
       "4      B002-C003-0003  B002-00003           0           0           0   \n",
       "...               ...         ...         ...         ...         ...   \n",
       "15885  B002-C003-0042  B002-03799           0           0           0   \n",
       "15886  B002-C003-0044  B002-03799           0           0           0   \n",
       "15887  B002-C003-0044  B002-03799           0           0           0   \n",
       "15888  B002-C003-0044  B002-03799           0           0           0   \n",
       "15889  B002-C003-0020  B002-03799           0           0           0   \n",
       "\n",
       "       2022-01-04  ...  2023-03-26  2023-03-27  2023-03-28  2023-03-29  \\\n",
       "0               0  ...           0           0           0           0   \n",
       "1               0  ...           0           0           0           1   \n",
       "2               0  ...           0           0           0           0   \n",
       "3               0  ...           0           0           0           0   \n",
       "4               0  ...           0           0           0           0   \n",
       "...           ...  ...         ...         ...         ...         ...   \n",
       "15885           0  ...           0           0           0           0   \n",
       "15886           0  ...           0           0           0           3   \n",
       "15887           0  ...           0           0           0           0   \n",
       "15888           0  ...           0           0           0           0   \n",
       "15889           0  ...           0           0           0           0   \n",
       "\n",
       "       2023-03-30  2023-03-31  2023-04-01  2023-04-02  2023-04-03  2023-04-04  \n",
       "0               0           0           0           0           0           0  \n",
       "1               3           2           0           0           2           0  \n",
       "2               0           0           0           0           0           0  \n",
       "3               0           0           0           0           0           0  \n",
       "4               0           0           0           0           0           0  \n",
       "...           ...         ...         ...         ...         ...         ...  \n",
       "15885           0           0           0           0           0           0  \n",
       "15886           0           2           4           1           1           3  \n",
       "15887           0           0           0           0           0           0  \n",
       "15888           0           0           0           0           0           2  \n",
       "15889           0           0           0           0           0           0  \n",
       "\n",
       "[15890 rows x 465 columns]"
      ]
     },
     "execution_count": 321,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_data = pd.read_csv('train.csv')\n",
    "train_data"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c4f6a16d",
   "metadata": {},
   "source": [
    "## 문제정의: train 데이터의 대분류, 중분류, 소분류가 코드로 이루어져 데이터 분석이 직관적이지 않음. 이를 해결하기 위해서 product_info 데이터를 활용하여 카테고리를 예측해보려고함\n",
    "\n",
    "\n",
    "## 목표: 제품특성 항목에 있는 자연어를 분석하여 대분류, 중분류, 소분류 항목을 예측\n",
    "### 1. 결측치 처리"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "7ab81b64",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "제품      0\n",
       "제품특성    0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "product_info.isnull().sum() #no null value"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "851f8ac6",
   "metadata": {},
   "source": [
    "### 2. Invalid data 처리\n",
    "### 1) Too short data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "728a10af",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAA2EAAAIhCAYAAADHI7LnAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjcuMiwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8pXeV/AAAACXBIWXMAAA9hAAAPYQGoP6dpAABXWElEQVR4nO3de3zP9f//8fvb7GzeGNssM8eY8zHHPsih0lAqpOaYDoSJyKdy6GBRVPiQfIRC+nyKPukwJlJyPixh0UEom6lmcx7b8/dHv72+vW3Ye7bXmNv1ctml3s/X8/V6PV7P9/vN7p6v9/PtMMYYAQAAAABsUaywCwAAAACAGwkhDAAAAABsRAgDAAAAABsRwgAAAADARoQwAAAAALARIQwAAAAAbEQIAwAAAAAbEcIAAAAAwEaEMAAAAACwESEMQIFZsGCBHA6H9ePj46OQkBC1a9dOMTExSk5OzrbPhAkT5HA43DrP6dOnNWHCBH355Zdu7ZfTuSpVqqTIyEi3jnMlS5Ys0euvv57jNofDoQkTJuTr+fLbF198oSZNmsjf318Oh0MfffRRjv1++eUXl+e7WLFiCgwMVOfOnbVx40Zbam3btq3atm2braas14bD4dCCBQsK7PyzZs1y6/iVKlVyGS+n06mIiAj16dNHq1atKrA688vVvH6vxfdF1p9Z27Zts/3cuXHkyBFNmDBB8fHx2bb169dPJUqUsL8oAHlSvLALAFD0zZ8/XzVr1tT58+eVnJys9evXa/LkyXr11Vf1/vvvq0OHDlbfhx9+WHfccYdbxz99+rQmTpwoSS6/gF9JXs6VF0uWLNHu3bsVHR2dbdvGjRtVoUKFAq8hr4wx6tGjh26++WZ9/PHH8vf3V40aNS67z9ChQ9W7d29lZGRoz549mjhxotq1a6eNGzeqYcOGNlVeOGbNmqWyZcuqX79+ud6nVatWevXVVyVJJ0+e1L59+7R06VLdfvvtuvfee/Xee+/J09OzgCq+Olfz+r2e3xeF5ciRI5o4caIqVaqkBg0aFHY5AK4CIQxAgatTp46aNGliPb733ns1YsQItW7dWt27d9cPP/yg4OBgSVKFChUK/Jev06dPy8/Pz5ZzXUnz5s0L9fxXcuTIEf3555+655571L59+1ztU7FiReu6WrVqpWrVqql9+/aaNWuW5s6dm+M+Z86ckY+Pj9uzoEVBqVKlXF4HHTp00JAhQzRhwgRNnDhRzz77rCZPnlyIFboyxujs2bPy9fUtsNfvtf6+AICrxe2IAApFxYoVNXXqVJ04cUJz5syx2nO6RXDNmjVq27atAgMD5evrq4oVK+ree+/V6dOn9csvv6hcuXKSpIkTJ1q3dmXNRGQdb8eOHbrvvvtUunRpVa1a9ZLnyrJ8+XLVq1dPPj4+qlKliqZPn+6yPeu2pV9++cWl/csvv3S5/a1t27b69NNPdfDgQZdb9bLkdNvV7t271a1bN5UuXVo+Pj5q0KCBFi5cmON53nvvPT3zzDMKDQ1VyZIl1aFDB+3bt+/SA/8369evV/v27RUQECA/Pz+1bNlSn376qbV9woQJVkgdM2aMHA6HKlWqlKtj/13WL9QHDx6U9H9jt2rVKg0YMEDlypWTn5+fzp07p8zMTE2ZMkU1a9aUt7e3goKC1KdPH/36668uxzTGaMqUKQoPD5ePj48aNWqkzz//3O3a+vXrl+M15fTayMzM1IwZM9SgQQP5+vpa4enjjz+W9NethXv27NG6deus5zkv4/X3GmrXrq2ZM2fq7NmzVnt6erpefPFFa4zKlSun/v3769ixYy77X+59k+XcuXN6/vnnFRERIR8fHwUGBqpdu3basGGD1cfhcOiJJ57Qm2++qYiICHl7e1uvx4tfv1nPbVxcnPr3768yZcrI399fXbp00c8//2z1u5bfF7nxww8/qHfv3goKCpK3t7ciIiL0r3/9K8+1GGM0adIk6/XcpEkTxcXFudxe++WXX6pp06aSpP79+1tjdvE4/fjjj+rcubNKlCihsLAwjRw5UufOnXPpM3v2bNWvX18lSpRQQECAatasqX/+85/5Nj4AroyZMACFpnPnzvLw8NBXX311yT6//PKL7rrrLt166616++23VapUKf3222+KjY1Venq6ypcvr9jYWN1xxx0aOHCgHn74YUmyglmW7t27q1evXnrsscd06tSpy9YVHx+v6OhoTZgwQSEhIVq8eLGGDx+u9PR0jRo1yq1rnDVrlh555BH99NNPWr58+RX779u3Ty1btlRQUJCmT5+uwMBALVq0SP369dPRo0c1evRol/7//Oc/1apVK/373/9WWlqaxowZoy5duighIUEeHh6XPM+6devUsWNH1atXT/PmzZO3t7dmzZqlLl266L333lPPnj318MMPq379+urevbt1i6G3t7db1y/99UuhlP05GTBggO666y69++67OnXqlDw9PfX444/rrbfe0hNPPKHIyEj98ssveu655/Tll19qx44dKlu2rKS/AvfEiRM1cOBA3XfffTp8+LAGDRqkjIwMl9slK1WqJGOM9fjv/++ufv36adGiRRo4cKCef/55eXl5aceOHVYQX758ue677z45nU7NmjVLkvI0Xn/XpUsXvfzyy9q2bZtat26tzMxMdevWTV9//bVGjx6tli1b6uDBgxo/frzatm2rbdu2ydfX94rvGz8/P124cEF33nmnvv76a0VHR+u2227ThQsXtGnTJh06dEgtW7a06vjoo4/09ddfa9y4cQoJCVFQUNBl6x44cKA6duyoJUuW6PDhw3r22WfVtm1b7dq1S6VKlbpm3xe5sXfvXrVs2dL6h6SQkBCtXLlSw4YN0++//67x48e7XcszzzyjmJgYPfLII+revbsOHz6shx9+WOfPn9fNN98sSWrUqJHmz5+v/v3769lnn9Vdd90lSS6z+efPn1fXrl01cOBAjRw5Ul999ZVeeOEFOZ1OjRs3TpK0dOlSDR48WEOHDtWrr76qYsWK6ccff9TevXuvalwAuMkAQAGZP3++kWS2bt16yT7BwcEmIiLCejx+/Hjz9z+aPvjgAyPJxMfHX/IYx44dM5LM+PHjs23LOt64ceMuue3vwsPDjcPhyHa+jh07mpIlS5pTp065XNuBAwdc+q1du9ZIMmvXrrXa7rrrLhMeHp5j7RfX3atXL+Pt7W0OHTrk0u/OO+80fn5+5vjx4y7n6dy5s0u///znP0aS2bhxY47ny9K8eXMTFBRkTpw4YbVduHDB1KlTx1SoUMFkZmYaY4w5cOCAkWReeeWVyx7v730nT55szp8/b86ePWu2b99umjZtaiSZTz/91Bjzf2PXp08fl/0TEhKMJDN48GCX9s2bNxtJ5p///KcxxpiUlBTj4+Nj7rnnHpd+33zzjZFk2rRpc8Vas/Tt2zfH5+bi18ZXX31lJJlnnnnmsserXbu2W+cPDw83d9111yW3z54920gy77//vjHGmPfee89IMh9++KFLv61btxpJZtasWcaY3L1v3nnnHSPJzJ0797I1SjJOp9P8+eefOW77++s367m91HPz4osvWm3X4vsiN39m3X777aZChQomNTXVpf2JJ54wPj4+1jjltpY///zTeHt7m549e7r027hxY7bXc9bzPH/+/Gx19e3b10gy//nPf1zaO3fubGrUqOFSZ6lSpS49CABswe2IAAqVucLMRIMGDeTl5aVHHnlECxcudLmlyR333ntvrvvWrl1b9evXd2nr3bu30tLStGPHjjydP7fWrFmj9u3bKywszKW9X79+On36dLZVBrt27eryuF69epL+79a/nJw6dUqbN2/Wfffd57KamoeHh6KiovTrr79e1a1bY8aMkaenp3x8fNS4cWMdOnRIc+bMUefOnV36XfycrF27VpKyLWpxyy23KCIiQl988YWkvxZtOHv2rB588EGXfi1btlR4eHie676crFsdhwwZUiDHv5SL3x+ffPKJSpUqpS5duujChQvWT4MGDRQSEmLdBpub983nn38uHx8fDRgw4Ip13HbbbSpdunSu677Uc5P1HLvLjvdFbpw9e1ZffPGF7rnnHms2Meunc+fOOnv2rDZt2uRWLZs2bdK5c+fUo0cPl37Nmzd3+3ZWh8OhLl26ZDvf36/7lltu0fHjx/XAAw/of//7n37//Xe3zgEgfxDCABSaU6dO6Y8//lBoaOgl+1StWlWrV69WUFCQhgwZoqpVq6pq1ap644033DpX+fLlc903JCTkkm1//PGHW+d11x9//JFjrVljdPH5AwMDXR5n3f525syZS54jJSVFxhi3zuOO4cOHa+vWrdq+fbt++uknJSYm6pFHHsnW7+LzZ53zUnVlbc/67+Wep/x27NgxeXh4FNjxLyXrl+es5+Xo0aM6fvy4vLy85Onp6fKTlJRk/UKdm/fNsWPHFBoaqmLFrvyrgDvvH+nSz01eX1d2vC9yW8eFCxc0Y8aMbOOf9Y8MF4eaK9WSVXvW4kR/l1Pb5fj5+cnHxyfb+f7+mcKoqCi9/fbbOnjwoO69914FBQWpWbNmiouLc+tcAK4OnwkDUGg+/fRTZWRkXHFZ+VtvvVW33nqrMjIytG3bNs2YMUPR0dEKDg5Wr169cnUud1bdS0pKumRb1i9UWb/oXPyB96v9V+XAwEAlJiZmaz9y5IgkWZ+JuhqlS5dWsWLFCuw8FSpUcFkN81Iufk6yxjYxMTHbqpVHjhyxasrqd6nnyZ3ZAx8fn2zPoZT9eSxXrpwyMjKUlJTkdiDJK2OMVqxYIX9/f2s8y5Ytq8DAQMXGxua4T0BAgPX/V3rflCtXTuvXr1dmZuYVg5i7q1Ze6rmpVq2aW8fJYsf7IjdKly5tzRhfala0cuXKbh0z6/V89OjRbNvcfT3nVv/+/dW/f3+dOnVKX331lcaPH6/IyEjt37+/wGaTAbhiJgxAoTh06JBGjRolp9OpRx99NFf7eHh4qFmzZtYqZFm3BubXv3Jn2bNnj7799luXtiVLliggIECNGjWSJOsXo127drn0y1op7++8vb1zXVv79u21Zs0a65fLLO+88478/PzyZeluf39/NWvWTMuWLXOpKzMzU4sWLVKFChWsxQDsdNttt0mSFi1a5NK+detWJSQkWEvkN2/eXD4+Plq8eLFLvw0bNrh9u1mlSpWUnJzs8gtwenq6Vq5c6dLvzjvvlPTXqnKX485zfSUTJ07U3r17NXz4cCv0R0ZG6o8//lBGRoaaNGmS7Sen73C71Pvmzjvv1NmzZwvky6sv9dz8/R9crrX3RW74+fmpXbt22rlzp+rVq5fjc3DxzNeVNGvWTN7e3nr//fdd2jdt2pTt9Zzff9b5+/vrzjvv1DPPPKP09HTt2bMnX44L4MqYCQNQ4Hbv3m19biI5OVlff/215s+fLw8PDy1fvjzbqnl/9+abb2rNmjW66667VLFiRZ09e1Zvv/22JFlf8hwQEKDw8HD973//U/v27VWmTBmVLVs2z/+CHBoaqq5du2rChAkqX768Fi1apLi4OE2ePFl+fn6SpKZNm6pGjRoaNWqULly4oNKlS2v58uVav359tuPVrVtXy5Yt0+zZs9W4cWMVK1bskjNF48eP1yeffKJ27dpp3LhxKlOmjBYvXqxPP/1UU6ZMkdPpzNM1XSwmJkYdO3ZUu3btNGrUKHl5eWnWrFnavXu33nvvvUL5vq4aNWrokUce0YwZM1SsWDHdeeed1uqIYWFhGjFihKS/ZiNGjRqlF198UQ8//LDuv/9+HT582FrN0h09e/bUuHHj1KtXLz311FM6e/aspk+froyMDJd+t956q6KiovTiiy/q6NGjioyMlLe3t3bu3Ck/Pz8NHTpU0l/P9dKlS/X++++rSpUq8vHxUd26dS9bw/Hjx63PEZ06dcr6suavv/5aPXr0sL6IXJJ69eqlxYsXq3Pnzho+fLhuueUWeXp66tdff9XatWvVrVs33XPPPbl63zzwwAOaP3++HnvsMe3bt0/t2rVTZmamNm/erIiIiFzPMudk27ZtLs/NM888o5tuukmDBw+2+lyL74ssa9asyfb1E9JfK7q+8cYbat26tW699VY9/vjjqlSpkk6cOKEff/xRK1as0Jo1a9w6V5kyZfTkk08qJiZGpUuX1j333KNff/1VEydOVPny5V1mKatWrSpfX18tXrxYERERKlGihEJDQy97S/fFBg0aJF9fX7Vq1Urly5dXUlKSYmJi5HQ6rSXwAdigcNcFAVCUZa00lvXj5eVlgoKCTJs2bcykSZNMcnJytn0uXpVu48aN5p577jHh4eHG29vbBAYGmjZt2piPP/7YZb/Vq1ebhg0bGm9vbyPJ9O3b1+V4x44du+K5jPm/1eo++OADU7t2bePl5WUqVapkpk2blm3//fv3m06dOpmSJUuacuXKmaFDh5pPP/002+qIf/75p7nvvvtMqVKljMPhcDmncljV8bvvvjNdunQxTqfTeHl5mfr162dbDS1r5bX//ve/Lu1ZKxTmtHraxb7++mtz2223GX9/f+Pr62uaN29uVqxYkePx3Fkd8Up9L7cCXUZGhpk8ebK5+eabjaenpylbtqx56KGHzOHDh136ZWZmmpiYGBMWFma8vLxMvXr1zIoVK0ybNm3cWp3QGGM+++wz06BBA+Pr62uqVKliZs6cmeNrIyMjw7z22mumTp06xsvLyzidTtOiRQuXMfvll19Mp06dTEBAgJF0ydX/soSHh1vvD4fDYUqUKGFq1KhhoqKizMqVK3Pc5/z58+bVV1819evXNz4+PqZEiRKmZs2a5tFHHzU//PCDMSb375szZ86YcePGmerVqxsvLy8TGBhobrvtNrNhwwarjyQzZMiQHGu5+PWb9dyuWrXKREVFmVKlShlfX1/TuXNnq7Ys1+L74uI/sy7+yVoN9cCBA2bAgAHmpptuMp6enqZcuXKmZcuWLqs/ulNLZmamefHFF02FChWs1/Mnn3xi6tevn22lyffee8/UrFnTeHp6uoxT3759jb+/f7Zruvi1vHDhQtOuXTsTHBxsvLy8TGhoqOnRo4fZtWvXZccGQP5yGHMVX5oCAADw/y1YsED9+/fX1q1bc/W5QFzagQMHVLNmTY0fP54vUgaKIG5HBAAAKETffvut3nvvPbVs2VIlS5bUvn37NGXKFJUsWVIDBw4s7PIAFABCGAAAQCHy9/fXtm3bNG/ePB0/flxOp1Nt27bVSy+95PYy9QCuD9yOCAAAAAA2Yol6AAAAALARIQwAAAAAbEQIAwAAAAAbsTBHLmVmZurIkSMKCAgolC8xBQAAAHBtMMboxIkTCg0NdflS9dwihOXSkSNHFBYWVthlAAAAALhGHD58WBUqVHB7P0JYLgUEBEj6a6BLlixZyNUAAAAAKCxpaWkKCwuzMoK7CGG5lHULYsmSJQlhAAAAAPL8MSUW5gAAAAAAGxHCAAAAAMBGhDAAAAAAsBEhDAAAAABsRAgDAAAAABsRwgAAAADARoQwAAAAALARIQwAAAAAbEQIAwAAAAAbEcIAAAAAwEaEMAAAAACwESEMAAAAAGxECAMAAAAAGxHCAAAAAMBGhDAAAAAAsBEhDAAAAABsRAgDAAAAABsRwgAAAADARoQwAAAAALBR8cIuAHkzcMHWPO03r1/TfK4EAAAAgDuYCQMAAAAAGxHCAAAAAMBGhDAAAAAAsBEhDAAAAABsRAgDAAAAABsRwgAAAADARoQwAAAAALARIQwAAAAAbEQIAwAAAAAbEcIAAAAAwEaEMAAAAACwESEMAAAAAGxECAMAAAAAGxHCAAAAAMBGhDAAAAAAsBEhDAAAAABsRAgDAAAAABsRwgAAAADARoQwAAAAALARIQwAAAAAbEQIAwAAAAAbEcIAAAAAwEaEMAAAAACwESEMAAAAAGxECAMAAAAAGxHCAAAAAMBGhDAAAAAAsBEhDAAAAABsRAgDAAAAABsRwgAAAADARoQwAAAAALARIQwAAAAAbEQIAwAAAAAbEcIAAAAAwEaEMAAAAACwESEMAAAAAGxECAMAAAAAGxHCAAAAAMBGhDAAAAAAsBEhDAAAAABsRAgDAAAAABsRwgAAAADARoQwAAAAALARIQwAAAAAbFSoIezChQt69tlnVblyZfn6+qpKlSp6/vnnlZmZafUxxmjChAkKDQ2Vr6+v2rZtqz179rgc59y5cxo6dKjKli0rf39/de3aVb/++qtLn5SUFEVFRcnpdMrpdCoqKkrHjx+34zIBAAAAwFKoIWzy5Ml68803NXPmTCUkJGjKlCl65ZVXNGPGDKvPlClTNG3aNM2cOVNbt25VSEiIOnbsqBMnTlh9oqOjtXz5ci1dulTr16/XyZMnFRkZqYyMDKtP7969FR8fr9jYWMXGxio+Pl5RUVG2Xi8AAAAAOIwxprBOHhkZqeDgYM2bN89qu/fee+Xn56d3331XxhiFhoYqOjpaY8aMkfTXrFdwcLAmT56sRx99VKmpqSpXrpzeffdd9ezZU5J05MgRhYWF6bPPPtPtt9+uhIQE1apVS5s2bVKzZs0kSZs2bVKLFi30/fffq0aNGlesNS0tTU6nU6mpqSpZsmQBjIZ7Bi7Ymqf95vVrms+VAAAAADeWq80GhToT1rp1a33xxRfav3+/JOnbb7/V+vXr1blzZ0nSgQMHlJSUpE6dOln7eHt7q02bNtqwYYMkafv27Tp//rxLn9DQUNWpU8fqs3HjRjmdTiuASVLz5s3ldDqtPhc7d+6c0tLSXH4AAAAA4GoVL8yTjxkzRqmpqapZs6Y8PDyUkZGhl156SQ888IAkKSkpSZIUHBzssl9wcLAOHjxo9fHy8lLp0qWz9cnaPykpSUFBQdnOHxQUZPW5WExMjCZOnHh1FwgAAAAAFynUmbD3339fixYt0pIlS7Rjxw4tXLhQr776qhYuXOjSz+FwuDw2xmRru9jFfXLqf7njjB07VqmpqdbP4cOHc3tZAAAAAHBJhToT9tRTT+npp59Wr169JEl169bVwYMHFRMTo759+yokJETSXzNZ5cuXt/ZLTk62ZsdCQkKUnp6ulJQUl9mw5ORktWzZ0upz9OjRbOc/duxYtlm2LN7e3vL29s6fCwUAAACA/69QZ8JOnz6tYsVcS/Dw8LCWqK9cubJCQkIUFxdnbU9PT9e6deusgNW4cWN5enq69ElMTNTu3butPi1atFBqaqq2bNli9dm8ebNSU1OtPgAAAABgh0KdCevSpYteeuklVaxYUbVr19bOnTs1bdo0DRgwQNJftxBGR0dr0qRJql69uqpXr65JkybJz89PvXv3liQ5nU4NHDhQI0eOVGBgoMqUKaNRo0apbt266tChgyQpIiJCd9xxhwYNGqQ5c+ZIkh555BFFRkbmamVEAAAAAMgvhRrCZsyYoeeee06DBw9WcnKyQkND9eijj2rcuHFWn9GjR+vMmTMaPHiwUlJS1KxZM61atUoBAQFWn9dee03FixdXjx49dObMGbVv314LFiyQh4eH1Wfx4sUaNmyYtYpi165dNXPmTPsuFgAAAABUyN8Tdj3he8IAAAAASNf594QBAAAAwI2GEAYAAAAANiKEAQAAAICNCGEAAAAAYCNCGAAAAADYiBAGAAAAADYihAEAAACAjQhhAAAAAGAjQhgAAAAA2IgQBgAAAAA2IoQBAAAAgI0IYQAAAABgI0IYAAAAANiIEAYAAAAANiKEAQAAAICNCGEAAAAAYCNCGAAAAADYiBAGAAAAADYihAEAAACAjQhhAAAAAGAjQhgAAAAA2IgQBgAAAAA2IoQBAAAAgI0IYQAAAABgI0IYAAAAANiIEAYAAAAANiKEAQAAAICNCGEAAAAAYCNCGAAAAADYiBAGAAAAADYihAEAAACAjQhhAAAAAGAjQhgAAAAA2IgQBgAAAAA2IoQBAAAAgI0IYQAAAABgI0IYAAAAANiIEAYAAAAANiKEAQAAAICNCGEAAAAAYCNCGAAAAADYiBAGAAAAADYihAEAAACAjQhhAAAAAGAjQhgAAAAA2IgQBgAAAAA2IoQBAAAAgI0IYQAAAABgI0IYAAAAANiIEAYAAAAANiKEAQAAAICNCGEAAAAAYCNCGAAAAADYiBAGAAAAADYihAEAAACAjQhhAAAAAGAjQhgAAAAA2IgQBgAAAAA2IoQBAAAAgI0IYQAAAABgI0IYAAAAANiIEAYAAAAANiKEAQAAAICNCGEAAAAAYCNCGAAAAADYiBAGAAAAADYihAEAAACAjQhhAAAAAGAjQhgAAAAA2IgQBgAAAAA2IoQBAAAAgI0IYQAAAABgI0IYAAAAANiIEAYAAAAANiKEAQAAAICNCGEAAAAAYCNCGAAAAADYiBAGAAAAADYihAEAAACAjQhhAAAAAGAjQhgAAAAA2IgQBgAAAAA2IoQBAAAAgI0IYQAAAABgI0IYAAAAANjI7RB25swZnT592np88OBBvf7661q1alW+FgYAAAAARZHbIaxbt2565513JEnHjx9Xs2bNNHXqVHXr1k2zZ8/O9wIBAAAAoChxO4Tt2LFDt956qyTpgw8+UHBwsA4ePKh33nlH06dPd7uA3377TQ899JACAwPl5+enBg0aaPv27dZ2Y4wmTJig0NBQ+fr6qm3bttqzZ4/LMc6dO6ehQ4eqbNmy8vf3V9euXfXrr7+69ElJSVFUVJScTqecTqeioqJ0/Phxt+sFAAAAgKvhdgg7ffq0AgICJEmrVq1S9+7dVaxYMTVv3lwHDx5061gpKSlq1aqVPD099fnnn2vv3r2aOnWqSpUqZfWZMmWKpk2bppkzZ2rr1q0KCQlRx44ddeLECatPdHS0li9frqVLl2r9+vU6efKkIiMjlZGRYfXp3bu34uPjFRsbq9jYWMXHxysqKsrdywcAAACAq1Lc3R2qVaumjz76SPfcc49WrlypESNGSJKSk5NVsmRJt441efJkhYWFaf78+VZbpUqVrP83xuj111/XM888o+7du0uSFi5cqODgYC1ZskSPPvqoUlNTNW/ePL377rvq0KGDJGnRokUKCwvT6tWrdfvttyshIUGxsbHatGmTmjVrJkmaO3euWrRooX379qlGjRrZajt37pzOnTtnPU5LS3Pr2gAAAAAgJ27PhI0bN06jRo1SpUqV1KxZM7Vo0ULSX7NiDRs2dOtYH3/8sZo0aaL7779fQUFBatiwoebOnWttP3DggJKSktSpUyerzdvbW23atNGGDRskSdu3b9f58+dd+oSGhqpOnTpWn40bN8rpdFoBTJKaN28up9Np9blYTEyMdeui0+lUWFiYW9cGAAAAADlxO4Tdd999OnTokLZt26bY2FirvX379nr99dfdOtbPP/+s2bNnq3r16lq5cqUee+wxDRs2zFr4IykpSZIUHBzssl9wcLC1LSkpSV5eXipduvRl+wQFBWU7f1BQkNXnYmPHjlVqaqr1c/jwYbeuDQAAAABy4nYIGzBggPz9/dWwYUMVK/Z/u9euXVuTJ09261iZmZlq1KiRJk2apIYNG+rRRx/VoEGDsq2y6HA4XB4bY7K1XeziPjn1v9xxvL29VbJkSZcfAAAAALhaboewhQsX6syZM9naz5w5Y81g5Vb58uVVq1Ytl7aIiAgdOnRIkhQSEiJJ2WarkpOTrdmxkJAQpaenKyUl5bJ9jh49mu38x44dyzbLBgAAAAAFKdchLC0tTampqTLG6MSJE0pLS7N+UlJS9Nlnn+V4y9/ltGrVSvv27XNp279/v8LDwyVJlStXVkhIiOLi4qzt6enpWrdunVq2bClJaty4sTw9PV36JCYmavfu3VafFi1aKDU1VVu2bLH6bN68WampqVYfAAAAALBDrldHLFWqlBwOhxwOh26++eZs2x0OhyZOnOjWyUeMGKGWLVtq0qRJ6tGjh7Zs2aK33npLb731lnXM6OhoTZo0SdWrV1f16tU1adIk+fn5qXfv3pIkp9OpgQMHauTIkQoMDFSZMmU0atQo1a1b11otMSIiQnfccYcGDRqkOXPmSJIeeeQRRUZG5rgyIgAAAAAUlFyHsLVr18oYo9tuu00ffvihypQpY23z8vJSeHi4QkND3Tp506ZNtXz5co0dO1bPP/+8KleurNdff10PPvig1Wf06NE6c+aMBg8erJSUFDVr1kyrVq2yvqtMkl577TUVL15cPXr00JkzZ9S+fXstWLBAHh4eVp/Fixdr2LBh1iqKXbt21cyZM92qFwAAAACulsMYY9zZ4eDBg6pYseIVF8YoatLS0uR0OpWamnpNLNIxcMHWPO03r1/TfK4EAAAAuLFcbTZwe2GONWvW6IMPPsjW/t///lcLFy50uwAAAAAAuJG4HcJefvlllS1bNlt7UFCQJk2alC9FAQAAAEBR5XYIO3jwoCpXrpytPTw83FpaHgAAAACQM7dDWFBQkHbt2pWt/dtvv1VgYGC+FAUAAAAARZXbIaxXr14aNmyY1q5dq4yMDGVkZGjNmjUaPny4evXqVRA1AgAAAECRkesl6rO8+OKLOnjwoNq3b6/ixf/aPTMzU3369OEzYQAAAABwBW6HMC8vL73//vt64YUX9O2338rX11d169ZVeHh4QdQHAAAAAEWK2yEsy80336ybb745P2sBAAAAgCLP7RA2YMCAy25/++2381wMAAAAABR1boewlJQUl8fnz5/X7t27dfz4cd122235VhgAAAAAFEVuh7Dly5dna8vMzNTgwYNVpUqVfCkKAAAAAIoqt5eoz/EgxYppxIgReu211/LjcAAAAABQZOVLCJOkn376SRcuXMivwwEAAABAkeT27YhPPvmky2NjjBITE/Xpp5+qb9+++VYYAAAAABRFboewnTt3ujwuVqyYypUrp6lTp15x5UQAAAAAuNG5HcLWrl1bEHUAAAAAwA0h3z4TBgAAAAC4slzNhDVs2FAOhyNXB9yxY8dVFQQAAAAARVmuQtjdd99t/f/Zs2c1a9Ys1apVSy1atJAkbdq0SXv27NHgwYMLpEgAAAAAKCpyFcLGjx9v/f/DDz+sYcOG6YUXXsjW5/Dhw/lbHQAAAAAUMW5/Juy///2v+vTpk639oYce0ocffpgvRQEAAABAUeV2CPP19dX69euzta9fv14+Pj75UhQAAAAAFFVuL1EfHR2txx9/XNu3b1fz5s0l/fWZsLffflvjxo3L9wIBAAAAoChxO4Q9/fTTqlKlit544w0tWbJEkhQREaEFCxaoR48e+V4gAAAAABQlbocwSerRoweBCwAAAADyIE8hTJK2b9+uhIQEORwO1apVSw0bNszPugAAAACgSHI7hCUnJ6tXr1768ssvVapUKRljlJqaqnbt2mnp0qUqV65cQdQJAAAAAEWC26sjDh06VGlpadqzZ4/+/PNPpaSkaPfu3UpLS9OwYcMKokYAAAAAKDLcngmLjY3V6tWrFRERYbXVqlVL//rXv9SpU6d8LQ4AAAAAihq3Z8IyMzPl6emZrd3T01OZmZn5UhQAAAAAFFVuh7DbbrtNw4cP15EjR6y23377TSNGjFD79u3ztTgAAAAAKGrcDmEzZ87UiRMnVKlSJVWtWlXVqlVT5cqVdeLECc2YMaMgagQAAACAIsPtz4SFhYVpx44diouL0/fffy9jjGrVqqUOHToURH0AAAAAUKS4FcIuXLggHx8fxcfHq2PHjurYsWNB1QUAAAAARZJbtyMWL15c4eHhysjIKKh6AAAAAKBIc/szYc8++6zGjh2rP//8syDqAQAAAIAize3PhE2fPl0//vijQkNDFR4eLn9/f5ftO3bsyLfiAAAAAKCocTuEdevWTQ6HoyBqAQAAAIAiz+0QNmHChAIoAwAAAABuDLn+TNjp06c1ZMgQ3XTTTQoKClLv3r31+++/F2RtAAAAAFDk5DqEjR8/XgsWLNBdd92lXr16KS4uTo8//nhB1gYAAAAARU6ub0dctmyZ5s2bp169ekmSHnroIbVq1UoZGRny8PAosAIBAAAAoCjJ9UzY4cOHdeutt1qPb7nlFhUvXlxHjhwpkMIAAAAAoCjKdQjLyMiQl5eXS1vx4sV14cKFfC8KAAAAAIqqXN+OaIxRv3795O3tbbWdPXtWjz32mMt3hS1btix/KwQAAACAIiTXIaxv377Z2h566KF8LQYAAAAAirpch7D58+cXZB0AAAAAcEPI9WfCAAAAAABXjxAGAAAAADYihAEAAACAjQhhAAAAAGCjXIWwRo0aKSUlRZL0/PPP6/Tp0wVaFAAAAAAUVbkKYQkJCTp16pQkaeLEiTp58mSBFgUAAAAARVWulqhv0KCB+vfvr9atW8sYo1dffVUlSpTIse+4cePytUAAAAAAKEpyFcIWLFig8ePH65NPPpHD4dDnn3+u4sWz7+pwOAhhAAAAAHAZuQphNWrU0NKlSyVJxYoV0xdffKGgoKACLQwAAAAAiqJchbC/y8zMLIg6AAAAAOCG4HYIk6SffvpJr7/+uhISEuRwOBQREaHhw4eratWq+V0fAAAAABQpbn9P2MqVK1WrVi1t2bJF9erVU506dbR582bVrl1bcXFxBVEjAAAAABQZbs+EPf300xoxYoRefvnlbO1jxoxRx44d8604AAAAAChq3J4JS0hI0MCBA7O1DxgwQHv37s2XogAAAACgqHI7hJUrV07x8fHZ2uPj41kxEQAAAACuwO3bEQcNGqRHHnlEP//8s1q2bCmHw6H169dr8uTJGjlyZEHUCAAAAABFhtsh7LnnnlNAQICmTp2qsWPHSpJCQ0M1YcIEDRs2LN8LBAAAAICixO0Q5nA4NGLECI0YMUInTpyQJAUEBOR7YQAAAABQFOXpe8KyEL4AAAAAwD1uL8wBAAAAAMg7QhgAAAAA2IgQBgAAAAA2ciuEnT9/Xu3atdP+/fsLqh4AAAAAKNLcCmGenp7avXu3HA5HQdUDAAAAAEWa27cj9unTR/PmzSuIWgAAAACgyHN7ifr09HT9+9//VlxcnJo0aSJ/f3+X7dOmTcu34gAAAACgqHE7hO3evVuNGjWSpGyfDeM2RQAAAAC4PLdD2Nq1awuiDgAAAAC4IeR5ifoff/xRK1eu1JkzZyRJxph8KwoAAAAAiiq3Q9gff/yh9u3b6+abb1bnzp2VmJgoSXr44Yc1cuTIfC8QAAAAAIoSt0PYiBEj5OnpqUOHDsnPz89q79mzp2JjY/O1OAAAAAAoatz+TNiqVau0cuVKVahQwaW9evXqOnjwYL4VBgAAAABFkdszYadOnXKZAcvy+++/y9vbO1+KAgAAAICiyu0Q9o9//EPvvPOO9djhcCgzM1OvvPKK2rVrl6/FAQAAAEBR4/btiK+88oratm2rbdu2KT09XaNHj9aePXv0559/6ptvvimIGgEAAACgyHB7JqxWrVratWuXbrnlFnXs2FGnTp1S9+7dtXPnTlWtWrUgagQAAACAIsPtmTBJCgkJ0cSJE/O7FgAAAAAo8vIUwlJSUjRv3jwlJCTI4XAoIiJC/fv3V5kyZfK7PgAAAAAoUty+HXHdunWqXLmypk+frpSUFP3555+aPn26KleurHXr1hVEjQAAAABQZLgdwoYMGaIePXrowIEDWrZsmZYtW6aff/5ZvXr10pAhQ/JcSExMjBwOh6Kjo602Y4wmTJig0NBQ+fr6qm3bttqzZ4/LfufOndPQoUNVtmxZ+fv7q2vXrvr1119d+qSkpCgqKkpOp1NOp1NRUVE6fvx4nmsFAAAAgLxyO4T99NNPGjlypDw8PKw2Dw8PPfnkk/rpp5/yVMTWrVv11ltvqV69ei7tU6ZM0bRp0zRz5kxt3bpVISEh6tixo06cOGH1iY6O1vLly7V06VKtX79eJ0+eVGRkpDIyMqw+vXv3Vnx8vGJjYxUbG6v4+HhFRUXlqVYAAAAAuBpuh7BGjRopISEhW3tCQoIaNGjgdgEnT57Ugw8+qLlz56p06dJWuzFGr7/+up555hl1795dderU0cKFC3X69GktWbJEkpSamqp58+Zp6tSp6tChgxo2bKhFixbpu+++0+rVq626YmNj9e9//1stWrRQixYtNHfuXH3yySfat2+f2/UCAAAAwNXIVQjbtWuX9TNs2DANHz5cr776qtavX6/169fr1Vdf1YgRI1xuJcytIUOG6K677lKHDh1c2g8cOKCkpCR16tTJavP29labNm20YcMGSdL27dt1/vx5lz6hoaGqU6eO1Wfjxo1yOp1q1qyZ1ad58+ZyOp1Wn5ycO3dOaWlpLj8AAAAAcLVytTpigwYN5HA4ZIyx2kaPHp2tX+/evdWzZ89cn3zp0qXasWOHtm7dmm1bUlKSJCk4ONilPTg4WAcPHrT6eHl5ucygZfXJ2j8pKUlBQUHZjh8UFGT1yUlMTAzL8AMAAADId7kKYQcOHMj3Ex8+fFjDhw/XqlWr5OPjc8l+DofD5bExJlvbxS7uk1P/Kx1n7NixevLJJ63HaWlpCgsLu+x5AQAAAOBKchXCwsPD8/3E27dvV3Jysho3bmy1ZWRk6KuvvtLMmTOtz2slJSWpfPnyVp/k5GRrdiwkJETp6elKSUlxmQ1LTk5Wy5YtrT5Hjx7Ndv5jx45lm2X7O29vb3l7e1/dRQIAAADARfL0Zc2//fabvvnmGyUnJyszM9Nl27Bhw3J1jPbt2+u7775zaevfv79q1qypMWPGqEqVKgoJCVFcXJwaNmwoSUpPT9e6des0efJkSVLjxo3l6empuLg49ejRQ5KUmJio3bt3a8qUKZKkFi1aKDU1VVu2bNEtt9wiSdq8ebNSU1OtoAYAAAAAdnE7hM2fP1+PPfaYvLy8FBgYmO22v9yGsICAANWpU8elzd/fX4GBgVZ7dHS0Jk2apOrVq6t69eqaNGmS/Pz81Lt3b0mS0+nUwIEDNXLkSAUGBqpMmTIaNWqU6tatay30ERERoTvuuEODBg3SnDlzJEmPPPKIIiMjVaNGDXcvHwAAAACuitshbNy4cRo3bpzGjh2rYsXcXuHeLaNHj9aZM2c0ePBgpaSkqFmzZlq1apUCAgKsPq+99pqKFy+uHj166MyZM2rfvr0WLFjg8j1mixcv1rBhw6xVFLt27aqZM2cWaO0AAAAAkBOH+fuSh7kQGBioLVu2qGrVqgVV0zUpLS1NTqdTqampKlmyZGGXo4ELsq8omRvz+jXN50oAAACAG8vVZgO3p7IGDhyo//73v26fCAAAAACQh9sRY2JiFBkZqdjYWNWtW1eenp4u26dNm5ZvxQEAAABAUeN2CJs0aZJWrlxpLWpxpe/jAgAAAAD8H7dD2LRp0/T222+rX79+BVAOAAAAABRtbn8mzNvbW61atSqIWgAAAACgyHM7hA0fPlwzZswoiFoAAAAAoMhz+3bELVu2aM2aNfrkk09Uu3btbAtzLFu2LN+KAwAAAICixu0QVqpUKXXv3r0gagEAAACAIs/tEDZ//vyCqAMAAAAAbghufyYMAAAAAJB3bs+EVa5c+bLfB/bzzz9fVUEAAAAAUJS5HcKio6NdHp8/f147d+5UbGysnnrqqfyqCwAAAACKJLdD2PDhw3Ns/9e//qVt27ZddUEAAAAAUJTl22fC7rzzTn344Yf5dTgAAAAAKJLyLYR98MEHKlOmTH4dDgAAAACKJLdvR2zYsKHLwhzGGCUlJenYsWOaNWtWvhYHAAAAAEWN2yHs7rvvdnlcrFgxlStXTm3btlXNmjXzqy4AAAAAKJLcDmHjx48viDoAAAAA4IbAlzUDAAAAgI1yPRNWrFixy35JsyQ5HA5duHDhqosCAAAAgKIq1yFs+fLll9y2YcMGzZgxQ8aYfCkKAAAAAIqqXIewbt26ZWv7/vvvNXbsWK1YsUIPPvigXnjhhXwtDgAAAACKmjx9JuzIkSMaNGiQ6tWrpwsXLig+Pl4LFy5UxYoV87s+AAAAAChS3AphqampGjNmjKpVq6Y9e/boiy++0IoVK1SnTp2Cqg8AAAAAipRc3444ZcoUTZ48WSEhIXrvvfdyvD0RAAAAAHB5uQ5hTz/9tHx9fVWtWjUtXLhQCxcuzLHfsmXL8q04AAAAAChqch3C+vTpc8Ul6gEAAAAAl5frELZgwYICLAMAAAAAbgx5Wh0RAAAAAJA3hDAAAAAAsBEhDAAAAABsRAgDAAAAABsRwgAAAADARoQwAAAAALARIQwAAAAAbEQIAwAAAAAbEcIAAAAAwEaEMAAAAACwESEMAAAAAGxECAMAAAAAGxHCAAAAAMBGhDAAAAAAsBEhDAAAAABsRAgDAAAAABsRwgAAAADARoQwAAAAALARIQwAAAAAbEQIAwAAAAAbEcIAAAAAwEaEMAAAAACwESEMAAAAAGxECAMAAAAAGxHCAAAAAMBGhDAAAAAAsBEhDAAAAABsRAgDAAAAABsRwgAAAADARoQwAAAAALARIQwAAAAAbEQIAwAAAAAbEcIAAAAAwEaEMAAAAACwESEMAAAAAGxECAMAAAAAGxHCAAAAAMBGhDAAAAAAsBEhDAAAAABsRAgDAAAAABsRwgAAAADARoQwAAAAALARIQwAAAAAbEQIAwAAAAAbEcIAAAAAwEaEMAAAAACwESEMAAAAAGxECAMAAAAAGxHCAAAAAMBGhDAAAAAAsBEhDAAAAABsRAgDAAAAABsRwgAAAADARoQwAAAAALARIQwAAAAAbEQIAwAAAAAbEcIAAAAAwEaEMAAAAACwESEMAAAAAGxUqCEsJiZGTZs2VUBAgIKCgnT33Xdr3759Ln2MMZowYYJCQ0Pl6+urtm3bas+ePS59zp07p6FDh6ps2bLy9/dX165d9euvv7r0SUlJUVRUlJxOp5xOp6KionT8+PGCvkQAAAAAcFGoIWzdunUaMmSINm3apLi4OF24cEGdOnXSqVOnrD5TpkzRtGnTNHPmTG3dulUhISHq2LGjTpw4YfWJjo7W8uXLtXTpUq1fv14nT55UZGSkMjIyrD69e/dWfHy8YmNjFRsbq/j4eEVFRdl6vQAAAADgMMaYwi4iy7FjxxQUFKR169bpH//4h4wxCg0NVXR0tMaMGSPpr1mv4OBgTZ48WY8++qhSU1NVrlw5vfvuu+rZs6ck6ciRIwoLC9Nnn32m22+/XQkJCapVq5Y2bdqkZs2aSZI2bdqkFi1a6Pvvv1eNGjWuWFtaWpqcTqdSU1NVsmTJghuEXBq4YGue9pvXr2k+VwIAAADcWK42G1xTnwlLTU2VJJUpU0aSdODAASUlJalTp05WH29vb7Vp00YbNmyQJG3fvl3nz5936RMaGqo6depYfTZu3Cin02kFMElq3ry5nE6n1edi586dU1pamssPAAAAAFytayaEGWP05JNPqnXr1qpTp44kKSkpSZIUHBzs0jc4ONjalpSUJC8vL5UuXfqyfYKCgrKdMygoyOpzsZiYGOvzY06nU2FhYVd3gQAAAACgayiEPfHEE9q1a5fee++9bNscDofLY2NMtraLXdwnp/6XO87YsWOVmppq/Rw+fDg3lwEAAAAAl3VNhLChQ4fq448/1tq1a1WhQgWrPSQkRJKyzVYlJydbs2MhISFKT09XSkrKZfscPXo023mPHTuWbZYti7e3t0qWLOnyAwAAAABXq1BDmDFGTzzxhJYtW6Y1a9aocuXKLtsrV66skJAQxcXFWW3p6elat26dWrZsKUlq3LixPD09XfokJiZq9+7dVp8WLVooNTVVW7Zssfps3rxZqampVh8AAAAAsEPxwjz5kCFDtGTJEv3vf/9TQECANePldDrl6+srh8Oh6OhoTZo0SdWrV1f16tU1adIk+fn5qXfv3lbfgQMHauTIkQoMDFSZMmU0atQo1a1bVx06dJAkRURE6I477tCgQYM0Z84cSdIjjzyiyMjIXK2MCAAAAAD5pVBD2OzZsyVJbdu2dWmfP3+++vXrJ0kaPXq0zpw5o8GDByslJUXNmjXTqlWrFBAQYPV/7bXXVLx4cfXo0UNnzpxR+/bttWDBAnl4eFh9Fi9erGHDhlmrKHbt2lUzZ84s2AsEAAAAgItcU98Tdi3je8IAAAAASFefDQp1Jgz2I7wBAAAAheuaWB0RAAAAAG4UhDAAAAAAsBEhDAAAAABsRAgDAAAAABsRwgAAAADARoQwAAAAALARIQwAAAAAbEQIAwAAAAAbEcIAAAAAwEaEMAAAAACwESEMAAAAAGxECAMAAAAAGxHCAAAAAMBGhDAAAAAAsBEhDAAAAABsRAgDAAAAABsRwgAAAADARoQwAAAAALARIQwAAAAAbEQIAwAAAAAbEcIAAAAAwEaEMAAAAACwESEMAAAAAGxECAMAAAAAGxHCAAAAAMBGhDAAAAAAsBEhDAAAAABsRAgDAAAAABsRwgAAAADARoQwAAAAALARIQwAAAAAbEQIAwAAAAAbEcIAAAAAwEaEMAAAAACwESEMAAAAAGxECAMAAAAAGxHCAAAAAMBGhDAAAAAAsBEhDAAAAABsRAgDAAAAABsRwgAAAADARoQwAAAAALARIQwAAAAAbEQIAwAAAAAbEcIAAAAAwEaEMAAAAACwESEMAAAAAGxECAMAAAAAGxHCAAAAAMBGhDAAAAAAsBEhDAAAAABsRAgDAAAAABsRwgAAAADARoQwAAAAALARIQwAAAAAbEQIAwAAAAAbEcIAAAAAwEbFC7sAXB8GLtiap/3m9Wuaz5UAAAAA1zdmwgAAAADARoQwAAAAALARIQwAAAAAbEQIAwAAAAAbEcIAAAAAwEaEMAAAAACwESEMAAAAAGxECAMAAAAAGxHCAAAAAMBGhDAAAAAAsBEhDAAAAABsRAgDAAAAABsRwgAAAADARsULuwAUbQMXbM3TfvP6Nc3nSgAAAIBrAzNhAAAAAGAjQhgAAAAA2IgQBgAAAAA2IoQBAAAAgI0IYQAAAABgI0IYAAAAANiIEAYAAAAANiKEAQAAAICN+LJmXJP4kmcAAAAUVcyEAQAAAICNCGEAAAAAYCNuR0SRktfbGCVuZQQAAIA9CGHA/8fn0AAAAGAHbkcEAAAAABvdUDNhs2bN0iuvvKLExETVrl1br7/+um699dbCLgvXOWbQAAAA4I4bJoS9//77io6O1qxZs9SqVSvNmTNHd955p/bu3auKFSsWdnm4ARHeAAAAbkwOY4wp7CLs0KxZMzVq1EizZ8+22iIiInT33XcrJibmivunpaXJ6XQqNTVVJUuWLMhSc+VqFqAA3EHoAwAAcHW12eCGmAlLT0/X9u3b9fTTT7u0d+rUSRs2bMhxn3PnzuncuXPW49TUVEl/Dfi1IP3MycIuATeIqNlrC7sEXGf+9WDjPO03ZPH26+J8N4K8jikA3CiyMkFe57NuiBD2+++/KyMjQ8HBwS7twcHBSkpKynGfmJgYTZw4MVt7WFhYgdQIAEXFosFF+3w3AsYUAHLnxIkTcjqdbu93Q4SwLA6Hw+WxMSZbW5axY8fqySeftB5nZmbqzz//VGBg4CX3sUtaWprCwsJ0+PDha+LWyKKMsbYH42wfxto+jLV9GGv7MNb2Yaztk5exNsboxIkTCg0NzdM5b4gQVrZsWXl4eGSb9UpOTs42O5bF29tb3t7eLm2lSpUqqBLzpGTJkrwpbcJY24Nxtg9jbR/G2j6MtX0Ya/sw1vZxd6zzMgOW5Yb4njAvLy81btxYcXFxLu1xcXFq2bJlIVUFAAAA4EZ0Q8yESdKTTz6pqKgoNWnSRC1atNBbb72lQ4cO6bHHHivs0gAAAADcQG6YENazZ0/98ccfev7555WYmKg6deros88+U3h4eGGX5jZvb2+NHz8+2+2SyH+MtT0YZ/sw1vZhrO3DWNuHsbYPY22fwhjrG+Z7wgAAAADgWnBDfCYMAAAAAK4VhDAAAAAAsBEhDAAAAABsRAgDAAAAABsRwq4zs2bNUuXKleXj46PGjRvr66+/LuySrisxMTFq2rSpAgICFBQUpLvvvlv79u1z6WOM0YQJExQaGipfX1+1bdtWe/bscelz7tw5DR06VGXLlpW/v7+6du2qX3/91c5Lue7ExMTI4XAoOjraamOs889vv/2mhx56SIGBgfLz81ODBg20fft2aztjnT8uXLigZ599VpUrV5avr6+qVKmi559/XpmZmVYfxjpvvvrqK3Xp0kWhoaFyOBz66KOPXLbn17impKQoKipKTqdTTqdTUVFROn78eAFf3bXlcmN9/vx5jRkzRnXr1pW/v79CQ0PVp08fHTlyxOUYjHXuXOl1/XePPvqoHA6HXn/9dZd2xjp3cjPWCQkJ6tq1q5xOpwICAtS8eXMdOnTI2m7nWBPCriPvv/++oqOj9cwzz2jnzp269dZbdeedd7q8eHB569at05AhQ7Rp0ybFxcXpwoUL6tSpk06dOmX1mTJliqZNm6aZM2dq69atCgkJUceOHXXixAmrT3R0tJYvX66lS5dq/fr1OnnypCIjI5WRkVEYl3XN27p1q9566y3Vq1fPpZ2xzh8pKSlq1aqVPD099fnnn2vv3r2aOnWqSpUqZfVhrPPH5MmT9eabb2rmzJlKSEjQlClT9Morr2jGjBlWH8Y6b06dOqX69etr5syZOW7Pr3Ht3bu34uPjFRsbq9jYWMXHxysqKqrAr+9acrmxPn36tHbs2KHnnntOO3bs0LJly7R//3517drVpR9jnTtXel1n+eijj7R582aFhoZm28ZY586Vxvqnn35S69atVbNmTX355Zf69ttv9dxzz8nHx8fqY+tYG1w3brnlFvPYY4+5tNWsWdM8/fTThVTR9S85OdlIMuvWrTPGGJOZmWlCQkLMyy+/bPU5e/ascTqd5s033zTGGHP8+HHj6elpli5davX57bffTLFixUxsbKy9F3AdOHHihKlevbqJi4szbdq0McOHDzfGMNb5acyYMaZ169aX3M5Y55+77rrLDBgwwKWte/fu5qGHHjLGMNb5RZJZvny59Ti/xnXv3r1Gktm0aZPVZ+PGjUaS+f777wv4qq5NF491TrZs2WIkmYMHDxpjGOu8utRY//rrr+amm24yu3fvNuHh4ea1116ztjHWeZPTWPfs2dP6szondo81M2HXifT0dG3fvl2dOnVyae/UqZM2bNhQSFVd/1JTUyVJZcqUkSQdOHBASUlJLuPs7e2tNm3aWOO8fft2nT9/3qVPaGio6tSpw3ORgyFDhuiuu+5Shw4dXNoZ6/zz8ccfq0mTJrr//vsVFBSkhg0bau7cudZ2xjr/tG7dWl988YX2798vSfr222+1fv16de7cWRJjXVDya1w3btwop9OpZs2aWX2aN28up9PJ2F9GamqqHA6HNbvOWOefzMxMRUVF6amnnlLt2rWzbWes80dmZqY+/fRT3Xzzzbr99tsVFBSkZs2audyyaPdYE8KuE7///rsyMjIUHBzs0h4cHKykpKRCqur6ZozRk08+qdatW6tOnTqSZI3l5cY5KSlJXl5eKl269CX74C9Lly7Vjh07FBMTk20bY51/fv75Z82ePVvVq1fXypUr9dhjj2nYsGF65513JDHW+WnMmDF64IEHVLNmTXl6eqphw4aKjo7WAw88IImxLij5Na5JSUkKCgrKdvygoCDG/hLOnj2rp59+Wr1791bJkiUlMdb5afLkySpevLiGDRuW43bGOn8kJyfr5MmTevnll3XHHXdo1apVuueee9S9e3etW7dOkv1jXTyP14JC4nA4XB4bY7K1IXeeeOIJ7dq1S+vXr8+2LS/jzHPh6vDhwxo+fLhWrVrlcr/1xRjrq5eZmakmTZpo0qRJkqSGDRtqz549mj17tvr06WP1Y6yv3vvvv69FixZpyZIlql27tuLj4xUdHa3Q0FD17dvX6sdYF4z8GNec+jP2OTt//rx69eqlzMxMzZo164r9GWv3bN++XW+88YZ27Njh9pgw1u7JWjypW7duGjFihCSpQYMG2rBhg9588021adPmkvsW1FgzE3adKFu2rDw8PLKl7OTk5Gz/MogrGzp0qD7++GOtXbtWFSpUsNpDQkIk6bLjHBISovT0dKWkpFyyD/76yyU5OVmNGzdW8eLFVbx4ca1bt07Tp09X8eLFrbFirK9e+fLlVatWLZe2iIgIa9EeXtf556mnntLTTz+tXr16qW7duoqKitKIESOs2V7GumDk17iGhITo6NGj2Y5/7Ngxxv4i58+fV48ePXTgwAHFxcVZs2ASY51fvv76ayUnJ6tixYrW35MHDx7UyJEjValSJUmMdX4pW7asihcvfsW/K+0ca0LYdcLLy0uNGzdWXFycS3tcXJxatmxZSFVdf4wxeuKJJ7Rs2TKtWbNGlStXdtleuXJlhYSEuIxzenq61q1bZ41z48aN5enp6dInMTFRu3fv5rn4m/bt2+u7775TfHy89dOkSRM9+OCDio+PV5UqVRjrfNKqVatsX7Wwf/9+hYeHS+J1nZ9Onz6tYsVc/+r08PCw/pWVsS4Y+TWuLVq0UGpqqrZs2WL12bx5s1JTUxn7v8kKYD/88INWr16twMBAl+2Mdf6IiorSrl27XP6eDA0N1VNPPaWVK1dKYqzzi5eXl5o2bXrZvyttH2u3lvFAoVq6dKnx9PQ08+bNM3v37jXR0dHG39/f/PLLL4Vd2nXj8ccfN06n03z55ZcmMTHR+jl9+rTV5+WXXzZOp9MsW7bMfPfdd+aBBx4w5cuXN2lpaVafxx57zFSoUMGsXr3a7Nixw9x2222mfv365sKFC4VxWdeNv6+OaAxjnV+2bNliihcvbl566SXzww8/mMWLFxs/Pz+zaNEiqw9jnT/69u1rbrrpJvPJJ5+YAwcOmGXLlpmyZcua0aNHW30Y67w5ceKE2blzp9m5c6eRZKZNm2Z27txprciXX+N6xx13mHr16pmNGzeajRs3mrp165rIyEjbr7cwXW6sz58/b7p27WoqVKhg4uPjXf6uPHfunHUMxjp3rvS6vtjFqyMaw1jn1pXGetmyZcbT09O89dZb5ocffjAzZswwHh4e5uuvv7aOYedYE8KuM//6179MeHi48fLyMo0aNbKWVkfuSMrxZ/78+VafzMxMM378eBMSEmK8vb3NP/7xD/Pdd9+5HOfMmTPmiSeeMGXKlDG+vr4mMjLSHDp0yOaruf5cHMIY6/yzYsUKU6dOHePt7W1q1qxp3nrrLZftjHX+SEtLM8OHDzcVK1Y0Pj4+pkqVKuaZZ55x+eWUsc6btWvX5vjnc9++fY0x+Teuf/zxh3nwwQdNQECACQgIMA8++KBJSUmx6SqvDZcb6wMHDlzy78q1a9dax2Csc+dKr+uL5RTCGOvcyc1Yz5s3z1SrVs34+PiY+vXrm48++sjlGHaOtcMYY9ybOwMAAAAA5BWfCQMAAAAAGxHCAAAAAMBGhDAAAAAAsBEhDAAAAABsRAgDAAAAABsRwgAAAADARoQwAAAAALARIQwAAAAAbEQIAwC4rV+/frr77rvz/bhJSUnq2LGj/P39VapUqXw/vrsWLFhwTdRxrZkwYYIaNGhw1cf58ssv5XA4dPz48as+FgBcTwhhAHCNKqig445ffvlFDodD8fHxtpzvtddeU2JiouLj47V///4c+0yYMEEOh0MOh0MeHh4KCwvTww8/rGPHjtlS49XI7Xhm9cv6CQgIUO3atTVkyBD98MMP9hR7GaNGjdIXX3zh1j5t27ZVdHS0S1vLli2VmJgop9OZj9UBwLWPEAYAuGb89NNPaty4sapXr66goKBL9qtdu7YSExN16NAhzZ49WytWrFCfPn1y7JuRkaHMzMyCKrlArV69WomJifr22281adIkJSQkqH79+m4HoPxijNGFCxdUokQJBQYGXvXxvLy8FBISIofDkQ/VAcD1gxAGANepvXv3qnPnzipRooSCg4MVFRWl33//3dretm1bDRs2TKNHj1aZMmUUEhKiCRMmuBzj+++/V+vWreXj46NatWpp9erVcjgc+uijjyRJlStXliQ1bNhQDodDbdu2ddn/1VdfVfny5RUYGKghQ4bo/Pnzl6159uzZqlq1qry8vFSjRg29++671rZKlSrpww8/1DvvvCOHw6F+/fpd8jjFixdXSEiIbrrpJkVGRmrYsGFatWqVzpw5Y91C+Mknn6hWrVry9vbWwYMHlZKSoj59+qh06dLy8/PTnXfemW1WacGCBapYsaL8/Px0zz336I8//nDZntPsZHR0tMu4ZGZmavLkyapWrZq8vb1VsWJFvfTSS7kaz4sFBgYqJCREVapUUbdu3bR69Wo1a9ZMAwcOVEZGhtVvxYoVaty4sXx8fFSlShVNnDhRFy5csLZPmDBBFStWlLe3t0JDQzVs2DBr27lz5zR69GiFhYXJ29tb1atX17x58yT93+2CK1euVJMmTeTt7a2vv/462+2IWeMyceJEBQUFqWTJknr00UeVnp5ubV+3bp3eeOMNa3bvl19+yfF2xA8//FC1a9eWt7e3KlWqpKlTp7qMSaVKlTRp0iQNGDBAAQEBqlixot56663LjiMAXGsIYQBwHUpMTFSbNm3UoEEDbdu2TbGxsTp69Kh69Ojh0m/hwoXy9/fX5s2bNWXKFD3//POKi4uT9FdYuPvuu+Xn56fNmzfrrbfe0jPPPOOy/5YtWyT934zMsmXLrG1r167VTz/9pLVr12rhwoVasGCBFixYcMmaly9fruHDh2vkyJHavXu3Hn30UfXv319r166VJG3dulV33HGHevToocTERL3xxhu5Hg9fX19lZmZaweP06dOKiYnRv//9b+3Zs0dBQUHq16+ftm3bpo8//lgbN26UMUadO3e2guPmzZs1YMAADR48WPHx8WrXrp1efPHFXNeQZezYsZo8ebKee+457d27V0uWLFFwcLCky49nbhQrVkzDhw/XwYMHtX37dknSypUr9dBDD2nYsGHau3ev5syZowULFljB74MPPtBrr72mOXPm6IcfftBHH32kunXrWsfs06ePli5dqunTpyshIUFvvvmmSpQo4XLe0aNHKyYmRgkJCapXr16OtX3xxRdKSEjQ2rVr9d5772n58uWaOHGiJOmNN95QixYtNGjQICUmJioxMVFhYWHZjrF9+3b16NFDvXr10nfffacJEyboueeey/a6mjp1qpo0aaKdO3dq8ODBevzxx/X999+7NZYAUKgMAOCa1LdvX9OtW7cctz333HOmU6dOLm2HDx82ksy+ffuMMca0adPGtG7d2qVP06ZNzZgxY4wxxnz++eemePHiJjEx0doeFxdnJJnly5cbY4w5cOCAkWR27tyZrbbw8HBz4cIFq+3+++83PXv2vOT1tGzZ0gwaNMil7f777zedO3e2Hnfr1s307dv3kscwxpjx48eb+vXrW48TEhJMtWrVzC233GKMMWb+/PlGkomPj7f67N+/30gy33zzjdX2+++/G19fX/Of//zHGGPMAw88YO644w6Xc/Xs2dM4nU6X6774ORk+fLhp06aNMcaYtLQ04+3tbebOnZtj7ZcaT3f6JSQkGEnm/fffN8YYc+utt5pJkya59Hn33XdN+fLljTHGTJ061dx8880mPT0927H27dtnJJm4uLgc61i7dq2RZD766COX9oufg759+5oyZcqYU6dOWW2zZ882JUqUMBkZGcaYv16Pw4cPz/H4KSkpxhhjevfubTp27OjS56mnnjK1atWyHoeHh5uHHnrIepyZmWmCgoLM7Nmzc7wGALgWMRMGANeh7du3a+3atSpRooT1U7NmTUl/fa4qy8WzFuXLl1dycrIkad++fQoLC1NISIi1/ZZbbsl1DbVr15aHh0eOx85JQkKCWrVq5dLWqlUrJSQk5PqcWb777juVKFFCvr6+qlWrlsLCwrR48WJru5eXl8u1JyQkqHjx4mrWrJnVFhgYqBo1aljnT0hIUIsWLVzOc/HjK0lISNC5c+fUvn17t68pt4wxkmR9jmr79u16/vnnXV4LWTNOp0+f1v33368zZ86oSpUqGjRokJYvX27NGMbHx8vDw0Nt2rS57DmbNGlyxbrq168vPz8/63GLFi108uRJHT58ONfXdqnXyA8//OBy++Xfn1uHw6GQkJDLvvYA4FpTvLALAAC4LzMzU126dNHkyZOzbStfvrz1/56eni7bHA6HtUiFMeaqFkS43LEv5eLz5bWGGjVq6OOPP5aHh4dCQ0Pl7e3tst3X19fluFnB5WJ/P/+l+vxdsWLFsvX7++fgfH19c30NeZUVGrM+X5aZmamJEyeqe/fu2fr6+PgoLCxM+/btU1xcnFavXq3BgwfrlVde0bp163Jdr7+/f57rdef5zen1kNPzkpfXHgBcS5gJA4DrUKNGjbRnzx5VqlRJ1apVc/nJ7S/MNWvW1KFDh3T06FGrbevWrS59vLy8JMllFiKvIiIitH79epe2DRs2KCIiwu1jeXl5qVq1aqpcuXK2AJaTWrVq6cKFC9q8ebPV9scff2j//v3W+WvVqqVNmza57Hfx43LlyikxMdGl7e/LzVevXl2+vr6XXL3wasczMzNT06dPV+XKldWwYUNJf70W9u3bl+11UK1aNRUr9tdf876+vurataumT5+uL7/8Uhs3btR3332nunXrKjMzU+vWrctTPX/37bff6syZM9bjTZs2qUSJEqpQoYKkv679Stddq1atHF8jN998s8usKwBc75gJA4BrWGpqarbvlCpTpoyGDBmiuXPn6oEHHtBTTz2lsmXL6scff9TSpUs1d+7cXP3C2rFjR1WtWlV9+/bVlClTdOLECWthjqzZiKCgIPn6+io2NlYVKlSQj49Pnr/T6amnnlKPHj3UqFEjtW/fXitWrNCyZcu0evXqPB3PHdWrV1e3bt00aNAgzZkzRwEBAXr66ad10003qVu3bpKkYcOGqWXLlpoyZYruvvturVq1SrGxsS7Hue222/TKK6/onXfeUYsWLbRo0SLt3r3bCkQ+Pj4aM2aMRo8eLS8vL7Vq1UrHjh3Tnj17NHDgQLfH848//lBSUpJOnz6t3bt36/XXX9eWLVv06aefWs/xuHHjFBkZqbCwMN1///0qVqyYdu3ape+++04vvviiFixYoIyMDDVr1kx+fn5699135evrq/DwcAUGBqpv374aMGCApk+frvr16+vgwYNKTk7OtsjLlaSnp2vgwIF69tlndfDgQY0fP15PPPGEFQQrVaqkzZs365dfflGJEiVUpkyZbMcYOXKkmjZtqhdeeEE9e/bUxo0bNXPmTM2aNcutWgDgWsdMGABcw7788ks1bNjQ5WfcuHEKDQ3VN998o4yMDN1+++2qU6eOhg8fLqfTaf3SeyUeHh766KOPdPLkSTVt2lQPP/ywnn32WUl/hQnpr6Xgp0+frjlz5ig0NNQKLHlx991364033tArr7yi2rVra86cOZo/f/4Vl2nPL/Pnz1fjxo0VGRmpFi1ayBijzz77zLq1rXnz5vr3v/+tGTNmqEGDBlq1apU1Hlluv/12Pffccxo9erSaNm2qEydOZPt+sueee04jR47UuHHjFBERoZ49e1qfV3J3PDt06KDy5curbt26evrppxUREaFdu3apXbt2LjV98skniouLU9OmTdW8eXNNmzZN4eHhkqRSpUpp7ty5atWqlerVq6cvvvhCK1assL7na/bs2brvvvs0ePBg1axZU4MGDdKpU6fcHt/27durevXq+sc//qEePXqoS5cuLl+JMGrUKHl4eKhWrVoqV66cDh06lO0YjRo10n/+8x8tXbpUderU0bhx4/T8889f9usKAOB65DC5uQkeAHBD+Oabb9S6dWv9+OOPqlq1amGXg+tEv379dPz4cev75QAAl8ftiABwA1u+fLlKlCih6tWr68cff9Tw4cPVqlUrAhgAAAWIEAYAN7ATJ05o9OjROnz4sMqWLasOHTpo6tSphV0WAABFGrcjAgAAAICNWJgDAAAAAGxECAMAAAAAGxHCAAAAAMBGhDAAAAAAsBEhDAAAAABsRAgDAAAAABsRwgAAAADARoQwAAAAALDR/wNXy71VYw3p5gAAAABJRU5ErkJggg==",
      "text/plain": [
       "<Figure size 1000x600 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "count    12778.000000\n",
       "mean        43.824542\n",
       "std         94.837469\n",
       "min          1.000000\n",
       "25%          8.000000\n",
       "50%         17.000000\n",
       "75%         38.000000\n",
       "max       1550.000000\n",
       "Name: desc_length, dtype: float64"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Calculate the length of each product description in terms of words\n",
    "product_info['desc_length'] = product_info['제품특성'].apply(lambda x: len(x.split()))\n",
    "\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# Plot the distribution of description lengths\n",
    "plt.figure(figsize=(10, 6))\n",
    "plt.hist(product_info['desc_length'], bins=50, alpha=0.7)\n",
    "plt.title('Distribution of Prod\"uct Description Lengths')\n",
    "plt.xlabel('Length of Product Description')\n",
    "plt.ylabel('Number of Products')\n",
    "plt.show()\n",
    "\n",
    "# Display basic statistics of description lengths\n",
    "product_info['desc_length'].describe()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "3cd54625",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Interquartile Range (IQR): 30.0\n",
      "Lower Bound for Too Short Descriptions: -37.0\n",
      "Number of Descriptions Considered Too Short: 0\n"
     ]
    }
   ],
   "source": [
    "# Calculate the Interquartile Range (IQR)\n",
    "Q1 = product_info['desc_length'].quantile(0.25)\n",
    "Q3 = product_info['desc_length'].quantile(0.75)\n",
    "IQR = Q3 - Q1\n",
    "\n",
    "# Define a factor to identify outliers; commonly used factor is 1.5\n",
    "factor = 1.5\n",
    "\n",
    "# Calculate the lower bound to identify too short descriptions\n",
    "lower_bound = Q1 - (factor * IQR)\n",
    "\n",
    "print(f\"Interquartile Range (IQR): {IQR}\")\n",
    "print(f\"Lower Bound for Too Short Descriptions: {lower_bound}\")\n",
    "\n",
    "# Determine the number of descriptions considered too short based on this threshold\n",
    "too_short_descriptions = product_info[product_info['desc_length'] < lower_bound]\n",
    "num_too_short_descriptions = too_short_descriptions.shape[0]\n",
    "\n",
    "print(f\"Number of Descriptions Considered Too Short: {num_too_short_descriptions}\")\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0bd7bc40",
   "metadata": {},
   "source": [
    "### 너무 짧은 데이터는 충분한 정보를 주지 않기 때문에, invalid 데이터로 간주하려 했지만, IQR 방법에 의하면 음수의 길이를 제거해야 한다. 그러므로, 삭제하지 않기로 결정\n",
    "\n",
    "### 그래도 데이터를 직접 확인하는 것이 좋다고 판단"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "b66552aa",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>제품</th>\n",
       "      <th>제품특성</th>\n",
       "      <th>desc_length</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1431</th>\n",
       "      <td>B002-00908-00002</td>\n",
       "      <td>사용횟수:다회용</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1433</th>\n",
       "      <td>B002-01001-00001</td>\n",
       "      <td>사용횟수:다회용</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2107</th>\n",
       "      <td>B002-01989-00002</td>\n",
       "      <td>종류:치간칫솔(I자형)</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2149</th>\n",
       "      <td>B002-02246-00002</td>\n",
       "      <td>기능기능기능특징:충치예방</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2486</th>\n",
       "      <td>B002-02272-00001</td>\n",
       "      <td>겹수롤수길이:2겹</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2499</th>\n",
       "      <td>B002-01497-00001</td>\n",
       "      <td>겹수롤수길이:3겹</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2528</th>\n",
       "      <td>B002-00303-00003</td>\n",
       "      <td>겹수롤수길이:2겹</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2748</th>\n",
       "      <td>B002-01829-00005</td>\n",
       "      <td>매수정수과정:100매</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2899</th>\n",
       "      <td>B002-01615-00001</td>\n",
       "      <td>제품타입사이즈:날개형</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3173</th>\n",
       "      <td>B002-00649-00001</td>\n",
       "      <td>구성헤드종류부가기능:면도기</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3176</th>\n",
       "      <td>B002-03066-00010</td>\n",
       "      <td>날수:5중날</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3185</th>\n",
       "      <td>B002-01905-00015</td>\n",
       "      <td>종류구성날수부가기능:날교체용</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3189</th>\n",
       "      <td>B002-01905-00024</td>\n",
       "      <td>종류구성날수헤드종류부가기능부가기능부가기능부가기능부가기능부가기능:날교체용</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3190</th>\n",
       "      <td>B002-01905-00025</td>\n",
       "      <td>종류구성날수헤드종류부가기능부가기능부가기능부가기능부가기능부가기능:날교체용</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3345</th>\n",
       "      <td>B002-03262-00032</td>\n",
       "      <td>품목품목:면도기충전기</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4791</th>\n",
       "      <td>B002-00338-00001</td>\n",
       "      <td>용도:휴대용</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4824</th>\n",
       "      <td>B002-00417-00001</td>\n",
       "      <td>특징:비스페놀A(BPA)-free</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6015</th>\n",
       "      <td>B002-00203-00001</td>\n",
       "      <td>타입매수정수과정:플레인</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6136</th>\n",
       "      <td>B002-03066-00014</td>\n",
       "      <td>날수:4중날</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6137</th>\n",
       "      <td>B002-03789-00002</td>\n",
       "      <td>종류구성헤드종류:날교체용</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6139</th>\n",
       "      <td>B002-01905-00043</td>\n",
       "      <td>종류구성날수헤드종류부가기능부가기능부가기능부가기능부가기능부가기능:날교체용</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6140</th>\n",
       "      <td>B002-01905-00045</td>\n",
       "      <td>종류구성날수헤드종류부가기능부가기능부가기능부가기능부가기능부가기능:날교체용</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6586</th>\n",
       "      <td>B002-02193-00004</td>\n",
       "      <td>종류:손가락칫솔</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6956</th>\n",
       "      <td>B002-03659-00006</td>\n",
       "      <td>매수:72매</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6998</th>\n",
       "      <td>B002-02324-00008</td>\n",
       "      <td>구성:면도기</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6999</th>\n",
       "      <td>B002-03066-00016</td>\n",
       "      <td>종류구성날수:일회용</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7174</th>\n",
       "      <td>B002-02906-00001</td>\n",
       "      <td>종류특징:수유쿠션</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7865</th>\n",
       "      <td>B002-03436-00037</td>\n",
       "      <td>세트구성:캡형+휴대용</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8033</th>\n",
       "      <td>B002-02918-00039</td>\n",
       "      <td>종류구성날수헤드종류부가기능부가기능:날교체용</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8036</th>\n",
       "      <td>B002-03066-00023</td>\n",
       "      <td>종류:날교체용</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8038</th>\n",
       "      <td>B002-03066-00029</td>\n",
       "      <td>종류구성날수:날교체용</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8041</th>\n",
       "      <td>B002-01905-00056</td>\n",
       "      <td>구성날수부가기능:면도기+면도날</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8739</th>\n",
       "      <td>B002-00288-00004</td>\n",
       "      <td>세트구성:캡형+휴대용</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9015</th>\n",
       "      <td>B002-01905-00072</td>\n",
       "      <td>종류구성날수헤드종류부가기능부가기능부가기능부가기능부가기능부가기능:날교체용</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9556</th>\n",
       "      <td>B002-01905-00076</td>\n",
       "      <td>종류구성날수:날교체용</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9733</th>\n",
       "      <td>B002-00372-00003</td>\n",
       "      <td>칫솔모타입:미세모(극세모)</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9862</th>\n",
       "      <td>B002-00005-00010</td>\n",
       "      <td>형태기능기능용량:일반용기형</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9878</th>\n",
       "      <td>B002-03411-00014</td>\n",
       "      <td>종류:기타유축기소품</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9968</th>\n",
       "      <td>B002-03411-00015</td>\n",
       "      <td>종류:기타유축기소품</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10165</th>\n",
       "      <td>B002-02973-00002</td>\n",
       "      <td>종류:손가락칫솔</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10427</th>\n",
       "      <td>B002-02918-00051</td>\n",
       "      <td>종류:날교체용</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11374</th>\n",
       "      <td>B002-03052-00001</td>\n",
       "      <td>품목:면도망</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11572</th>\n",
       "      <td>B002-01067-00001</td>\n",
       "      <td>종류:손가락칫솔</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12093</th>\n",
       "      <td>B002-03066-00037</td>\n",
       "      <td>날수:5중날</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12264</th>\n",
       "      <td>B002-02481-00008</td>\n",
       "      <td>종류:치실(손잡이형)</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12663</th>\n",
       "      <td>B002-00978-00016</td>\n",
       "      <td>품목:면도날</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                     제품                                      제품특성  desc_length\n",
       "1431   B002-00908-00002                                 사용횟수:다회용             1\n",
       "1433   B002-01001-00001                                 사용횟수:다회용             1\n",
       "2107   B002-01989-00002                             종류:치간칫솔(I자형)             1\n",
       "2149   B002-02246-00002                            기능기능기능특징:충치예방             1\n",
       "2486   B002-02272-00001                                겹수롤수길이:2겹             1\n",
       "2499   B002-01497-00001                                겹수롤수길이:3겹             1\n",
       "2528   B002-00303-00003                                겹수롤수길이:2겹             1\n",
       "2748   B002-01829-00005                              매수정수과정:100매             1\n",
       "2899   B002-01615-00001                              제품타입사이즈:날개형             1\n",
       "3173   B002-00649-00001                           구성헤드종류부가기능:면도기             1\n",
       "3176   B002-03066-00010                                   날수:5중날             1\n",
       "3185   B002-01905-00015                          종류구성날수부가기능:날교체용             1\n",
       "3189   B002-01905-00024  종류구성날수헤드종류부가기능부가기능부가기능부가기능부가기능부가기능:날교체용             1\n",
       "3190   B002-01905-00025  종류구성날수헤드종류부가기능부가기능부가기능부가기능부가기능부가기능:날교체용             1\n",
       "3345   B002-03262-00032                              품목품목:면도기충전기             1\n",
       "4791   B002-00338-00001                                   용도:휴대용             1\n",
       "4824   B002-00417-00001                       특징:비스페놀A(BPA)-free             1\n",
       "6015   B002-00203-00001                             타입매수정수과정:플레인             1\n",
       "6136   B002-03066-00014                                   날수:4중날             1\n",
       "6137   B002-03789-00002                            종류구성헤드종류:날교체용             1\n",
       "6139   B002-01905-00043  종류구성날수헤드종류부가기능부가기능부가기능부가기능부가기능부가기능:날교체용             1\n",
       "6140   B002-01905-00045  종류구성날수헤드종류부가기능부가기능부가기능부가기능부가기능부가기능:날교체용             1\n",
       "6586   B002-02193-00004                                 종류:손가락칫솔             1\n",
       "6956   B002-03659-00006                                   매수:72매             1\n",
       "6998   B002-02324-00008                                   구성:면도기             1\n",
       "6999   B002-03066-00016                               종류구성날수:일회용             1\n",
       "7174   B002-02906-00001                                종류특징:수유쿠션             1\n",
       "7865   B002-03436-00037                              세트구성:캡형+휴대용             1\n",
       "8033   B002-02918-00039                  종류구성날수헤드종류부가기능부가기능:날교체용             1\n",
       "8036   B002-03066-00023                                  종류:날교체용             1\n",
       "8038   B002-03066-00029                              종류구성날수:날교체용             1\n",
       "8041   B002-01905-00056                         구성날수부가기능:면도기+면도날             1\n",
       "8739   B002-00288-00004                              세트구성:캡형+휴대용             1\n",
       "9015   B002-01905-00072  종류구성날수헤드종류부가기능부가기능부가기능부가기능부가기능부가기능:날교체용             1\n",
       "9556   B002-01905-00076                              종류구성날수:날교체용             1\n",
       "9733   B002-00372-00003                           칫솔모타입:미세모(극세모)             1\n",
       "9862   B002-00005-00010                           형태기능기능용량:일반용기형             1\n",
       "9878   B002-03411-00014                               종류:기타유축기소품             1\n",
       "9968   B002-03411-00015                               종류:기타유축기소품             1\n",
       "10165  B002-02973-00002                                 종류:손가락칫솔             1\n",
       "10427  B002-02918-00051                                  종류:날교체용             1\n",
       "11374  B002-03052-00001                                   품목:면도망             1\n",
       "11572  B002-01067-00001                                 종류:손가락칫솔             1\n",
       "12093  B002-03066-00037                                   날수:5중날             1\n",
       "12264  B002-02481-00008                              종류:치실(손잡이형)             1\n",
       "12663  B002-00978-00016                                   품목:면도날             1"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "short_feature_rows = product_info[product_info[\"제품특성\"].apply(lambda x: len(x.split()) < 2)]\n",
    "\n",
    "short_feature_rows"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e0889c83",
   "metadata": {},
   "source": [
    "### 데이터를 살펴보면, 짧은 단어를 가지고 있는 데이터도 카테고리를 예측하는데 활용할 수 있을 것으로 예상"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "68586789",
   "metadata": {},
   "source": [
    "### 2) 같은 단어를 반복하는 데이터"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "bea84470",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "제품                                     B002-01905-00072\n",
       "제품특성           종류구성날수헤드종류부가기능부가기능부가기능부가기능부가기능부가기능:날교체용 \n",
       "desc_length                                           1\n",
       "Name: 9015, dtype: object"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#example\n",
    "product_info.loc[9015]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "19a4ea8d",
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>제품</th>\n",
       "      <th>제품특성</th>\n",
       "      <th>consecutive_repeats</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>B002-01075-00001</td>\n",
       "      <td>제품타입섭취방법섭취대상섭취횟수1일 총 섭취량제품용량주요 기능성(식약처인증):정, 생...</td>\n",
       "      <td>46</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>B002-01531-00010</td>\n",
       "      <td>주요 기능성(식약처인증):체지방 감소 영양소 원료명(식약처고시):비타민B1 영양소 ...</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>99</th>\n",
       "      <td>B002-01848-00003</td>\n",
       "      <td>제품타입섭취방법섭취대상섭취횟수1일 총 섭취량주요 기능성(식약처인증):캡슐, 주요 기...</td>\n",
       "      <td>8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100</th>\n",
       "      <td>B002-01848-00004</td>\n",
       "      <td>HCA1일 총 섭취량제품용량제품타입섭취횟수섭취방법섭취대상주요 기능성(식약처인증):1...</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>101</th>\n",
       "      <td>B002-01848-00006</td>\n",
       "      <td>제품타입섭취방법섭취대상섭취횟수1일 총 섭취량제품용량주요 기능성(식약처인증)카테킨:정...</td>\n",
       "      <td>80</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12653</th>\n",
       "      <td>B002-01438-00001</td>\n",
       "      <td>구성:본품 형태:액상형 :1개, 구성형태:본품, 구성형태:본품, 구성형태:본품, 구...</td>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12738</th>\n",
       "      <td>B002-00661-00003</td>\n",
       "      <td>타입:플레인 평량:40gsm 매수:100매 정수과정:10단계정수 :20팩, 타입평량...</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12744</th>\n",
       "      <td>B002-01856-00006</td>\n",
       "      <td>주요 기능성(식약처인증)영양소 원료명(식약처고시)영양소 원료명(식약처고시)영양소 원...</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12759</th>\n",
       "      <td>B002-01625-00002</td>\n",
       "      <td>종류:치간칫솔(L자형), 종류:치간칫솔(L자형) 특징:교정용 특징:개별포장 재질:플...</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12762</th>\n",
       "      <td>B002-00136-00003</td>\n",
       "      <td>용량:100ml(g) :1개, 용량:100ml(g), 용량:100ml(g), 제품형...</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>508 rows × 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                     제품                                               제품특성  \\\n",
       "7      B002-01075-00001  제품타입섭취방법섭취대상섭취횟수1일 총 섭취량제품용량주요 기능성(식약처인증):정, 생...   \n",
       "23     B002-01531-00010  주요 기능성(식약처인증):체지방 감소 영양소 원료명(식약처고시):비타민B1 영양소 ...   \n",
       "99     B002-01848-00003  제품타입섭취방법섭취대상섭취횟수1일 총 섭취량주요 기능성(식약처인증):캡슐, 주요 기...   \n",
       "100    B002-01848-00004  HCA1일 총 섭취량제품용량제품타입섭취횟수섭취방법섭취대상주요 기능성(식약처인증):1...   \n",
       "101    B002-01848-00006  제품타입섭취방법섭취대상섭취횟수1일 총 섭취량제품용량주요 기능성(식약처인증)카테킨:정...   \n",
       "...                 ...                                                ...   \n",
       "12653  B002-01438-00001  구성:본품 형태:액상형 :1개, 구성형태:본품, 구성형태:본품, 구성형태:본품, 구...   \n",
       "12738  B002-00661-00003  타입:플레인 평량:40gsm 매수:100매 정수과정:10단계정수 :20팩, 타입평량...   \n",
       "12744  B002-01856-00006  주요 기능성(식약처인증)영양소 원료명(식약처고시)영양소 원료명(식약처고시)영양소 원...   \n",
       "12759  B002-01625-00002  종류:치간칫솔(L자형), 종류:치간칫솔(L자형) 특징:교정용 특징:개별포장 재질:플...   \n",
       "12762  B002-00136-00003  용량:100ml(g) :1개, 용량:100ml(g), 용량:100ml(g), 제품형...   \n",
       "\n",
       "       consecutive_repeats  \n",
       "7                       46  \n",
       "23                       5  \n",
       "99                       8  \n",
       "100                      2  \n",
       "101                     80  \n",
       "...                    ...  \n",
       "12653                    6  \n",
       "12738                    1  \n",
       "12744                    7  \n",
       "12759                    1  \n",
       "12762                    1  \n",
       "\n",
       "[508 rows x 3 columns]"
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "def detect_consecutive_repeated_words(text):\n",
    "    \"\"\"\n",
    "    Detects consecutive repeating words in a given text and returns a count of such occurrences.\n",
    "    \"\"\"\n",
    "    words = text.split()\n",
    "    consecutive_repeats = 0\n",
    "    for i in range(len(words) - 1):\n",
    "        if words[i] == words[i + 1]:\n",
    "            consecutive_repeats += 1\n",
    "    \n",
    "    return consecutive_repeats\n",
    "\n",
    "# Apply the refined function to the '제품특성' column and find rows with consecutive repeated words\n",
    "product_info['consecutive_repeats'] = product_info['제품특성'].apply(detect_consecutive_repeated_words)\n",
    "\n",
    "# Filter rows with at least one occurrence of consecutive repeated words\n",
    "\n",
    "repeated_consecutive_rows = product_info[product_info['consecutive_repeats'] > 0]\n",
    "repeated_consecutive_rows[['제품','제품특성', 'consecutive_repeats']]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d4b0be2a",
   "metadata": {},
   "source": [
    "### '정상 데이터'와 '비정상적으로 반복 문구 데이터'가 여전히 섞여서 걸러짐. 의미 없는 반복이 있는 데이터여도 키워드를 뽑아낼 수 있는 데이터들이기 때문에 일단 사용"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "35728138",
   "metadata": {},
   "source": [
    "### 3. 텍스트 분석\n",
    "### 1) Text Cleaning"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "f93cf026",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>제품특성</th>\n",
       "      <th>cleaned_제품특성</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>제품유형:일반식품 콜라겐 펩타이드:1000mg 종류:어류 분자량:300Da 섭취대상...</td>\n",
       "      <td>제품유형:일반식품 콜라겐 펩타이드:1000mg 종류:어류 분자량:300Da 섭취대상...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>700mg x 28정</td>\n",
       "      <td>700mg x 28정</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 두 번 1일 총 섭...</td>\n",
       "      <td>제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 두 번 1일 총 섭...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 섭...</td>\n",
       "      <td>제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 섭...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>HCA:900mg 영양소 원료명(식약처고시):비타민B1 영양소 원료명(식약처고시):...</td>\n",
       "      <td>HCA:900mg 영양소 원료명 식약처고시 :비타민B1 영양소 원료명 식약처고시 :...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                제품특성  \\\n",
       "0  제품유형:일반식품 콜라겐 펩타이드:1000mg 종류:어류 분자량:300Da 섭취대상...   \n",
       "1                                        700mg x 28정   \n",
       "2  제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 두 번 1일 총 섭...   \n",
       "3  제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 섭...   \n",
       "4  HCA:900mg 영양소 원료명(식약처고시):비타민B1 영양소 원료명(식약처고시):...   \n",
       "\n",
       "                                        cleaned_제품특성  \n",
       "0  제품유형:일반식품 콜라겐 펩타이드:1000mg 종류:어류 분자량:300Da 섭취대상...  \n",
       "1                                        700mg x 28정  \n",
       "2  제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 두 번 1일 총 섭...  \n",
       "3  제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 섭...  \n",
       "4  HCA:900mg 영양소 원료명 식약처고시 :비타민B1 영양소 원료명 식약처고시 :...  "
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import re\n",
    "\n",
    "# Define a new text cleaning function that retains Korean characters, digits, English characters, and the colon\n",
    "def clean_text_keep_colon_digits_english(text):\n",
    "    # Pattern to keep Korean text, digits, English letters and colon\n",
    "    pattern = re.compile(r'[^가-힣0-9a-zA-Z:\\s]')\n",
    "    text = pattern.sub(' ', text)  # Replace characters not matching the pattern with a space\n",
    "    text = ' '.join(text.split())  # Remove any extra spaces\n",
    "    return text\n",
    "\n",
    "# Re-applying the cleaning function to the correct column '제품특성' in the dataset\n",
    "product_info['cleaned_제품특성'] = product_info['제품특성'].apply(clean_text_keep_colon_digits_english)\n",
    "\n",
    "# Displaying the first few rows of the dataset to verify the cleaning\n",
    "product_info[['제품특성', 'cleaned_제품특성']].head()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ecb13338",
   "metadata": {},
   "source": [
    "### 2) ':'를 기준으로 dictionary 생성"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "359baeef",
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>제품</th>\n",
       "      <th>제품특성</th>\n",
       "      <th>desc_length</th>\n",
       "      <th>consecutive_repeats</th>\n",
       "      <th>cleaned_제품특성</th>\n",
       "      <th>parsed_제품특성</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>B002-03509-00001</td>\n",
       "      <td>제품유형:일반식품 콜라겐 펩타이드:1000mg 종류:어류 분자량:300Da 섭취대상...</td>\n",
       "      <td>20</td>\n",
       "      <td>0</td>\n",
       "      <td>제품유형:일반식품 콜라겐 펩타이드:1000mg 종류:어류 분자량:300Da 섭취대상...</td>\n",
       "      <td>{'제품유형': '일반식품', '콜라겐 펩타이드': '1000mg', '종류': '...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>B002-02376-00001</td>\n",
       "      <td>700mg x 28정</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>700mg x 28정</td>\n",
       "      <td>{}</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>B002-03735-00001</td>\n",
       "      <td>제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 두 번 1일 총 섭...</td>\n",
       "      <td>75</td>\n",
       "      <td>0</td>\n",
       "      <td>제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 두 번 1일 총 섭...</td>\n",
       "      <td>{'제품타입': '정', '섭취방법': '물과', '함께 섭취대상': '성인남녀',...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>B002-03735-00003</td>\n",
       "      <td>제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 섭...</td>\n",
       "      <td>15</td>\n",
       "      <td>0</td>\n",
       "      <td>제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 섭...</td>\n",
       "      <td>{'제품타입': '정', '섭취방법': '물과', '함께 섭취대상': '성인남녀',...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>B002-02769-00001</td>\n",
       "      <td>HCA:900mg 영양소 원료명(식약처고시):비타민B1 영양소 원료명(식약처고시):...</td>\n",
       "      <td>25</td>\n",
       "      <td>0</td>\n",
       "      <td>HCA:900mg 영양소 원료명 식약처고시 :비타민B1 영양소 원료명 식약처고시 :...</td>\n",
       "      <td>{'HCA': '900mg', '영양소 원료명 식약처고시': '판토텐산', '1일 ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12773</th>\n",
       "      <td>B002-01994-00001</td>\n",
       "      <td>형태:액상형 구성:리필 등급:1종 용도:식기 용도:과일 용도:야채 용도:조리기구 용...</td>\n",
       "      <td>10</td>\n",
       "      <td>0</td>\n",
       "      <td>형태:액상형 구성:리필 등급:1종 용도:식기 용도:과일 용도:야채 용도:조리기구 용...</td>\n",
       "      <td>{'형태': '액상형', '구성': '리필', '등급': '1종', '용도': '조...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12774</th>\n",
       "      <td>B002-02600-00002</td>\n",
       "      <td>헤어타입:모든 모발용 주요제품특징:머릿결개선 세부제품특징:촉촉함(수분공급) 세부제품...</td>\n",
       "      <td>8</td>\n",
       "      <td>0</td>\n",
       "      <td>헤어타입:모든 모발용 주요제품특징:머릿결개선 세부제품특징:촉촉함 수분공급 세부제품특...</td>\n",
       "      <td>{'헤어타입': '모든', '모발용 주요제품특징': '머릿결개선', '세부제품특징'...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12775</th>\n",
       "      <td>B002-02372-00095</td>\n",
       "      <td>사용대상:여성용 타입:일자형 흡수량:20ml :1팩 32개</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>사용대상:여성용 타입:일자형 흡수량:20ml :1팩 32개</td>\n",
       "      <td>{'사용대상': '여성용', '타입': '일자형', '20ml': '1팩 32개'}</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12776</th>\n",
       "      <td>B002-01318-00002</td>\n",
       "      <td>피부타입:모든피부용 향계열:무향 주요제품특징:촉촉함(수분공급) 주요제품특징:풍부한 ...</td>\n",
       "      <td>25</td>\n",
       "      <td>0</td>\n",
       "      <td>피부타입:모든피부용 향계열:무향 주요제품특징:촉촉함 수분공급 주요제품특징:풍부한 거...</td>\n",
       "      <td>{'피부타입': '모든피부용', '향계열': '무향', '주요제품특징': '세정력'...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12777</th>\n",
       "      <td>B002-02473-00064</td>\n",
       "      <td>최소연령:4개월 단계별:2단계 종류:일반분유 제품형태:분말 포장형태:캔 용량:800...</td>\n",
       "      <td>105</td>\n",
       "      <td>0</td>\n",
       "      <td>최소연령:4개월 단계별:2단계 종류:일반분유 제품형태:분말 포장형태:캔 용량:800...</td>\n",
       "      <td>{'최소연령': '6개월', '단계별': '3단계', '종류': '일반분유', '제...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>12778 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                     제품                                               제품특성  \\\n",
       "0      B002-03509-00001  제품유형:일반식품 콜라겐 펩타이드:1000mg 종류:어류 분자량:300Da 섭취대상...   \n",
       "1      B002-02376-00001                                        700mg x 28정   \n",
       "2      B002-03735-00001  제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 두 번 1일 총 섭...   \n",
       "3      B002-03735-00003  제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 섭...   \n",
       "4      B002-02769-00001  HCA:900mg 영양소 원료명(식약처고시):비타민B1 영양소 원료명(식약처고시):...   \n",
       "...                 ...                                                ...   \n",
       "12773  B002-01994-00001  형태:액상형 구성:리필 등급:1종 용도:식기 용도:과일 용도:야채 용도:조리기구 용...   \n",
       "12774  B002-02600-00002  헤어타입:모든 모발용 주요제품특징:머릿결개선 세부제품특징:촉촉함(수분공급) 세부제품...   \n",
       "12775  B002-02372-00095                   사용대상:여성용 타입:일자형 흡수량:20ml :1팩 32개   \n",
       "12776  B002-01318-00002  피부타입:모든피부용 향계열:무향 주요제품특징:촉촉함(수분공급) 주요제품특징:풍부한 ...   \n",
       "12777  B002-02473-00064  최소연령:4개월 단계별:2단계 종류:일반분유 제품형태:분말 포장형태:캔 용량:800...   \n",
       "\n",
       "       desc_length  consecutive_repeats  \\\n",
       "0               20                    0   \n",
       "1                3                    0   \n",
       "2               75                    0   \n",
       "3               15                    0   \n",
       "4               25                    0   \n",
       "...            ...                  ...   \n",
       "12773           10                    0   \n",
       "12774            8                    0   \n",
       "12775            5                    0   \n",
       "12776           25                    0   \n",
       "12777          105                    0   \n",
       "\n",
       "                                            cleaned_제품특성  \\\n",
       "0      제품유형:일반식품 콜라겐 펩타이드:1000mg 종류:어류 분자량:300Da 섭취대상...   \n",
       "1                                            700mg x 28정   \n",
       "2      제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 두 번 1일 총 섭...   \n",
       "3      제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 섭...   \n",
       "4      HCA:900mg 영양소 원료명 식약처고시 :비타민B1 영양소 원료명 식약처고시 :...   \n",
       "...                                                  ...   \n",
       "12773  형태:액상형 구성:리필 등급:1종 용도:식기 용도:과일 용도:야채 용도:조리기구 용...   \n",
       "12774  헤어타입:모든 모발용 주요제품특징:머릿결개선 세부제품특징:촉촉함 수분공급 세부제품특...   \n",
       "12775                   사용대상:여성용 타입:일자형 흡수량:20ml :1팩 32개   \n",
       "12776  피부타입:모든피부용 향계열:무향 주요제품특징:촉촉함 수분공급 주요제품특징:풍부한 거...   \n",
       "12777  최소연령:4개월 단계별:2단계 종류:일반분유 제품형태:분말 포장형태:캔 용량:800...   \n",
       "\n",
       "                                             parsed_제품특성  \n",
       "0      {'제품유형': '일반식품', '콜라겐 펩타이드': '1000mg', '종류': '...  \n",
       "1                                                     {}  \n",
       "2      {'제품타입': '정', '섭취방법': '물과', '함께 섭취대상': '성인남녀',...  \n",
       "3      {'제품타입': '정', '섭취방법': '물과', '함께 섭취대상': '성인남녀',...  \n",
       "4      {'HCA': '900mg', '영양소 원료명 식약처고시': '판토텐산', '1일 ...  \n",
       "...                                                  ...  \n",
       "12773  {'형태': '액상형', '구성': '리필', '등급': '1종', '용도': '조...  \n",
       "12774  {'헤어타입': '모든', '모발용 주요제품특징': '머릿결개선', '세부제품특징'...  \n",
       "12775     {'사용대상': '여성용', '타입': '일자형', '20ml': '1팩 32개'}  \n",
       "12776  {'피부타입': '모든피부용', '향계열': '무향', '주요제품특징': '세정력'...  \n",
       "12777  {'최소연령': '6개월', '단계별': '3단계', '종류': '일반분유', '제...  \n",
       "\n",
       "[12778 rows x 6 columns]"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import re\n",
    "\n",
    "def improved_parse_key_value_pairs(text):\n",
    "    # Initialize an empty dictionary to hold the extracted key-value pairs\n",
    "    extracted_pairs = {}\n",
    "    \n",
    "    # Find potential key-value pairs using a regular expression\n",
    "    # The regex looks for patterns where a key is followed by \":\", and a value is any non-greedy match until the next key or end of string\n",
    "    pair_pattern = re.compile(r'([^:]+):([^:]+?)(?=\\s+[^:]+:|$)')\n",
    "    \n",
    "    # Use the regex to find all matches in the text\n",
    "    matches = pair_pattern.findall(text)\n",
    "    \n",
    "    # Process each match to populate the dictionary\n",
    "    for match in matches:\n",
    "        # Clean up the key and value by stripping whitespace\n",
    "        key = match[0].strip()\n",
    "        value = match[1].strip()\n",
    "        # Handle cases where a comma might separate multiple values for a single key\n",
    "        if ',' in value:\n",
    "            value = value.split(',')  # Split the value into a list based on commas\n",
    "            value = [v.strip() for v in value]  # Strip whitespace from each item\n",
    "        extracted_pairs[key] = value\n",
    "    \n",
    "    return extracted_pairs\n",
    "\n",
    "# Applying the improved function to your dataframe\n",
    "product_info['parsed_제품특성'] = product_info['cleaned_제품특성'].apply(improved_parse_key_value_pairs)\n",
    "\n",
    "# Display the results to verify correct parsing\n",
    "product_info"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8c8822a7",
   "metadata": {},
   "source": [
    "### 3) Topic Modeling"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "b530bb5f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>제품</th>\n",
       "      <th>제품특성</th>\n",
       "      <th>desc_length</th>\n",
       "      <th>consecutive_repeats</th>\n",
       "      <th>cleaned_제품특성</th>\n",
       "      <th>parsed_제품특성</th>\n",
       "      <th>combined_제품특성</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>B002-03509-00001</td>\n",
       "      <td>제품유형:일반식품 콜라겐 펩타이드:1000mg 종류:어류 분자량:300Da 섭취대상...</td>\n",
       "      <td>20</td>\n",
       "      <td>0</td>\n",
       "      <td>제품유형:일반식품 콜라겐 펩타이드:1000mg 종류:어류 분자량:300Da 섭취대상...</td>\n",
       "      <td>{'제품유형': '일반식품', '콜라겐 펩타이드': '1000mg', '종류': '...</td>\n",
       "      <td>일반식품 1000mg 어류 300Da 성인남녀 분말 3개월분 하루 1포 바로 1개 ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>B002-02376-00001</td>\n",
       "      <td>700mg x 28정</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>700mg x 28정</td>\n",
       "      <td>{}</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>B002-03735-00001</td>\n",
       "      <td>제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 두 번 1일 총 섭...</td>\n",
       "      <td>75</td>\n",
       "      <td>0</td>\n",
       "      <td>제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 두 번 1일 총 섭...</td>\n",
       "      <td>{'제품타입': '정', '섭취방법': '물과', '함께 섭취대상': '성인남녀',...</td>\n",
       "      <td>정 물과 성인남녀 하루 1포 14일분 체지방 셀레늄 셀레늄 1개 1개 1개 건강기능...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>B002-03735-00003</td>\n",
       "      <td>제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 섭...</td>\n",
       "      <td>15</td>\n",
       "      <td>0</td>\n",
       "      <td>제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 섭...</td>\n",
       "      <td>{'제품타입': '정', '섭취방법': '물과', '함께 섭취대상': '성인남녀',...</td>\n",
       "      <td>정 물과 성인남녀 하루 1정 1개 510mg x 60정</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>B002-02769-00001</td>\n",
       "      <td>HCA:900mg 영양소 원료명(식약처고시):비타민B1 영양소 원료명(식약처고시):...</td>\n",
       "      <td>25</td>\n",
       "      <td>0</td>\n",
       "      <td>HCA:900mg 영양소 원료명 식약처고시 :비타민B1 영양소 원료명 식약처고시 :...</td>\n",
       "      <td>{'HCA': '900mg', '영양소 원료명 식약처고시': '판토텐산', '1일 ...</td>\n",
       "      <td>900mg 판토텐산 4정 28일분 정 하루 물과 성인남녀 체지방 1개 700mg x...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12773</th>\n",
       "      <td>B002-01994-00001</td>\n",
       "      <td>형태:액상형 구성:리필 등급:1종 용도:식기 용도:과일 용도:야채 용도:조리기구 용...</td>\n",
       "      <td>10</td>\n",
       "      <td>0</td>\n",
       "      <td>형태:액상형 구성:리필 등급:1종 용도:식기 용도:과일 용도:야채 용도:조리기구 용...</td>\n",
       "      <td>{'형태': '액상형', '구성': '리필', '등급': '1종', '용도': '조...</td>\n",
       "      <td>액상형 리필 1종 조리기구 3개 500ml</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12774</th>\n",
       "      <td>B002-02600-00002</td>\n",
       "      <td>헤어타입:모든 모발용 주요제품특징:머릿결개선 세부제품특징:촉촉함(수분공급) 세부제품...</td>\n",
       "      <td>8</td>\n",
       "      <td>0</td>\n",
       "      <td>헤어타입:모든 모발용 주요제품특징:머릿결개선 세부제품특징:촉촉함 수분공급 세부제품특...</td>\n",
       "      <td>{'헤어타입': '모든', '모발용 주요제품특징': '머릿결개선', '세부제품특징'...</td>\n",
       "      <td>모든 머릿결개선 촉촉함 윤기부여 400ml 1개 400ml</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12775</th>\n",
       "      <td>B002-02372-00095</td>\n",
       "      <td>사용대상:여성용 타입:일자형 흡수량:20ml :1팩 32개</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>사용대상:여성용 타입:일자형 흡수량:20ml :1팩 32개</td>\n",
       "      <td>{'사용대상': '여성용', '타입': '일자형', '20ml': '1팩 32개'}</td>\n",
       "      <td>여성용 일자형 1팩 32개</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12776</th>\n",
       "      <td>B002-01318-00002</td>\n",
       "      <td>피부타입:모든피부용 향계열:무향 주요제품특징:촉촉함(수분공급) 주요제품특징:풍부한 ...</td>\n",
       "      <td>25</td>\n",
       "      <td>0</td>\n",
       "      <td>피부타입:모든피부용 향계열:무향 주요제품특징:촉촉함 수분공급 주요제품특징:풍부한 거...</td>\n",
       "      <td>{'피부타입': '모든피부용', '향계열': '무향', '주요제품특징': '세정력'...</td>\n",
       "      <td>모든피부용 무향 세정력 풍부한 각질케어 쿨링감 236ml 1개 236ml 뚜껑형 1...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12777</th>\n",
       "      <td>B002-02473-00064</td>\n",
       "      <td>최소연령:4개월 단계별:2단계 종류:일반분유 제품형태:분말 포장형태:캔 용량:800...</td>\n",
       "      <td>105</td>\n",
       "      <td>0</td>\n",
       "      <td>최소연령:4개월 단계별:2단계 종류:일반분유 제품형태:분말 포장형태:캔 용량:800...</td>\n",
       "      <td>{'최소연령': '6개월', '단계별': '3단계', '종류': '일반분유', '제...</td>\n",
       "      <td>6개월 3단계 일반분유 분말 캔 400g 타우린 성장기용조제식 소화촉진 6 1개 1...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>12778 rows × 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                     제품                                               제품특성  \\\n",
       "0      B002-03509-00001  제품유형:일반식품 콜라겐 펩타이드:1000mg 종류:어류 분자량:300Da 섭취대상...   \n",
       "1      B002-02376-00001                                        700mg x 28정   \n",
       "2      B002-03735-00001  제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 두 번 1일 총 섭...   \n",
       "3      B002-03735-00003  제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 섭...   \n",
       "4      B002-02769-00001  HCA:900mg 영양소 원료명(식약처고시):비타민B1 영양소 원료명(식약처고시):...   \n",
       "...                 ...                                                ...   \n",
       "12773  B002-01994-00001  형태:액상형 구성:리필 등급:1종 용도:식기 용도:과일 용도:야채 용도:조리기구 용...   \n",
       "12774  B002-02600-00002  헤어타입:모든 모발용 주요제품특징:머릿결개선 세부제품특징:촉촉함(수분공급) 세부제품...   \n",
       "12775  B002-02372-00095                   사용대상:여성용 타입:일자형 흡수량:20ml :1팩 32개   \n",
       "12776  B002-01318-00002  피부타입:모든피부용 향계열:무향 주요제품특징:촉촉함(수분공급) 주요제품특징:풍부한 ...   \n",
       "12777  B002-02473-00064  최소연령:4개월 단계별:2단계 종류:일반분유 제품형태:분말 포장형태:캔 용량:800...   \n",
       "\n",
       "       desc_length  consecutive_repeats  \\\n",
       "0               20                    0   \n",
       "1                3                    0   \n",
       "2               75                    0   \n",
       "3               15                    0   \n",
       "4               25                    0   \n",
       "...            ...                  ...   \n",
       "12773           10                    0   \n",
       "12774            8                    0   \n",
       "12775            5                    0   \n",
       "12776           25                    0   \n",
       "12777          105                    0   \n",
       "\n",
       "                                            cleaned_제품특성  \\\n",
       "0      제품유형:일반식품 콜라겐 펩타이드:1000mg 종류:어류 분자량:300Da 섭취대상...   \n",
       "1                                            700mg x 28정   \n",
       "2      제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 두 번 1일 총 섭...   \n",
       "3      제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 섭...   \n",
       "4      HCA:900mg 영양소 원료명 식약처고시 :비타민B1 영양소 원료명 식약처고시 :...   \n",
       "...                                                  ...   \n",
       "12773  형태:액상형 구성:리필 등급:1종 용도:식기 용도:과일 용도:야채 용도:조리기구 용...   \n",
       "12774  헤어타입:모든 모발용 주요제품특징:머릿결개선 세부제품특징:촉촉함 수분공급 세부제품특...   \n",
       "12775                   사용대상:여성용 타입:일자형 흡수량:20ml :1팩 32개   \n",
       "12776  피부타입:모든피부용 향계열:무향 주요제품특징:촉촉함 수분공급 주요제품특징:풍부한 거...   \n",
       "12777  최소연령:4개월 단계별:2단계 종류:일반분유 제품형태:분말 포장형태:캔 용량:800...   \n",
       "\n",
       "                                             parsed_제품특성  \\\n",
       "0      {'제품유형': '일반식품', '콜라겐 펩타이드': '1000mg', '종류': '...   \n",
       "1                                                     {}   \n",
       "2      {'제품타입': '정', '섭취방법': '물과', '함께 섭취대상': '성인남녀',...   \n",
       "3      {'제품타입': '정', '섭취방법': '물과', '함께 섭취대상': '성인남녀',...   \n",
       "4      {'HCA': '900mg', '영양소 원료명 식약처고시': '판토텐산', '1일 ...   \n",
       "...                                                  ...   \n",
       "12773  {'형태': '액상형', '구성': '리필', '등급': '1종', '용도': '조...   \n",
       "12774  {'헤어타입': '모든', '모발용 주요제품특징': '머릿결개선', '세부제품특징'...   \n",
       "12775     {'사용대상': '여성용', '타입': '일자형', '20ml': '1팩 32개'}   \n",
       "12776  {'피부타입': '모든피부용', '향계열': '무향', '주요제품특징': '세정력'...   \n",
       "12777  {'최소연령': '6개월', '단계별': '3단계', '종류': '일반분유', '제...   \n",
       "\n",
       "                                           combined_제품특성  \n",
       "0      일반식품 1000mg 어류 300Da 성인남녀 분말 3개월분 하루 1포 바로 1개 ...  \n",
       "1                                                         \n",
       "2      정 물과 성인남녀 하루 1포 14일분 체지방 셀레늄 셀레늄 1개 1개 1개 건강기능...  \n",
       "3                         정 물과 성인남녀 하루 1정 1개 510mg x 60정  \n",
       "4      900mg 판토텐산 4정 28일분 정 하루 물과 성인남녀 체지방 1개 700mg x...  \n",
       "...                                                  ...  \n",
       "12773                            액상형 리필 1종 조리기구 3개 500ml  \n",
       "12774                   모든 머릿결개선 촉촉함 윤기부여 400ml 1개 400ml  \n",
       "12775                                     여성용 일자형 1팩 32개  \n",
       "12776  모든피부용 무향 세정력 풍부한 각질케어 쿨링감 236ml 1개 236ml 뚜껑형 1...  \n",
       "12777  6개월 3단계 일반분유 분말 캔 400g 타우린 성장기용조제식 소화촉진 6 1개 1...  \n",
       "\n",
       "[12778 rows x 7 columns]"
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Combine the values of the parsed key-value pairs into a single string per product\n",
    "product_info['combined_제품특성'] = product_info['parsed_제품특성'].apply(lambda x: ' '.join(x.values()))\n",
    "product_info"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "d1c15640",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>제품</th>\n",
       "      <th>제품특성</th>\n",
       "      <th>desc_length</th>\n",
       "      <th>consecutive_repeats</th>\n",
       "      <th>cleaned_제품특성</th>\n",
       "      <th>parsed_제품특성</th>\n",
       "      <th>combined_제품특성</th>\n",
       "      <th>tokenized_제품특성</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>B002-03509-00001</td>\n",
       "      <td>제품유형:일반식품 콜라겐 펩타이드:1000mg 종류:어류 분자량:300Da 섭취대상...</td>\n",
       "      <td>20</td>\n",
       "      <td>0</td>\n",
       "      <td>제품유형:일반식품 콜라겐 펩타이드:1000mg 종류:어류 분자량:300Da 섭취대상...</td>\n",
       "      <td>{'제품유형': '일반식품', '콜라겐 펩타이드': '1000mg', '종류': '...</td>\n",
       "      <td>일반식품 1000mg 어류 300Da 성인남녀 분말 3개월분 하루 1포 바로 1개 ...</td>\n",
       "      <td>일반 식품 어류 성인 남녀 분말 개월 하루 포 바로 개 포</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>B002-02376-00001</td>\n",
       "      <td>700mg x 28정</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>700mg x 28정</td>\n",
       "      <td>{}</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>B002-03735-00001</td>\n",
       "      <td>제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 두 번 1일 총 섭...</td>\n",
       "      <td>75</td>\n",
       "      <td>0</td>\n",
       "      <td>제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 두 번 1일 총 섭...</td>\n",
       "      <td>{'제품타입': '정', '섭취방법': '물과', '함께 섭취대상': '성인남녀',...</td>\n",
       "      <td>정 물과 성인남녀 하루 1포 14일분 체지방 셀레늄 셀레늄 1개 1개 1개 건강기능...</td>\n",
       "      <td>정 물 성인 남녀 하루 포 체지방 셀레늄 셀레늄 개 개 개 건강 기능 식품 정</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>B002-03735-00003</td>\n",
       "      <td>제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 섭...</td>\n",
       "      <td>15</td>\n",
       "      <td>0</td>\n",
       "      <td>제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 섭...</td>\n",
       "      <td>{'제품타입': '정', '섭취방법': '물과', '함께 섭취대상': '성인남녀',...</td>\n",
       "      <td>정 물과 성인남녀 하루 1정 1개 510mg x 60정</td>\n",
       "      <td>정 물 성인 남녀 하루 정 개 정</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>B002-02769-00001</td>\n",
       "      <td>HCA:900mg 영양소 원료명(식약처고시):비타민B1 영양소 원료명(식약처고시):...</td>\n",
       "      <td>25</td>\n",
       "      <td>0</td>\n",
       "      <td>HCA:900mg 영양소 원료명 식약처고시 :비타민B1 영양소 원료명 식약처고시 :...</td>\n",
       "      <td>{'HCA': '900mg', '영양소 원료명 식약처고시': '판토텐산', '1일 ...</td>\n",
       "      <td>900mg 판토텐산 4정 28일분 정 하루 물과 성인남녀 체지방 1개 700mg x...</td>\n",
       "      <td>판토텐산 정 정 하루 물 성인 남녀 체지방 개 정</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12773</th>\n",
       "      <td>B002-01994-00001</td>\n",
       "      <td>형태:액상형 구성:리필 등급:1종 용도:식기 용도:과일 용도:야채 용도:조리기구 용...</td>\n",
       "      <td>10</td>\n",
       "      <td>0</td>\n",
       "      <td>형태:액상형 구성:리필 등급:1종 용도:식기 용도:과일 용도:야채 용도:조리기구 용...</td>\n",
       "      <td>{'형태': '액상형', '구성': '리필', '등급': '1종', '용도': '조...</td>\n",
       "      <td>액상형 리필 1종 조리기구 3개 500ml</td>\n",
       "      <td>액 상형 리필 종 조리기구 개</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12774</th>\n",
       "      <td>B002-02600-00002</td>\n",
       "      <td>헤어타입:모든 모발용 주요제품특징:머릿결개선 세부제품특징:촉촉함(수분공급) 세부제품...</td>\n",
       "      <td>8</td>\n",
       "      <td>0</td>\n",
       "      <td>헤어타입:모든 모발용 주요제품특징:머릿결개선 세부제품특징:촉촉함 수분공급 세부제품특...</td>\n",
       "      <td>{'헤어타입': '모든', '모발용 주요제품특징': '머릿결개선', '세부제품특징'...</td>\n",
       "      <td>모든 머릿결개선 촉촉함 윤기부여 400ml 1개 400ml</td>\n",
       "      <td>모든 머릿결 개선 윤기 부여 개</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12775</th>\n",
       "      <td>B002-02372-00095</td>\n",
       "      <td>사용대상:여성용 타입:일자형 흡수량:20ml :1팩 32개</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>사용대상:여성용 타입:일자형 흡수량:20ml :1팩 32개</td>\n",
       "      <td>{'사용대상': '여성용', '타입': '일자형', '20ml': '1팩 32개'}</td>\n",
       "      <td>여성용 일자형 1팩 32개</td>\n",
       "      <td>성용 일자 팩 개</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12776</th>\n",
       "      <td>B002-01318-00002</td>\n",
       "      <td>피부타입:모든피부용 향계열:무향 주요제품특징:촉촉함(수분공급) 주요제품특징:풍부한 ...</td>\n",
       "      <td>25</td>\n",
       "      <td>0</td>\n",
       "      <td>피부타입:모든피부용 향계열:무향 주요제품특징:촉촉함 수분공급 주요제품특징:풍부한 거...</td>\n",
       "      <td>{'피부타입': '모든피부용', '향계열': '무향', '주요제품특징': '세정력'...</td>\n",
       "      <td>모든피부용 무향 세정력 풍부한 각질케어 쿨링감 236ml 1개 236ml 뚜껑형 1...</td>\n",
       "      <td>피부 용 무향 정력 각질 케어 쿨링감 개 뚜껑 개 뚜껑</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12777</th>\n",
       "      <td>B002-02473-00064</td>\n",
       "      <td>최소연령:4개월 단계별:2단계 종류:일반분유 제품형태:분말 포장형태:캔 용량:800...</td>\n",
       "      <td>105</td>\n",
       "      <td>0</td>\n",
       "      <td>최소연령:4개월 단계별:2단계 종류:일반분유 제품형태:분말 포장형태:캔 용량:800...</td>\n",
       "      <td>{'최소연령': '6개월', '단계별': '3단계', '종류': '일반분유', '제...</td>\n",
       "      <td>6개월 3단계 일반분유 분말 캔 400g 타우린 성장기용조제식 소화촉진 6 1개 1...</td>\n",
       "      <td>개월 단계 일반 분유 분말 캔 타우린 성장 기용 조제 소화 촉진 개 개 개</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>12778 rows × 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                     제품                                               제품특성  \\\n",
       "0      B002-03509-00001  제품유형:일반식품 콜라겐 펩타이드:1000mg 종류:어류 분자량:300Da 섭취대상...   \n",
       "1      B002-02376-00001                                        700mg x 28정   \n",
       "2      B002-03735-00001  제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 두 번 1일 총 섭...   \n",
       "3      B002-03735-00003  제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 섭...   \n",
       "4      B002-02769-00001  HCA:900mg 영양소 원료명(식약처고시):비타민B1 영양소 원료명(식약처고시):...   \n",
       "...                 ...                                                ...   \n",
       "12773  B002-01994-00001  형태:액상형 구성:리필 등급:1종 용도:식기 용도:과일 용도:야채 용도:조리기구 용...   \n",
       "12774  B002-02600-00002  헤어타입:모든 모발용 주요제품특징:머릿결개선 세부제품특징:촉촉함(수분공급) 세부제품...   \n",
       "12775  B002-02372-00095                   사용대상:여성용 타입:일자형 흡수량:20ml :1팩 32개   \n",
       "12776  B002-01318-00002  피부타입:모든피부용 향계열:무향 주요제품특징:촉촉함(수분공급) 주요제품특징:풍부한 ...   \n",
       "12777  B002-02473-00064  최소연령:4개월 단계별:2단계 종류:일반분유 제품형태:분말 포장형태:캔 용량:800...   \n",
       "\n",
       "       desc_length  consecutive_repeats  \\\n",
       "0               20                    0   \n",
       "1                3                    0   \n",
       "2               75                    0   \n",
       "3               15                    0   \n",
       "4               25                    0   \n",
       "...            ...                  ...   \n",
       "12773           10                    0   \n",
       "12774            8                    0   \n",
       "12775            5                    0   \n",
       "12776           25                    0   \n",
       "12777          105                    0   \n",
       "\n",
       "                                            cleaned_제품특성  \\\n",
       "0      제품유형:일반식품 콜라겐 펩타이드:1000mg 종류:어류 분자량:300Da 섭취대상...   \n",
       "1                                            700mg x 28정   \n",
       "2      제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 두 번 1일 총 섭...   \n",
       "3      제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 섭...   \n",
       "4      HCA:900mg 영양소 원료명 식약처고시 :비타민B1 영양소 원료명 식약처고시 :...   \n",
       "...                                                  ...   \n",
       "12773  형태:액상형 구성:리필 등급:1종 용도:식기 용도:과일 용도:야채 용도:조리기구 용...   \n",
       "12774  헤어타입:모든 모발용 주요제품특징:머릿결개선 세부제품특징:촉촉함 수분공급 세부제품특...   \n",
       "12775                   사용대상:여성용 타입:일자형 흡수량:20ml :1팩 32개   \n",
       "12776  피부타입:모든피부용 향계열:무향 주요제품특징:촉촉함 수분공급 주요제품특징:풍부한 거...   \n",
       "12777  최소연령:4개월 단계별:2단계 종류:일반분유 제품형태:분말 포장형태:캔 용량:800...   \n",
       "\n",
       "                                             parsed_제품특성  \\\n",
       "0      {'제품유형': '일반식품', '콜라겐 펩타이드': '1000mg', '종류': '...   \n",
       "1                                                     {}   \n",
       "2      {'제품타입': '정', '섭취방법': '물과', '함께 섭취대상': '성인남녀',...   \n",
       "3      {'제품타입': '정', '섭취방법': '물과', '함께 섭취대상': '성인남녀',...   \n",
       "4      {'HCA': '900mg', '영양소 원료명 식약처고시': '판토텐산', '1일 ...   \n",
       "...                                                  ...   \n",
       "12773  {'형태': '액상형', '구성': '리필', '등급': '1종', '용도': '조...   \n",
       "12774  {'헤어타입': '모든', '모발용 주요제품특징': '머릿결개선', '세부제품특징'...   \n",
       "12775     {'사용대상': '여성용', '타입': '일자형', '20ml': '1팩 32개'}   \n",
       "12776  {'피부타입': '모든피부용', '향계열': '무향', '주요제품특징': '세정력'...   \n",
       "12777  {'최소연령': '6개월', '단계별': '3단계', '종류': '일반분유', '제...   \n",
       "\n",
       "                                           combined_제품특성  \\\n",
       "0      일반식품 1000mg 어류 300Da 성인남녀 분말 3개월분 하루 1포 바로 1개 ...   \n",
       "1                                                          \n",
       "2      정 물과 성인남녀 하루 1포 14일분 체지방 셀레늄 셀레늄 1개 1개 1개 건강기능...   \n",
       "3                         정 물과 성인남녀 하루 1정 1개 510mg x 60정   \n",
       "4      900mg 판토텐산 4정 28일분 정 하루 물과 성인남녀 체지방 1개 700mg x...   \n",
       "...                                                  ...   \n",
       "12773                            액상형 리필 1종 조리기구 3개 500ml   \n",
       "12774                   모든 머릿결개선 촉촉함 윤기부여 400ml 1개 400ml   \n",
       "12775                                     여성용 일자형 1팩 32개   \n",
       "12776  모든피부용 무향 세정력 풍부한 각질케어 쿨링감 236ml 1개 236ml 뚜껑형 1...   \n",
       "12777  6개월 3단계 일반분유 분말 캔 400g 타우린 성장기용조제식 소화촉진 6 1개 1...   \n",
       "\n",
       "                                    tokenized_제품특성  \n",
       "0                 일반 식품 어류 성인 남녀 분말 개월 하루 포 바로 개 포  \n",
       "1                                                   \n",
       "2      정 물 성인 남녀 하루 포 체지방 셀레늄 셀레늄 개 개 개 건강 기능 식품 정  \n",
       "3                               정 물 성인 남녀 하루 정 개 정  \n",
       "4                      판토텐산 정 정 하루 물 성인 남녀 체지방 개 정  \n",
       "...                                            ...  \n",
       "12773                             액 상형 리필 종 조리기구 개  \n",
       "12774                            모든 머릿결 개선 윤기 부여 개  \n",
       "12775                                    성용 일자 팩 개  \n",
       "12776               피부 용 무향 정력 각질 케어 쿨링감 개 뚜껑 개 뚜껑  \n",
       "12777    개월 단계 일반 분유 분말 캔 타우린 성장 기용 조제 소화 촉진 개 개 개  \n",
       "\n",
       "[12778 rows x 8 columns]"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from konlpy.tag import Okt\n",
    "okt = Okt()\n",
    "\n",
    "# Tokenize the combined product features, extracting only nouns\n",
    "product_info['tokenized_제품특성'] = product_info['combined_제품특성'].apply(lambda x: ' '.join(okt.nouns(x)))\n",
    "product_info"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "0889a1ec",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.feature_extraction.text import CountVectorizer\n",
    "\n",
    "vectorizer = CountVectorizer(max_df=0.95, min_df=2)\n",
    "dtm = vectorizer.fit_transform(product_info['tokenized_제품특성'].tolist())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "98919cac",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Topic 0:\n",
      "남녀 성인 하루 바로 식품 건강 개월 분말 날개 기능\n",
      "Topic 1:\n",
      "피부 펌프 모든 영양 공급 샴푸 자극 윤기 부여 튜브\n",
      "Topic 2:\n",
      "일반 상형 단백질 리필 분리 유청 플라스틱 기타 동물성 칫솔\n",
      "Topic 3:\n",
      "캡슐 성인 하루 개월 남녀 비타민 보충 영양 건강 기타\n",
      "Topic 4:\n",
      "엠보싱 헤드 기본 구성 단계 계정수 충전 효과 보습 인증\n"
     ]
    }
   ],
   "source": [
    "from sklearn.decomposition import LatentDirichletAllocation\n",
    "\n",
    "# Number of topics\n",
    "n_components = 5\n",
    "\n",
    "lda = LatentDirichletAllocation(n_components=n_components, random_state=0)\n",
    "lda.fit(dtm)\n",
    "\n",
    "# Display the top words in each topic\n",
    "def display_topics(model, feature_names, no_top_words):\n",
    "    for topic_idx, topic in enumerate(model.components_):\n",
    "        print(\"Topic %d:\" % (topic_idx))\n",
    "        print(\" \".join([feature_names[i] for i in topic.argsort()[:-no_top_words - 1:-1]]))\n",
    "\n",
    "no_top_words = 10\n",
    "display_topics(lda, vectorizer.get_feature_names_out(), no_top_words)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "id": "920db7a3",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Topic 0:\n",
      "헤드 칫솔 날개 기본 구성 용 세 모 각질 충전\n",
      "Topic 1:\n",
      "개 포 남녀 개월 바로 성인 하루 식품 유아 건강\n",
      "Topic 2:\n",
      "개 정 물 캡슐 성인 하루 남녀 개월 단백질 비타민\n",
      "Topic 3:\n",
      "팩 매 겹 엠보싱 롤 인증 계정수 캡 무 보습\n",
      "Topic 4:\n",
      "개 용 피부 품 일반 펌프 모든 영양 향 공급\n"
     ]
    }
   ],
   "source": [
    "from sklearn.feature_extraction.text import CountVectorizer\n",
    "from sklearn.decomposition import LatentDirichletAllocation\n",
    "\n",
    "# Assuming 'tokenized_제품특성' is a series of strings where tokens are separated by space\n",
    "texts = product_info['tokenized_제품특성'].fillna('')  # Ensure no NaN values\n",
    "\n",
    "# Vectorization - this time using the pre-tokenized text\n",
    "vectorizer = CountVectorizer(analyzer=lambda x: x.split())\n",
    "doc_term_matrix = vectorizer.fit_transform(texts)\n",
    "\n",
    "# LDA Model\n",
    "lda = LatentDirichletAllocation(n_components=5, learning_method='online', random_state=0)\n",
    "lda.fit(doc_term_matrix)\n",
    "\n",
    "# Display Topics Function\n",
    "def display_topics(model, feature_names, no_top_words):\n",
    "    for topic_idx, topic in enumerate(model.components_):\n",
    "        print(f\"Topic {topic_idx}:\")\n",
    "        print(\" \".join([feature_names[i] for i in topic.argsort()[:-no_top_words - 1:-1]]))\n",
    "\n",
    "display_topics(lda, vectorizer.get_feature_names_out(), 10)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "id": "7a6c9489",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tokenized_제품특성</th>\n",
       "      <th>tokenized_제품특성_cleaned</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>일반 식품 어류 성인 남녀 분말 개월 하루 포 바로 개 포</td>\n",
       "      <td>일반 식품 어류 성인 남녀 분말 개월 하루 바로</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>정 물 성인 남녀 하루 포 체지방 셀레늄 셀레늄 개 개 개 건강 기능 식품 정</td>\n",
       "      <td>성인 남녀 하루 체지방 셀레늄 셀레늄 건강 기능 식품</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>정 물 성인 남녀 하루 정 개 정</td>\n",
       "      <td>성인 남녀 하루</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>판토텐산 정 정 하루 물 성인 남녀 체지방 개 정</td>\n",
       "      <td>판토텐산 하루 성인 남녀 체지방</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                tokenized_제품특성         tokenized_제품특성_cleaned\n",
       "0             일반 식품 어류 성인 남녀 분말 개월 하루 포 바로 개 포     일반 식품 어류 성인 남녀 분말 개월 하루 바로\n",
       "1                                                                            \n",
       "2  정 물 성인 남녀 하루 포 체지방 셀레늄 셀레늄 개 개 개 건강 기능 식품 정  성인 남녀 하루 체지방 셀레늄 셀레늄 건강 기능 식품\n",
       "3                           정 물 성인 남녀 하루 정 개 정                       성인 남녀 하루\n",
       "4                  판토텐산 정 정 하루 물 성인 남녀 체지방 개 정              판토텐산 하루 성인 남녀 체지방"
      ]
     },
     "execution_count": 47,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Define a function to remove single-character words\n",
    "def remove_single_characters(text):\n",
    "    # Split text into tokens, filter out single-character tokens, and rejoin\n",
    "    return ' '.join([token for token in text.split() if len(token) > 1])\n",
    "\n",
    "# Apply this function to each row in the 'tokenized_제품특성' column\n",
    "product_info['tokenized_제품특성_cleaned'] = product_info['tokenized_제품특성'].apply(remove_single_characters)\n",
    "\n",
    "# Display the cleaned tokenized text\n",
    "product_info[['tokenized_제품특성', 'tokenized_제품특성_cleaned']].head()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "id": "d9c2abfe",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Topic 0:\n",
      "일반 단계 기타 헤드 칫솔 날개 기본 구성 플라스틱 제거\n",
      "Topic 1:\n",
      "캡슐 성인 하루 개월 남녀 비타민 개선 건강 분말 셀레늄\n",
      "Topic 2:\n",
      "하루 성인 유아 남녀 식품 바로 개월 건강 영양 보충\n",
      "Topic 3:\n",
      "피부 펌프 모든 영양 공급 샴푸 자극 일반 상형 윤기\n",
      "Topic 4:\n",
      "단백질 남녀 분리 공용 유청 성인 동물성 방지 오일 스푼\n"
     ]
    }
   ],
   "source": [
    "from sklearn.feature_extraction.text import CountVectorizer\n",
    "from sklearn.decomposition import LatentDirichletAllocation\n",
    "\n",
    "# Assuming 'tokenized_제품특성' is a series of strings where tokens are separated by space\n",
    "texts = product_info['tokenized_제품특성_cleaned'].fillna('')  # Ensure no NaN values\n",
    "\n",
    "# Vectorization - this time using the pre-tokenized text\n",
    "vectorizer = CountVectorizer(analyzer=lambda x: x.split())\n",
    "doc_term_matrix = vectorizer.fit_transform(texts)\n",
    "\n",
    "# LDA Model\n",
    "lda = LatentDirichletAllocation(n_components=5, learning_method='online', random_state=0)\n",
    "lda.fit(doc_term_matrix)\n",
    "\n",
    "# Display Topics Function\n",
    "def display_topics(model, feature_names, no_top_words):\n",
    "    for topic_idx, topic in enumerate(model.components_):\n",
    "        print(f\"Topic {topic_idx}:\")\n",
    "        print(\" \".join([feature_names[i] for i in topic.argsort()[:-no_top_words - 1:-1]]))\n",
    "\n",
    "display_topics(lda, vectorizer.get_feature_names_out(), 10)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "id": "110724ee",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "남녀: 3178\n",
      "성인: 3090\n",
      "하루: 2903\n",
      "일반: 2381\n",
      "개월: 2273\n",
      "캡슐: 2228\n",
      "영양: 1999\n",
      "피부: 1986\n",
      "펌프: 1807\n",
      "모든: 1716\n",
      "공급: 1314\n",
      "샴푸: 1183\n",
      "기타: 1074\n",
      "자극: 1052\n",
      "건강: 977\n",
      "상형: 926\n",
      "비타민: 868\n",
      "바로: 860\n",
      "단백질: 842\n",
      "윤기: 823\n",
      "부여: 783\n",
      "유아: 782\n",
      "튜브: 780\n",
      "단계: 766\n",
      "식품: 721\n",
      "케어: 711\n",
      "분말: 653\n",
      "개선: 621\n",
      "엠보싱: 617\n",
      "모발: 606\n",
      "흡수: 579\n",
      "두피: 578\n",
      "보충: 535\n",
      "기능: 443\n",
      "효과: 441\n",
      "해당: 439\n",
      "크림: 424\n",
      "개입: 417\n",
      "날개: 411\n",
      "인증: 409\n",
      "헤드: 407\n",
      "세트: 404\n",
      "머릿결: 400\n",
      "리필: 399\n",
      "기본: 399\n",
      "칫솔: 398\n",
      "분리: 397\n",
      "구성: 395\n",
      "파우치: 378\n",
      "플라스틱: 369\n"
     ]
    }
   ],
   "source": [
    "from collections import Counter\n",
    "\n",
    "# Combine all tokenized text into a single list\n",
    "all_tokens = ' '.join(product_info['tokenized_제품특성_cleaned']).split()\n",
    "\n",
    "# Count the frequency of each word\n",
    "word_freq = Counter(all_tokens)\n",
    "\n",
    "# Get the most common words\n",
    "most_common_words = word_freq.most_common()\n",
    "\n",
    "# Display the most common words with their frequencies\n",
    "for word, freq in most_common_words[:50]:  # Adjust the number as needed\n",
    "    print(f'{word}: {freq}')\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 142,
   "id": "2acce4ab",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "대분류             중분류             소분류           \n",
       "B002-C001-0001  B002-C002-0001  B002-C003-0001     751\n",
       "                                B002-C003-0002     663\n",
       "                                B002-C003-0003    1426\n",
       "                                B002-C003-0004     426\n",
       "                                B002-C003-0005     342\n",
       "                B002-C002-0009  B002-C003-0051     160\n",
       "B002-C001-0002  B002-C002-0002  B002-C003-0006     175\n",
       "                                B002-C003-0007     262\n",
       "                                B002-C003-0008     112\n",
       "                                B002-C003-0009     183\n",
       "                                B002-C003-0010     113\n",
       "                                B002-C003-0011     101\n",
       "                B002-C002-0003  B002-C003-0012      75\n",
       "                                B002-C003-0013     104\n",
       "                                B002-C003-0014     236\n",
       "                                B002-C003-0015     466\n",
       "                                B002-C003-0016     342\n",
       "                                B002-C003-0017     222\n",
       "                                B002-C003-0018      71\n",
       "                B002-C002-0004  B002-C003-0019     140\n",
       "                                B002-C003-0020     112\n",
       "                                B002-C003-0021     195\n",
       "                                B002-C003-0022     356\n",
       "                                B002-C003-0023     365\n",
       "                B002-C002-0005  B002-C003-0024     289\n",
       "                                B002-C003-0025     690\n",
       "                                B002-C003-0026     150\n",
       "                                B002-C003-0027     408\n",
       "                                B002-C003-0028     174\n",
       "                                B002-C003-0029     198\n",
       "                                B002-C003-0041     366\n",
       "                B002-C002-0006  B002-C003-0030     153\n",
       "                                B002-C003-0031      57\n",
       "                                B002-C003-0032     265\n",
       "                                B002-C003-0033     180\n",
       "                                B002-C003-0034    1020\n",
       "                B002-C002-0007  B002-C003-0035     641\n",
       "                                B002-C003-0036     362\n",
       "                                B002-C003-0037     184\n",
       "                                B002-C003-0038     431\n",
       "                                B002-C003-0039     432\n",
       "                                B002-C003-0040     451\n",
       "                B002-C002-0009  B002-C003-0045     294\n",
       "                                B002-C003-0046     223\n",
       "                                B002-C003-0048     162\n",
       "                                B002-C003-0049     194\n",
       "B002-C001-0003  B002-C002-0008  B002-C003-0042      59\n",
       "                                B002-C003-0043     117\n",
       "                                B002-C003-0044     234\n",
       "                B002-C002-0010  B002-C003-0050      34\n",
       "B002-C001-0004  B002-C002-0009  B002-C003-0047     111\n",
       "B002-C001-0005  B002-C002-0011  B002-C003-0052     392\n",
       "                                B002-C003-0053     221\n",
       "dtype: int64"
      ]
     },
     "execution_count": 142,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "group = train_data.groupby(['대분류', '중분류', '소분류']).size()\n",
    "group.head(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "id": "d67c82ee",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>제품</th>\n",
       "      <th>대분류</th>\n",
       "      <th>중분류</th>\n",
       "      <th>소분류</th>\n",
       "      <th>브랜드</th>\n",
       "      <th>2022-01-01</th>\n",
       "      <th>2022-01-02</th>\n",
       "      <th>2022-01-03</th>\n",
       "      <th>2022-01-04</th>\n",
       "      <th>...</th>\n",
       "      <th>2023-04-03</th>\n",
       "      <th>2023-04-04</th>\n",
       "      <th>제품특성</th>\n",
       "      <th>desc_length</th>\n",
       "      <th>consecutive_repeats</th>\n",
       "      <th>cleaned_제품특성</th>\n",
       "      <th>parsed_제품특성</th>\n",
       "      <th>combined_제품특성</th>\n",
       "      <th>tokenized_제품특성</th>\n",
       "      <th>tokenized_제품특성_cleaned</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>B002-00001-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0007</td>\n",
       "      <td>B002-C003-0038</td>\n",
       "      <td>B002-00001</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>헤어타입:모든 모발용 제품형태:스프레이형 주요제품특징:머릿결개선 주요제품특징:흡수력...</td>\n",
       "      <td>13.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>헤어타입:모든 모발용 제품형태:스프레이형 주요제품특징:머릿결개선 주요제품특징:흡수력...</td>\n",
       "      <td>{'헤어타입': '모든', '모발용 제품형태': '스프레이형', '주요제품특징': ...</td>\n",
       "      <td>모든 스프레이형 흡수력 부드러운 윤기부여 영양공급 30ml 1개 50ml</td>\n",
       "      <td>모든 스프레이 흡수 윤기 부여 영양 공급 개</td>\n",
       "      <td>모든 스프레이 흡수 윤기 부여 영양 공급</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>B002-00002-00001</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-00002</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>B002-00002-00002</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-00002</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>B002-00002-00003</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-00002</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>B002-00003-00001</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-00003</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15885</th>\n",
       "      <td>15885</td>\n",
       "      <td>B002-03799-00002</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0042</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15886</th>\n",
       "      <td>15886</td>\n",
       "      <td>B002-03799-00003</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15887</th>\n",
       "      <td>15887</td>\n",
       "      <td>B002-03799-00004</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG508S3</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG508S3</td>\n",
       "      <td>{'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...</td>\n",
       "      <td>이유식보관용기 전자레인지사용 실리콘 3개세트 LLG508S3</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 개 세트</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 세트</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15888</th>\n",
       "      <td>15888</td>\n",
       "      <td>B002-03799-00005</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG509S3</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG509S3</td>\n",
       "      <td>{'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...</td>\n",
       "      <td>이유식보관용기 전자레인지사용 실리콘 3개세트 LLG509S3</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 개 세트</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 세트</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15889</th>\n",
       "      <td>15889</td>\n",
       "      <td>B002-03799-00010</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0004</td>\n",
       "      <td>B002-C003-0020</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>15890 rows × 473 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          ID                제품             대분류             중분류  \\\n",
       "0          0  B002-00001-00001  B002-C001-0002  B002-C002-0007   \n",
       "1          1  B002-00002-00001  B002-C001-0003  B002-C002-0008   \n",
       "2          2  B002-00002-00002  B002-C001-0003  B002-C002-0008   \n",
       "3          3  B002-00002-00003  B002-C001-0003  B002-C002-0008   \n",
       "4          4  B002-00003-00001  B002-C001-0001  B002-C002-0001   \n",
       "...      ...               ...             ...             ...   \n",
       "15885  15885  B002-03799-00002  B002-C001-0003  B002-C002-0008   \n",
       "15886  15886  B002-03799-00003  B002-C001-0003  B002-C002-0008   \n",
       "15887  15887  B002-03799-00004  B002-C001-0003  B002-C002-0008   \n",
       "15888  15888  B002-03799-00005  B002-C001-0003  B002-C002-0008   \n",
       "15889  15889  B002-03799-00010  B002-C001-0002  B002-C002-0004   \n",
       "\n",
       "                  소분류         브랜드  2022-01-01  2022-01-02  2022-01-03  \\\n",
       "0      B002-C003-0038  B002-00001           0           0           0   \n",
       "1      B002-C003-0044  B002-00002           0           0           0   \n",
       "2      B002-C003-0044  B002-00002           0           0           0   \n",
       "3      B002-C003-0044  B002-00002           0           0           0   \n",
       "4      B002-C003-0003  B002-00003           0           0           0   \n",
       "...               ...         ...         ...         ...         ...   \n",
       "15885  B002-C003-0042  B002-03799           0           0           0   \n",
       "15886  B002-C003-0044  B002-03799           0           0           0   \n",
       "15887  B002-C003-0044  B002-03799           0           0           0   \n",
       "15888  B002-C003-0044  B002-03799           0           0           0   \n",
       "15889  B002-C003-0020  B002-03799           0           0           0   \n",
       "\n",
       "       2022-01-04  ...  2023-04-03  2023-04-04  \\\n",
       "0               0  ...           0           0   \n",
       "1               0  ...           2           0   \n",
       "2               0  ...           0           0   \n",
       "3               0  ...           0           0   \n",
       "4               0  ...           0           0   \n",
       "...           ...  ...         ...         ...   \n",
       "15885           0  ...           0           0   \n",
       "15886           0  ...           1           3   \n",
       "15887           0  ...           0           0   \n",
       "15888           0  ...           0           2   \n",
       "15889           0  ...           0           0   \n",
       "\n",
       "                                                    제품특성  desc_length  \\\n",
       "0      헤어타입:모든 모발용 제품형태:스프레이형 주요제품특징:머릿결개선 주요제품특징:흡수력...         13.0   \n",
       "1                                                    NaN          NaN   \n",
       "2                                                    NaN          NaN   \n",
       "3                                                    NaN          NaN   \n",
       "4                                                    NaN          NaN   \n",
       "...                                                  ...          ...   \n",
       "15885                                                NaN          NaN   \n",
       "15886                                                NaN          NaN   \n",
       "15887         종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG508S3          5.0   \n",
       "15888         종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG509S3          5.0   \n",
       "15889                                                NaN          NaN   \n",
       "\n",
       "       consecutive_repeats                                       cleaned_제품특성  \\\n",
       "0                      0.0  헤어타입:모든 모발용 제품형태:스프레이형 주요제품특징:머릿결개선 주요제품특징:흡수력...   \n",
       "1                      NaN                                                NaN   \n",
       "2                      NaN                                                NaN   \n",
       "3                      NaN                                                NaN   \n",
       "4                      NaN                                                NaN   \n",
       "...                    ...                                                ...   \n",
       "15885                  NaN                                                NaN   \n",
       "15886                  NaN                                                NaN   \n",
       "15887                  0.0         종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG508S3   \n",
       "15888                  0.0         종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG509S3   \n",
       "15889                  NaN                                                NaN   \n",
       "\n",
       "                                             parsed_제품특성  \\\n",
       "0      {'헤어타입': '모든', '모발용 제품형태': '스프레이형', '주요제품특징': ...   \n",
       "1                                                    NaN   \n",
       "2                                                    NaN   \n",
       "3                                                    NaN   \n",
       "4                                                    NaN   \n",
       "...                                                  ...   \n",
       "15885                                                NaN   \n",
       "15886                                                NaN   \n",
       "15887  {'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...   \n",
       "15888  {'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...   \n",
       "15889                                                NaN   \n",
       "\n",
       "                                  combined_제품특성               tokenized_제품특성  \\\n",
       "0      모든 스프레이형 흡수력 부드러운 윤기부여 영양공급 30ml 1개 50ml     모든 스프레이 흡수 윤기 부여 영양 공급 개   \n",
       "1                                           NaN                          NaN   \n",
       "2                                           NaN                          NaN   \n",
       "3                                           NaN                          NaN   \n",
       "4                                           NaN                          NaN   \n",
       "...                                         ...                          ...   \n",
       "15885                                       NaN                          NaN   \n",
       "15886                                       NaN                          NaN   \n",
       "15887         이유식보관용기 전자레인지사용 실리콘 3개세트 LLG508S3  이유식 보관 용기 전자레인지 사용 실리콘 개 세트   \n",
       "15888         이유식보관용기 전자레인지사용 실리콘 3개세트 LLG509S3  이유식 보관 용기 전자레인지 사용 실리콘 개 세트   \n",
       "15889                                       NaN                          NaN   \n",
       "\n",
       "          tokenized_제품특성_cleaned  \n",
       "0         모든 스프레이 흡수 윤기 부여 영양 공급  \n",
       "1                            NaN  \n",
       "2                            NaN  \n",
       "3                            NaN  \n",
       "4                            NaN  \n",
       "...                          ...  \n",
       "15885                        NaN  \n",
       "15886                        NaN  \n",
       "15887  이유식 보관 용기 전자레인지 사용 실리콘 세트  \n",
       "15888  이유식 보관 용기 전자레인지 사용 실리콘 세트  \n",
       "15889                        NaN  \n",
       "\n",
       "[15890 rows x 473 columns]"
      ]
     },
     "execution_count": 54,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merged_data = pd.merge(train_data, product_info, how='left', on='제품')\n",
    "merged_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "id": "2135e6dd",
   "metadata": {},
   "outputs": [],
   "source": [
    "merged_data_nonan = merged_data.dropna(subset=[\"제품특성\"])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "id": "d93158da",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Original DataFrame shape: (15890, 473)\n",
      "New DataFrame without NaN in '제품특성': (10481, 473)\n"
     ]
    }
   ],
   "source": [
    "print(\"Original DataFrame shape:\", merged_data.shape)\n",
    "print(\"New DataFrame without NaN in '제품특성':\", merged_data_nonan.shape)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "id": "30583617",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>제품</th>\n",
       "      <th>대분류</th>\n",
       "      <th>중분류</th>\n",
       "      <th>소분류</th>\n",
       "      <th>브랜드</th>\n",
       "      <th>2022-01-01</th>\n",
       "      <th>2022-01-02</th>\n",
       "      <th>2022-01-03</th>\n",
       "      <th>2022-01-04</th>\n",
       "      <th>...</th>\n",
       "      <th>2023-04-03</th>\n",
       "      <th>2023-04-04</th>\n",
       "      <th>제품특성</th>\n",
       "      <th>desc_length</th>\n",
       "      <th>consecutive_repeats</th>\n",
       "      <th>cleaned_제품특성</th>\n",
       "      <th>parsed_제품특성</th>\n",
       "      <th>combined_제품특성</th>\n",
       "      <th>tokenized_제품특성</th>\n",
       "      <th>tokenized_제품특성_cleaned</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>B002-00001-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0007</td>\n",
       "      <td>B002-C003-0038</td>\n",
       "      <td>B002-00001</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>헤어타입:모든 모발용 제품형태:스프레이형 주요제품특징:머릿결개선 주요제품특징:흡수력...</td>\n",
       "      <td>13.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>헤어타입:모든 모발용 제품형태:스프레이형 주요제품특징:머릿결개선 주요제품특징:흡수력...</td>\n",
       "      <td>{'헤어타입': '모든', '모발용 제품형태': '스프레이형', '주요제품특징': ...</td>\n",
       "      <td>모든 스프레이형 흡수력 부드러운 윤기부여 영양공급 30ml 1개 50ml</td>\n",
       "      <td>모든 스프레이 흡수 윤기 부여 영양 공급 개</td>\n",
       "      <td>모든 스프레이 흡수 윤기 부여 영양 공급</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>12</td>\n",
       "      <td>B002-00003-00009</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-00003</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>생균:100억 CFU 1일 총 섭취량:1캡슐 제품용량:1개월분 제품타입:캡슐 섭취횟...</td>\n",
       "      <td>19.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>생균:100억 CFU 1일 총 섭취량:1캡슐 제품용량:1개월분 제품타입:캡슐 섭취횟...</td>\n",
       "      <td>{'생균': '100억', 'CFU 1일 총 섭취량': '1캡슐', '제품용량': ...</td>\n",
       "      <td>100억 1캡슐 1개월분 캡슐 하루 물과 성인남녀 체지방 감소 480mg x 30캡슐</td>\n",
       "      <td>캡슐 개월 캡슐 하루 물 성인 남녀 체지방 감소 캡슐</td>\n",
       "      <td>캡슐 개월 캡슐 하루 성인 남녀 체지방 감소 캡슐</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>16</td>\n",
       "      <td>B002-00005-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>피부타입:모든피부용 향계열:과일향 주요제품특징:향 주요제품특징:촉촉함(수분공급) 용...</td>\n",
       "      <td>8.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>피부타입:모든피부용 향계열:과일향 주요제품특징:향 주요제품특징:촉촉함 수분공급 용기...</td>\n",
       "      <td>{'피부타입': '모든피부용', '향계열': '과일향', '주요제품특징': '촉촉함...</td>\n",
       "      <td>모든피부용 과일향 촉촉함 펌프형 500ml 1개 500ml</td>\n",
       "      <td>피부 용 과일 향 펌프 개</td>\n",
       "      <td>피부 과일 펌프</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>17</td>\n",
       "      <td>B002-00005-00002</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>향계열:과일향 주요제품특징:향 용기형태:펌프형 :1개 500ml</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>향계열:과일향 주요제품특징:향 용기형태:펌프형 :1개 500ml</td>\n",
       "      <td>{'향계열': '과일향', '주요제품특징': '향', '펌프형': '1개 500ml'}</td>\n",
       "      <td>과일향 향 1개 500ml</td>\n",
       "      <td>과일 향 향 개</td>\n",
       "      <td>과일</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>19</td>\n",
       "      <td>B002-00005-00004</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>형태:펌프형 용량:575ml :1개, 형태:펌프형 용량:520ml :1개, 형태:튜...</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>형태:펌프형 용량:575ml :1개 형태:펌프형 용량:520ml :1개 형태:튜브형...</td>\n",
       "      <td>{'형태': '튜브형', '575ml': '1개', '520ml': '1개', '6...</td>\n",
       "      <td>튜브형 1개 1개 1개 575ml</td>\n",
       "      <td>튜브 개 개 개</td>\n",
       "      <td>튜브</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15877</th>\n",
       "      <td>15877</td>\n",
       "      <td>B002-03798-00049</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>재질:실리콘 재질:기타</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>재질:실리콘 재질:기타</td>\n",
       "      <td>{'재질': '기타'}</td>\n",
       "      <td>기타</td>\n",
       "      <td>기타</td>\n",
       "      <td>기타</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15882</th>\n",
       "      <td>15882</td>\n",
       "      <td>B002-03798-00054</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>형태:빨대형 용량:300ml 특징:양손잡이 특징:보온보냉 특징:샘방지/흘림방지 재질...</td>\n",
       "      <td>28.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>형태:빨대형 용량:300ml 특징:양손잡이 특징:보온보냉 특징:샘방지 흘림방지 재질...</td>\n",
       "      <td>{'형태': '빨대형', '용량': '300ml', '특징': '양손잡이', '흘림...</td>\n",
       "      <td>빨대형 300ml 양손잡이 PE 스테인리스스틸</td>\n",
       "      <td>빨대 양손잡이 스테인리스 스틸</td>\n",
       "      <td>빨대 양손잡이 스테인리스 스틸</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15883</th>\n",
       "      <td>15883</td>\n",
       "      <td>B002-03798-00055</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>형태:머그형 용량:240ml 특징:양손잡이 특징:미끄럼방지 특징:비스페놀A(BPA)...</td>\n",
       "      <td>21.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>형태:머그형 용량:240ml 특징:양손잡이 특징:미끄럼방지 특징:비스페놀A BPA ...</td>\n",
       "      <td>{'형태': '머그형', '용량': '240ml', '특징': '미끄럼방지', 'B...</td>\n",
       "      <td>머그형 240ml 미끄럼방지 ABS 스테인리스스틸</td>\n",
       "      <td>머그 미끄럼 방지 스테인리스 스틸</td>\n",
       "      <td>머그 미끄럼 방지 스테인리스 스틸</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15887</th>\n",
       "      <td>15887</td>\n",
       "      <td>B002-03799-00004</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG508S3</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG508S3</td>\n",
       "      <td>{'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...</td>\n",
       "      <td>이유식보관용기 전자레인지사용 실리콘 3개세트 LLG508S3</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 개 세트</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 세트</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15888</th>\n",
       "      <td>15888</td>\n",
       "      <td>B002-03799-00005</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG509S3</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG509S3</td>\n",
       "      <td>{'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...</td>\n",
       "      <td>이유식보관용기 전자레인지사용 실리콘 3개세트 LLG509S3</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 개 세트</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 세트</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10481 rows × 473 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          ID                제품             대분류             중분류  \\\n",
       "0          0  B002-00001-00001  B002-C001-0002  B002-C002-0007   \n",
       "12        12  B002-00003-00009  B002-C001-0001  B002-C002-0001   \n",
       "16        16  B002-00005-00001  B002-C001-0002  B002-C002-0006   \n",
       "17        17  B002-00005-00002  B002-C001-0002  B002-C002-0006   \n",
       "19        19  B002-00005-00004  B002-C001-0002  B002-C002-0006   \n",
       "...      ...               ...             ...             ...   \n",
       "15877  15877  B002-03798-00049  B002-C001-0003  B002-C002-0008   \n",
       "15882  15882  B002-03798-00054  B002-C001-0003  B002-C002-0008   \n",
       "15883  15883  B002-03798-00055  B002-C001-0003  B002-C002-0008   \n",
       "15887  15887  B002-03799-00004  B002-C001-0003  B002-C002-0008   \n",
       "15888  15888  B002-03799-00005  B002-C001-0003  B002-C002-0008   \n",
       "\n",
       "                  소분류         브랜드  2022-01-01  2022-01-02  2022-01-03  \\\n",
       "0      B002-C003-0038  B002-00001           0           0           0   \n",
       "12     B002-C003-0003  B002-00003           0           0           0   \n",
       "16     B002-C003-0032  B002-00005           0           0           0   \n",
       "17     B002-C003-0032  B002-00005           0           0           0   \n",
       "19     B002-C003-0032  B002-00005           0           0           0   \n",
       "...               ...         ...         ...         ...         ...   \n",
       "15877  B002-C003-0044  B002-03798           0           0           0   \n",
       "15882  B002-C003-0044  B002-03798           0           0           0   \n",
       "15883  B002-C003-0044  B002-03798           0           0           0   \n",
       "15887  B002-C003-0044  B002-03799           0           0           0   \n",
       "15888  B002-C003-0044  B002-03799           0           0           0   \n",
       "\n",
       "       2022-01-04  ...  2023-04-03  2023-04-04  \\\n",
       "0               0  ...           0           0   \n",
       "12              0  ...           0           0   \n",
       "16              0  ...           0           0   \n",
       "17              0  ...           0           0   \n",
       "19              0  ...           0           0   \n",
       "...           ...  ...         ...         ...   \n",
       "15877           0  ...           0           1   \n",
       "15882           0  ...           1           0   \n",
       "15883           0  ...           2           0   \n",
       "15887           0  ...           0           0   \n",
       "15888           0  ...           0           2   \n",
       "\n",
       "                                                    제품특성  desc_length  \\\n",
       "0      헤어타입:모든 모발용 제품형태:스프레이형 주요제품특징:머릿결개선 주요제품특징:흡수력...         13.0   \n",
       "12     생균:100억 CFU 1일 총 섭취량:1캡슐 제품용량:1개월분 제품타입:캡슐 섭취횟...         19.0   \n",
       "16     피부타입:모든피부용 향계열:과일향 주요제품특징:향 주요제품특징:촉촉함(수분공급) 용...          8.0   \n",
       "17                   향계열:과일향 주요제품특징:향 용기형태:펌프형 :1개 500ml          5.0   \n",
       "19     형태:펌프형 용량:575ml :1개, 형태:펌프형 용량:520ml :1개, 형태:튜...         10.0   \n",
       "...                                                  ...          ...   \n",
       "15877                                      재질:실리콘 재질:기타           2.0   \n",
       "15882  형태:빨대형 용량:300ml 특징:양손잡이 특징:보온보냉 특징:샘방지/흘림방지 재질...         28.0   \n",
       "15883  형태:머그형 용량:240ml 특징:양손잡이 특징:미끄럼방지 특징:비스페놀A(BPA)...         21.0   \n",
       "15887         종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG508S3          5.0   \n",
       "15888         종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG509S3          5.0   \n",
       "\n",
       "       consecutive_repeats                                       cleaned_제품특성  \\\n",
       "0                      0.0  헤어타입:모든 모발용 제품형태:스프레이형 주요제품특징:머릿결개선 주요제품특징:흡수력...   \n",
       "12                     0.0  생균:100억 CFU 1일 총 섭취량:1캡슐 제품용량:1개월분 제품타입:캡슐 섭취횟...   \n",
       "16                     0.0  피부타입:모든피부용 향계열:과일향 주요제품특징:향 주요제품특징:촉촉함 수분공급 용기...   \n",
       "17                     0.0                향계열:과일향 주요제품특징:향 용기형태:펌프형 :1개 500ml   \n",
       "19                     0.0  형태:펌프형 용량:575ml :1개 형태:펌프형 용량:520ml :1개 형태:튜브형...   \n",
       "...                    ...                                                ...   \n",
       "15877                  0.0                                       재질:실리콘 재질:기타   \n",
       "15882                  0.0  형태:빨대형 용량:300ml 특징:양손잡이 특징:보온보냉 특징:샘방지 흘림방지 재질...   \n",
       "15883                  0.0  형태:머그형 용량:240ml 특징:양손잡이 특징:미끄럼방지 특징:비스페놀A BPA ...   \n",
       "15887                  0.0         종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG508S3   \n",
       "15888                  0.0         종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG509S3   \n",
       "\n",
       "                                             parsed_제품특성  \\\n",
       "0      {'헤어타입': '모든', '모발용 제품형태': '스프레이형', '주요제품특징': ...   \n",
       "12     {'생균': '100억', 'CFU 1일 총 섭취량': '1캡슐', '제품용량': ...   \n",
       "16     {'피부타입': '모든피부용', '향계열': '과일향', '주요제품특징': '촉촉함...   \n",
       "17      {'향계열': '과일향', '주요제품특징': '향', '펌프형': '1개 500ml'}   \n",
       "19     {'형태': '튜브형', '575ml': '1개', '520ml': '1개', '6...   \n",
       "...                                                  ...   \n",
       "15877                                       {'재질': '기타'}   \n",
       "15882  {'형태': '빨대형', '용량': '300ml', '특징': '양손잡이', '흘림...   \n",
       "15883  {'형태': '머그형', '용량': '240ml', '특징': '미끄럼방지', 'B...   \n",
       "15887  {'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...   \n",
       "15888  {'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...   \n",
       "\n",
       "                                         combined_제품특성  \\\n",
       "0             모든 스프레이형 흡수력 부드러운 윤기부여 영양공급 30ml 1개 50ml   \n",
       "12     100억 1캡슐 1개월분 캡슐 하루 물과 성인남녀 체지방 감소 480mg x 30캡슐   \n",
       "16                    모든피부용 과일향 촉촉함 펌프형 500ml 1개 500ml   \n",
       "17                                      과일향 향 1개 500ml   \n",
       "19                                  튜브형 1개 1개 1개 575ml   \n",
       "...                                                ...   \n",
       "15877                                               기타   \n",
       "15882                        빨대형 300ml 양손잡이 PE 스테인리스스틸   \n",
       "15883                      머그형 240ml 미끄럼방지 ABS 스테인리스스틸   \n",
       "15887                이유식보관용기 전자레인지사용 실리콘 3개세트 LLG508S3   \n",
       "15888                이유식보관용기 전자레인지사용 실리콘 3개세트 LLG509S3   \n",
       "\n",
       "                      tokenized_제품특성       tokenized_제품특성_cleaned  \n",
       "0           모든 스프레이 흡수 윤기 부여 영양 공급 개       모든 스프레이 흡수 윤기 부여 영양 공급  \n",
       "12     캡슐 개월 캡슐 하루 물 성인 남녀 체지방 감소 캡슐  캡슐 개월 캡슐 하루 성인 남녀 체지방 감소 캡슐  \n",
       "16                    피부 용 과일 향 펌프 개                     피부 과일 펌프  \n",
       "17                          과일 향 향 개                           과일  \n",
       "19                          튜브 개 개 개                           튜브  \n",
       "...                              ...                          ...  \n",
       "15877                             기타                           기타  \n",
       "15882               빨대 양손잡이 스테인리스 스틸             빨대 양손잡이 스테인리스 스틸  \n",
       "15883             머그 미끄럼 방지 스테인리스 스틸           머그 미끄럼 방지 스테인리스 스틸  \n",
       "15887    이유식 보관 용기 전자레인지 사용 실리콘 개 세트    이유식 보관 용기 전자레인지 사용 실리콘 세트  \n",
       "15888    이유식 보관 용기 전자레인지 사용 실리콘 개 세트    이유식 보관 용기 전자레인지 사용 실리콘 세트  \n",
       "\n",
       "[10481 rows x 473 columns]"
      ]
     },
     "execution_count": 57,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merged_data_nonan"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "id": "affd633b",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>제품</th>\n",
       "      <th>대분류</th>\n",
       "      <th>중분류</th>\n",
       "      <th>소분류</th>\n",
       "      <th>브랜드</th>\n",
       "      <th>2022-01-01</th>\n",
       "      <th>2022-01-02</th>\n",
       "      <th>2022-01-03</th>\n",
       "      <th>2022-01-04</th>\n",
       "      <th>...</th>\n",
       "      <th>2023-04-03</th>\n",
       "      <th>2023-04-04</th>\n",
       "      <th>제품특성</th>\n",
       "      <th>desc_length</th>\n",
       "      <th>consecutive_repeats</th>\n",
       "      <th>cleaned_제품특성</th>\n",
       "      <th>parsed_제품특성</th>\n",
       "      <th>combined_제품특성</th>\n",
       "      <th>tokenized_제품특성</th>\n",
       "      <th>tokenized_제품특성_cleaned</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>11376</th>\n",
       "      <td>11376</td>\n",
       "      <td>B002-02643-00001</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0001</td>\n",
       "      <td>B002-02643</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>11</td>\n",
       "      <td>0</td>\n",
       "      <td>HCA:750mg 영양소 원료명(식약처고시):해당 없음 1일 총 섭취량:2포 제품용...</td>\n",
       "      <td>56.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>HCA:750mg 영양소 원료명 식약처고시 :해당 없음 1일 총 섭취량:2포 제품용...</td>\n",
       "      <td>{'HCA': '750mg', '영양소 원료명 식약처고시': '비타민B1', '없음...</td>\n",
       "      <td>750mg 비타민B1 1포 15일분 분말 하루 물에 성인남녀 체지방 감소 3 5g ...</td>\n",
       "      <td>비타민 포 분말 하루 물 성인 남녀 체지방 감소 포 물 포</td>\n",
       "      <td>비타민 분말 하루 성인 남녀 체지방 감소</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4955</th>\n",
       "      <td>4955</td>\n",
       "      <td>B002-01188-00009</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-01188</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>생균:20억 CFU 1일 총 섭취량:1캡슐 제품용량:1개월분 제품타입:캡슐 섭취횟수...</td>\n",
       "      <td>19.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>생균:20억 CFU 1일 총 섭취량:1캡슐 제품용량:1개월분 제품타입:캡슐 섭취횟수...</td>\n",
       "      <td>{'생균': '20억', 'CFU 1일 총 섭취량': '1캡슐', '제품용량': '...</td>\n",
       "      <td>20억 1캡슐 1개월분 캡슐 하루 물과 성인여성 1개 180mg x 30캡슐</td>\n",
       "      <td>캡슐 개월 캡슐 하루 물 성인 여성 개 캡슐</td>\n",
       "      <td>캡슐 개월 캡슐 하루 성인 여성 캡슐</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4954</th>\n",
       "      <td>4954</td>\n",
       "      <td>B002-01188-00008</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0002</td>\n",
       "      <td>B002-01188</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1일 총 섭취량:1캡슐 제품타입:캡슐 섭취횟수:하루 한 번 섭취방법:물과 함께 주요...</td>\n",
       "      <td>16.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1일 총 섭취량:1캡슐 제품타입:캡슐 섭취횟수:하루 한 번 섭취방법:물과 함께 주요...</td>\n",
       "      <td>{'1일 총 섭취량': '1캡슐', '제품타입': '캡슐', '섭취횟수': '하루'...</td>\n",
       "      <td>1캡슐 캡슐 하루 물과 영양보충 1개 1000IU 100캡슐</td>\n",
       "      <td>캡슐 캡슐 하루 물 영양 보충 개 캡슐</td>\n",
       "      <td>캡슐 캡슐 하루 영양 보충 캡슐</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4953</th>\n",
       "      <td>4953</td>\n",
       "      <td>B002-01188-00007</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-01188</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>생균:10억 CFU 1일 총 섭취량:1포 제품용량:2개월분 제품타입:분말 섭취횟수:...</td>\n",
       "      <td>18.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>생균:10억 CFU 1일 총 섭취량:1포 제품용량:2개월분 제품타입:분말 섭취횟수:...</td>\n",
       "      <td>{'생균': '10억', 'CFU 1일 총 섭취량': '1포', '제품용량': '2...</td>\n",
       "      <td>10억 1포 2개월분 분말 하루 물에 유아 장건강 1 9g x 60개입</td>\n",
       "      <td>포 개월 분말 하루 물 유아 장 건강 개입</td>\n",
       "      <td>개월 분말 하루 유아 건강 개입</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4952</th>\n",
       "      <td>4952</td>\n",
       "      <td>B002-01188-00006</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-01188</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>아연:10mg 영양소 원료명(식약처고시):아연 섭취대상:유아/청소년 제품용량:1개월...</td>\n",
       "      <td>15.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>아연:10mg 영양소 원료명 식약처고시 :아연 섭취대상:유아 청소년 제품용량:1개월...</td>\n",
       "      <td>{'아연': '10mg', '영양소 원료명 식약처고시': '아연', '섭취대상': ...</td>\n",
       "      <td>10mg 아연 유아 1개월분 액상 하루 물에 1개 120ml</td>\n",
       "      <td>아연 유아 개월 액 하루 물 개</td>\n",
       "      <td>아연 유아 개월 하루</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4951</th>\n",
       "      <td>4951</td>\n",
       "      <td>B002-01188-00005</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-01188</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>생균:1억 CFU 제품용량:1개월분 제품타입:액상 섭취횟수:하루 한 번 섭취대상:유...</td>\n",
       "      <td>11.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>생균:1억 CFU 제품용량:1개월분 제품타입:액상 섭취횟수:하루 한 번 섭취대상:유...</td>\n",
       "      <td>{'생균': '1억', 'CFU 제품용량': '1개월분', '제품타입': '액상',...</td>\n",
       "      <td>1억 1개월분 액상 하루 유아 장건강 8ml</td>\n",
       "      <td>개월 액 하루 유아 장 건강</td>\n",
       "      <td>개월 하루 유아 건강</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7353</th>\n",
       "      <td>7353</td>\n",
       "      <td>B002-01804-00001</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-01804</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>영양소 원료명(식약처고시)DHA+EPA제품타입섭취대상제품용량1일 총 섭취량섭취횟수섭...</td>\n",
       "      <td>259.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>영양소 원료명 식약처고시 DHA EPA제품타입섭취대상제품용량1일 총 섭취량섭취횟수섭...</td>\n",
       "      <td>{'영양소 원료명 식약처고시 DHA EPA제품타입섭취대상제품용량1일 총 섭취량섭취횟...</td>\n",
       "      <td>비타민E 혈행개선 혈행개선 비타민E 600mg 동물성 캡슐 성인남녀 6개월분 1캡슐...</td>\n",
       "      <td>비타민 혈행 개선 혈행 개선 비타민 동물성 캡슐 성인 남녀 개월 캡슐 하루 물 개 ...</td>\n",
       "      <td>비타민 혈행 개선 혈행 개선 비타민 동물성 캡슐 성인 남녀 개월 캡슐 하루 플러스 ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7351</th>\n",
       "      <td>7351</td>\n",
       "      <td>B002-01802-00002</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-01802</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>제품타입:분말 섭취방법:바로 음용 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 ...</td>\n",
       "      <td>18.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>제품타입:분말 섭취방법:바로 음용 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 ...</td>\n",
       "      <td>{'제품타입': '분말', '섭취방법': '바로', '음용 섭취대상': '성인남녀'...</td>\n",
       "      <td>분말 바로 성인남녀 하루 1포 1개월분 비타민C 3g x 30포</td>\n",
       "      <td>분말 바로 성인 남녀 하루 포 개월 비타민 포</td>\n",
       "      <td>분말 바로 성인 남녀 하루 개월 비타민</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7350</th>\n",
       "      <td>7350</td>\n",
       "      <td>B002-01802-00001</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-01802</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>제품타입:분말 섭취방법:물에 섞어서 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총...</td>\n",
       "      <td>16.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>제품타입:분말 섭취방법:물에 섞어서 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총...</td>\n",
       "      <td>{'제품타입': '분말', '섭취방법': '물에', '섞어서 섭취대상': '성인남녀...</td>\n",
       "      <td>분말 물에 성인남녀 하루 1포 1개월분 1개 3g x 30포</td>\n",
       "      <td>분말 물 성인 남녀 하루 포 개월 개 포</td>\n",
       "      <td>분말 성인 남녀 하루 개월</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7349</th>\n",
       "      <td>7349</td>\n",
       "      <td>B002-01801-00001</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0001</td>\n",
       "      <td>B002-01801</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>제품유형:일반식품 섭취대상:성인남녀 제품타입:분말 :1개 102g</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>제품유형:일반식품 섭취대상:성인남녀 제품타입:분말 :1개 102g</td>\n",
       "      <td>{'제품유형': '일반식품', '섭취대상': '성인남녀', '분말': '1개 102g'}</td>\n",
       "      <td>일반식품 성인남녀 1개 102g</td>\n",
       "      <td>일반 식품 성인 남녀 개</td>\n",
       "      <td>일반 식품 성인 남녀</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4950</th>\n",
       "      <td>4950</td>\n",
       "      <td>B002-01188-00004</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-01188</td>\n",
       "      <td>64</td>\n",
       "      <td>56</td>\n",
       "      <td>50</td>\n",
       "      <td>52</td>\n",
       "      <td>...</td>\n",
       "      <td>81</td>\n",
       "      <td>139</td>\n",
       "      <td>생균:1억 CFU 1일 총 섭취량:6방울 제품용량:1개월분 제품타입:액상 섭취횟수:...</td>\n",
       "      <td>19.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>생균:1억 CFU 1일 총 섭취량:6방울 제품용량:1개월분 제품타입:액상 섭취횟수:...</td>\n",
       "      <td>{'생균': '1억', 'CFU 1일 총 섭취량': '6방울', '제품용량': '1...</td>\n",
       "      <td>1억 6방울 1개월분 액상 하루 바로 유아 장건강 1개 8ml</td>\n",
       "      <td>방울 개월 액 하루 바로 유아 장 건강 개</td>\n",
       "      <td>방울 개월 하루 바로 유아 건강</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4949</th>\n",
       "      <td>4949</td>\n",
       "      <td>B002-01188-00003</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0002</td>\n",
       "      <td>B002-01188</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>주요 기능성(식약처인증):영양보충 영양소 원료명(식약처고시):비타민D 영양소 원료명...</td>\n",
       "      <td>121.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>주요 기능성 식약처인증 :영양보충 영양소 원료명 식약처고시 :비타민D 영양소 원료명...</td>\n",
       "      <td>{'주요 기능성 식약처인증': '영양보충', '영양소 원료명 식약처고시': '망간'...</td>\n",
       "      <td>영양보충 망간 요오드 15개 110mg 15 15mg 임산부 캡슐 2개월분 2캡슐 ...</td>\n",
       "      <td>영양 보충 망간 요오드 개 임산부 캡슐 개월 캡슐 하루 물 개 정</td>\n",
       "      <td>영양 보충 망간 요오드 임산부 캡슐 개월 캡슐 하루</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4948</th>\n",
       "      <td>4948</td>\n",
       "      <td>B002-01188-00002</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0002</td>\n",
       "      <td>B002-01188</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>주요 기능성(식약처인증):영양보충 영양소 원료명(식약처고시):비타민A 영양소 원료명...</td>\n",
       "      <td>53.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>주요 기능성 식약처인증 :영양보충 영양소 원료명 식약처고시 :비타민A 영양소 원료명...</td>\n",
       "      <td>{'주요 기능성 식약처인증': '영양보충', '영양소 원료명 식약처고시': '망간'...</td>\n",
       "      <td>영양보충 망간 8개 227 151mg 10 3mg 유아 츄어블 50일분 2정 하루 ...</td>\n",
       "      <td>영양 보충 망간 개 유아 츄어블 정 하루 개 정</td>\n",
       "      <td>영양 보충 망간 유아 츄어블 하루</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4947</th>\n",
       "      <td>4947</td>\n",
       "      <td>B002-01188-00001</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0002</td>\n",
       "      <td>B002-01188</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>14</td>\n",
       "      <td>4</td>\n",
       "      <td>비타민D:10µg 섭취대상:유아/청소년 1일 총 섭취량:1방울 제품용량:개인별 다름...</td>\n",
       "      <td>29.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>비타민D:10 g 섭취대상:유아 청소년 1일 총 섭취량:1방울 제품용량:개인별 다름...</td>\n",
       "      <td>{'비타민D': '1개 400IU 6ml', 'g 섭취대상': '유아', '청소년 ...</td>\n",
       "      <td>1개 400IU 6ml 유아 1방울 개인별 액상 하루 바로 비타민D 1개 액상 영양보충</td>\n",
       "      <td>개 유아 방울 개인 별 액 하루 바로 비타민 개 액 영양 보충</td>\n",
       "      <td>유아 방울 개인 하루 바로 비타민 영양 보충</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11126</th>\n",
       "      <td>11126</td>\n",
       "      <td>B002-02563-00004</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0001</td>\n",
       "      <td>B002-02563</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>HCA:750mg 1일 총 섭취량:2포 제품용량:1개월분 제품타입:분말 섭취횟수:하...</td>\n",
       "      <td>19.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>HCA:750mg 1일 총 섭취량:2포 제품용량:1개월분 제품타입:분말 섭취횟수:하...</td>\n",
       "      <td>{'HCA': '750mg', '1일 총 섭취량': '2포', '제품용량': '1개...</td>\n",
       "      <td>750mg 2포 1개월분 분말 하루 물에 성인남녀 체지방 1개 1500mg x 60포</td>\n",
       "      <td>포 개월 분말 하루 물 성인 남녀 체지방 개 포</td>\n",
       "      <td>개월 분말 하루 성인 남녀 체지방</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11125</th>\n",
       "      <td>11125</td>\n",
       "      <td>B002-02563-00003</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0001</td>\n",
       "      <td>B002-02563</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>23</td>\n",
       "      <td>16</td>\n",
       "      <td>HCA:850mg 영양소 원료명(식약처고시):식이섬유 1일 총 섭취량:2포 제품용량...</td>\n",
       "      <td>44.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>HCA:850mg 영양소 원료명 식약처고시 :식이섬유 1일 총 섭취량:2포 제품용량...</td>\n",
       "      <td>{'HCA': '850mg', '영양소 원료명 식약처고시': '식이섬유', '1일 ...</td>\n",
       "      <td>850mg 식이섬유 2포 15일분 분말 하루 물과 성인남녀 체지방 1개 5g x 3...</td>\n",
       "      <td>식이섬유 포 분말 하루 물 성인 남녀 체지방 개 포 라인 핏 포</td>\n",
       "      <td>식이섬유 분말 하루 성인 남녀 체지방 라인</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11124</th>\n",
       "      <td>11124</td>\n",
       "      <td>B002-02563-00002</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0001</td>\n",
       "      <td>B002-02563</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>제품유형:일반식품 영양소 원료명(식약처고시):비타민C 콜라겐 펩타이드:1000mg ...</td>\n",
       "      <td>22.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>제품유형:일반식품 영양소 원료명 식약처고시 :비타민C 콜라겐 펩타이드:1000mg ...</td>\n",
       "      <td>{'제품유형': '일반식품', '영양소 원료명 식약처고시': '비타민C', '콜라겐...</td>\n",
       "      <td>일반식품 비타민C 1000mg 어류 500Da 성인남녀 분말 15일분 하루 1포 바...</td>\n",
       "      <td>일반 식품 비타민 어류 성인 남녀 분말 하루 포 바로 개 포</td>\n",
       "      <td>일반 식품 비타민 어류 성인 남녀 분말 하루 바로</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11123</th>\n",
       "      <td>11123</td>\n",
       "      <td>B002-02563-00001</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0001</td>\n",
       "      <td>B002-02563</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>15</td>\n",
       "      <td>10</td>\n",
       "      <td>HCA:750mg 1일 총 섭취량:2포 제품용량:1개월분 제품타입:분말 섭취횟수:하...</td>\n",
       "      <td>123.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>HCA:750mg 1일 총 섭취량:2포 제품용량:1개월분 제품타입:분말 섭취횟수:하...</td>\n",
       "      <td>{'HCA': '850mg', '1일 총 섭취량': '2포', '제품용량': '2개...</td>\n",
       "      <td>850mg 2포 2개월분 정 하루 물과 성인남녀 콜레스테롤 1개 해당 성인남녀 물과...</td>\n",
       "      <td>포 개월 정 하루 물 성인 남녀 콜레스테롤 개 해당 성인 남녀 물 정 개 일반 식품...</td>\n",
       "      <td>개월 하루 성인 남녀 콜레스테롤 해당 성인 남녀 일반 식품 어류 성인 남녀</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10189</th>\n",
       "      <td>10189</td>\n",
       "      <td>B002-02374-00004</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-02374</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>주요 기능성(식약처인증):혈행개선 DHA+EPA:526mg 제품타입:캡슐 섭취대상:...</td>\n",
       "      <td>34.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>주요 기능성 식약처인증 :혈행개선 DHA EPA:526mg 제품타입:캡슐 섭취대상:...</td>\n",
       "      <td>{'주요 기능성 식약처인증': '혈행개선', 'DHA EPA': '526mg', '...</td>\n",
       "      <td>혈행개선 526mg 캡슐 성인남녀 2개월분 3캡슐 하루 물과 1개 440mg x 9...</td>\n",
       "      <td>혈행 개선 캡슐 성인 남녀 개월 캡슐 하루 물 개 캡슐 식물성</td>\n",
       "      <td>혈행 개선 캡슐 성인 남녀 개월 캡슐 하루 캡슐 식물성</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4930</th>\n",
       "      <td>4930</td>\n",
       "      <td>B002-01180-00001</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0001</td>\n",
       "      <td>B002-01180</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>세트종류:4종 메뉴종류:곤약밥 메뉴종류:잡곡밥 메뉴종류:볶음밥 포장형태:용기형 보관...</td>\n",
       "      <td>23.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>세트종류:4종 메뉴종류:곤약밥 메뉴종류:잡곡밥 메뉴종류:볶음밥 포장형태:용기형 보관...</td>\n",
       "      <td>{'세트종류': '4종', '메뉴종류': '볶음밥', '포장형태': '용기형', '...</td>\n",
       "      <td>4종 볶음밥 용기형 1개 200g 8종 x 4팩 볶음밥 200g 300kcal</td>\n",
       "      <td>종 볶음밥 용기 개 종 팩 볶음밥</td>\n",
       "      <td>볶음밥 용기 볶음밥</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13494</th>\n",
       "      <td>13494</td>\n",
       "      <td>B002-03222-00001</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0004</td>\n",
       "      <td>B002-03222</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>종류:웨이 단백질종류:동물성+식물성 단백질성분:농축유청단백질(WPC) 단백질성분:분...</td>\n",
       "      <td>20.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>종류:웨이 단백질종류:동물성 식물성 단백질성분:농축유청단백질 WPC 단백질성분:분리...</td>\n",
       "      <td>{'종류': '웨이', '단백질종류': '동물성', '식물성 단백질성분': '농축유...</td>\n",
       "      <td>웨이 동물성 농축유청단백질 분리유청단백질 분리대두단백질 33g 성인남녀 초코 물에 ...</td>\n",
       "      <td>웨이 동물성 농축 유청 단백질 분리 유청 단백질 분리 단백질 성인 남녀 초코 물 스...</td>\n",
       "      <td>웨이 동물성 농축 유청 단백질 분리 유청 단백질 분리 단백질 성인 남녀 초코 스푼 ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13496</th>\n",
       "      <td>13496</td>\n",
       "      <td>B002-03222-00003</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0004</td>\n",
       "      <td>B002-03222</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>22</td>\n",
       "      <td>10</td>\n",
       "      <td>종류:웨이 단백질종류:동물성+식물성 단백질성분:농축유청단백질(WPC) 단백질성분:분...</td>\n",
       "      <td>436.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>종류:웨이 단백질종류:동물성 식물성 단백질성분:농축유청단백질 WPC 단백질성분:분리...</td>\n",
       "      <td>{'종류': '게이너', '단백질종류': '동물성', '식물성 단백질성분': '농축...</td>\n",
       "      <td>게이너 동물성 농축유청단백질 분리유청단백질 분리대두단백질 29g 성인남녀 초코 물에...</td>\n",
       "      <td>게이 너 동물성 농축 유청 단백질 분리 유청 단백질 분리 단백질 성인 남녀 초코 물...</td>\n",
       "      <td>게이 동물성 농축 유청 단백질 분리 유청 단백질 분리 단백질 성인 남녀 초코 스푼 ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13534</th>\n",
       "      <td>13534</td>\n",
       "      <td>B002-03242-00001</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-03242</td>\n",
       "      <td>11</td>\n",
       "      <td>12</td>\n",
       "      <td>17</td>\n",
       "      <td>17</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>종류_A섭취대상:아르기닌 섭취방법:성인남녀 1일 총 섭취량:바로 음용 섭취횟수:1포...</td>\n",
       "      <td>15.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>종류 A섭취대상:아르기닌 섭취방법:성인남녀 1일 총 섭취량:바로 음용 섭취횟수:1포...</td>\n",
       "      <td>{'종류 A섭취대상': '아르기닌', '섭취방법': '성인남녀', '1일 총 섭취량...</td>\n",
       "      <td>아르기닌 성인남녀 바로 1포 하루 15일분 6500 20g x 15포</td>\n",
       "      <td>아르기닌 성인 남녀 바로 포 하루 포</td>\n",
       "      <td>아르기닌 성인 남녀 바로 하루</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13533</th>\n",
       "      <td>13533</td>\n",
       "      <td>B002-03241-00004</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0001</td>\n",
       "      <td>B002-03241</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>주요 기능성(식약처인증):장건강 영양소 원료명(식약처고시):식이섬유 제품타입:분말 ...</td>\n",
       "      <td>18.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>주요 기능성 식약처인증 :장건강 영양소 원료명 식약처고시 :식이섬유 제품타입:분말 ...</td>\n",
       "      <td>{'주요 기능성 식약처인증': '장건강', '영양소 원료명 식약처고시': '식이섬유...</td>\n",
       "      <td>장건강 식이섬유 분말 물에 성인남녀 하루 2포 14일분 1개 28포</td>\n",
       "      <td>장 건강 식이섬유 분말 물 성인 남녀 하루 포 개 포</td>\n",
       "      <td>건강 식이섬유 분말 성인 남녀 하루</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4958</th>\n",
       "      <td>4958</td>\n",
       "      <td>B002-01191-00001</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0009</td>\n",
       "      <td>B002-C003-0051</td>\n",
       "      <td>B002-01191</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>최소연령:신생아 단계별:1단계 종류:일반분유 제품형태:분말 포장형태:캔 용량:800...</td>\n",
       "      <td>297.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>최소연령:신생아 단계별:1단계 종류:일반분유 제품형태:분말 포장형태:캔 용량:800...</td>\n",
       "      <td>{'최소연령': '4개월', '단계별': '2단계', '종류': '일반분유', '제...</td>\n",
       "      <td>4개월 2단계 일반분유 분말 스틱 280g 2020년도 프로바이오틱스 미숙아 소화촉...</td>\n",
       "      <td>개월 단계 일반 분유 분말 스틱 프로바이오틱스 미숙아 소화 촉진 단계 신생아 개 개...</td>\n",
       "      <td>개월 단계 일반 분유 분말 스틱 프로바이오틱스 미숙아 소화 촉진 단계 신생아 소화 촉진</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4957</th>\n",
       "      <td>4957</td>\n",
       "      <td>B002-01190-00001</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-01190</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>총 플라보노이드:17mg 1일 총 섭취량:2캡슐 제품용량:10개월분 제품타입:캡슐 ...</td>\n",
       "      <td>21.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>총 플라보노이드:17mg 1일 총 섭취량:2캡슐 제품용량:10개월분 제품타입:캡슐 ...</td>\n",
       "      <td>{'총 플라보노이드': '17mg', '1일 총 섭취량': '2캡슐', '제품용량'...</td>\n",
       "      <td>17mg 2캡슐 10개월분 캡슐 하루 물과 성인남녀 항산화 1개 1개 500mg 6...</td>\n",
       "      <td>캡슐 개월 캡슐 하루 물 성인 남녀 항산화 개 개 캡슐</td>\n",
       "      <td>캡슐 개월 캡슐 하루 성인 남녀 항산화 캡슐</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13519</th>\n",
       "      <td>13519</td>\n",
       "      <td>B002-03239-00004</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0004</td>\n",
       "      <td>B002-03239</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>영양소 원료명(식약처고시)_A단백질종류:아연 단백질:동물성+식물성 맛:12g 섭취대...</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>영양소 원료명 식약처고시 A단백질종류:아연 단백질:동물성 식물성 맛:12g 섭취대상...</td>\n",
       "      <td>{'영양소 원료명 식약처고시 A단백질종류': '아연', '단백질': '동물성', '...</td>\n",
       "      <td>아연 동물성 12g 우유 바로 음용 365 250ml</td>\n",
       "      <td>아연 동물성 우유 바로 음용</td>\n",
       "      <td>아연 동물성 우유 바로 음용</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10180</th>\n",
       "      <td>10180</td>\n",
       "      <td>B002-02373-00001</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-02373</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>...</td>\n",
       "      <td>29</td>\n",
       "      <td>31</td>\n",
       "      <td>제품타입:캡슐 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 두 번 1일 총 ...</td>\n",
       "      <td>28.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>제품타입:캡슐 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 두 번 1일 총 ...</td>\n",
       "      <td>{'제품타입': '베지캡슐', '섭취방법': '물과', '함께 섭취대상': '성인남...</td>\n",
       "      <td>베지캡슐 물과 성인남녀 하루 2캡슐 1개 2캡슐 2개월분 1개 1000mg x 12...</td>\n",
       "      <td>캡슐 물 성인 남녀 하루 캡슐 개 캡슐 개월 개 캡슐</td>\n",
       "      <td>캡슐 성인 남녀 하루 캡슐 캡슐 개월 캡슐</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10182</th>\n",
       "      <td>10182</td>\n",
       "      <td>B002-02373-00003</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-02373</td>\n",
       "      <td>20</td>\n",
       "      <td>20</td>\n",
       "      <td>21</td>\n",
       "      <td>24</td>\n",
       "      <td>...</td>\n",
       "      <td>6</td>\n",
       "      <td>4</td>\n",
       "      <td>생균:50억 CFU 1일 총 섭취량:9정 제품용량:2개월분 제품타입:캡슐 섭취횟수:...</td>\n",
       "      <td>19.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>생균:50억 CFU 1일 총 섭취량:9정 제품용량:2개월분 제품타입:캡슐 섭취횟수:...</td>\n",
       "      <td>{'생균': '50억', 'CFU 1일 총 섭취량': '9정', '제품용량': '2...</td>\n",
       "      <td>50억 9정 2개월분 캡슐 하루 물과 성인여성 1개 10억 유산균 60캡슐</td>\n",
       "      <td>정 개월 캡슐 하루 물 성인 여성 개 유산균 캡슐</td>\n",
       "      <td>개월 캡슐 하루 성인 여성 유산균 캡슐</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10184</th>\n",
       "      <td>10184</td>\n",
       "      <td>B002-02373-00005</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-02373</td>\n",
       "      <td>7</td>\n",
       "      <td>8</td>\n",
       "      <td>10</td>\n",
       "      <td>8</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>생균:50억 CFU 1일 총 섭취량:1캡슐 제품용량:4개월분 제품타입:베지캡슐 섭취...</td>\n",
       "      <td>19.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>생균:50억 CFU 1일 총 섭취량:1캡슐 제품용량:4개월분 제품타입:베지캡슐 섭취...</td>\n",
       "      <td>{'생균': '50억', 'CFU 1일 총 섭취량': '1캡슐', '제품용량': '...</td>\n",
       "      <td>50억 1캡슐 4개월분 베지캡슐 하루 물과 성인남녀 1개 50억 유산균 120베지캡슐</td>\n",
       "      <td>캡슐 개월 캡슐 하루 물 성인 남녀 개 유산균 캡슐</td>\n",
       "      <td>캡슐 개월 캡슐 하루 성인 남녀 유산균 캡슐</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10185</th>\n",
       "      <td>10185</td>\n",
       "      <td>B002-02373-00006</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-02373</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>제품타입:베지캡슐 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 세 번 1일 ...</td>\n",
       "      <td>41.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>제품타입:베지캡슐 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 세 번 1일 ...</td>\n",
       "      <td>{'제품타입': '정', '섭취방법': '물과', '함께 섭취대상': '성인남녀',...</td>\n",
       "      <td>정 물과 성인남녀 하루 3정 1개 1000mg x 200캡슐 성인남녀 1정 1개 개인별</td>\n",
       "      <td>정 물 성인 남녀 하루 정 개 캡슐 성인 남녀 정 개 개인 별</td>\n",
       "      <td>성인 남녀 하루 캡슐 성인 남녀 개인</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13510</th>\n",
       "      <td>13510</td>\n",
       "      <td>B002-03232-00001</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-03232</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>중량포장형태:400g, 포장형태제품용량섭취횟수1일 총 섭취량섭취방법:파우치형, 포장...</td>\n",
       "      <td>15.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>중량포장형태:400g 포장형태제품용량섭취횟수1일 총 섭취량섭취방법:파우치형 포장형태...</td>\n",
       "      <td>{'중량포장형태': '400g', '포장형태제품용량섭취횟수1일 총 섭취량섭취방법':...</td>\n",
       "      <td>400g 용기형 4000 4 2g x 30포 3개월분</td>\n",
       "      <td>용기 포 개월</td>\n",
       "      <td>용기 개월</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13509</th>\n",
       "      <td>13509</td>\n",
       "      <td>B002-03231-00002</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-03231</td>\n",
       "      <td>15</td>\n",
       "      <td>11</td>\n",
       "      <td>4</td>\n",
       "      <td>20</td>\n",
       "      <td>...</td>\n",
       "      <td>21</td>\n",
       "      <td>14</td>\n",
       "      <td>제품타입:환 섭취방법:물과 함께 :1개 100g</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>제품타입:환 섭취방법:물과 함께 :1개 100g</td>\n",
       "      <td>{'제품타입': '환', '섭취방법': '물과', '함께': '1개 100g'}</td>\n",
       "      <td>환 물과 1개 100g</td>\n",
       "      <td>환 물 개</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13508</th>\n",
       "      <td>13508</td>\n",
       "      <td>B002-03231-00001</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0001</td>\n",
       "      <td>B002-03231</td>\n",
       "      <td>11</td>\n",
       "      <td>13</td>\n",
       "      <td>19</td>\n",
       "      <td>18</td>\n",
       "      <td>...</td>\n",
       "      <td>4</td>\n",
       "      <td>9</td>\n",
       "      <td>제품유형:일반식품 종류:어류 분자량:1980 섭취대상:성인남녀 제품타입:구미/젤리 ...</td>\n",
       "      <td>17.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>제품유형:일반식품 종류:어류 분자량:1980 섭취대상:성인남녀 제품타입:구미 젤리 ...</td>\n",
       "      <td>{'제품유형': '일반식품', '종류': '어류', '분자량': '1980', '섭...</td>\n",
       "      <td>일반식품 어류 1980 성인남녀 구미 1개월분 하루 1포 1개 20g x 30개입</td>\n",
       "      <td>일반 식품 어류 성인 남녀 구미 개월 하루 포 개 개입</td>\n",
       "      <td>일반 식품 어류 성인 남녀 구미 개월 하루 개입</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13504</th>\n",
       "      <td>13504</td>\n",
       "      <td>B002-03227-00001</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-03227</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>제품타입:구미/젤리 섭취방법:씹어서 섭취대상:유아/청소년 섭취횟수:하루 두 번 1일...</td>\n",
       "      <td>20.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>제품타입:구미 젤리 섭취방법:씹어서 섭취대상:유아 청소년 섭취횟수:하루 두 번 1일...</td>\n",
       "      <td>{'제품타입': '구미', '젤리 섭취방법': '씹어서', '섭취대상': '유아',...</td>\n",
       "      <td>구미 씹어서 유아 하루 2포 7일분 성장발육 단백질 1개 042 25g x 14포</td>\n",
       "      <td>구미 유아 하루 포 성장 발육 단백질 개 포</td>\n",
       "      <td>구미 유아 하루 성장 발육 단백질</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10186</th>\n",
       "      <td>10186</td>\n",
       "      <td>B002-02374-00001</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0002</td>\n",
       "      <td>B002-02374</td>\n",
       "      <td>12</td>\n",
       "      <td>8</td>\n",
       "      <td>7</td>\n",
       "      <td>8</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>주요 기능성(식약처인증):영양보충 영양소 원료명(식약처고시):비타민D 영양소 원료명...</td>\n",
       "      <td>113.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>주요 기능성 식약처인증 :영양보충 영양소 원료명 식약처고시 :비타민D 영양소 원료명...</td>\n",
       "      <td>{'주요 기능성 식약처인증': '영양보충', '영양소 원료명 식약처고시': '셀레늄...</td>\n",
       "      <td>영양보충 셀레늄 망간 12개 110mg 25 15mg 임산부 정 2개월분 2정 하루...</td>\n",
       "      <td>영양 보충 셀레늄 망간 개 임산부 정 개월 정 하루 물 개 정</td>\n",
       "      <td>영양 보충 셀레늄 망간 임산부 개월 하루</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13500</th>\n",
       "      <td>13500</td>\n",
       "      <td>B002-03224-00001</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0004</td>\n",
       "      <td>B002-03224</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>주요 기능성(식약처인증):해당 없음 영양소 원료명(식약처고시):단백질 단백질종류:동...</td>\n",
       "      <td>22.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>주요 기능성 식약처인증 :해당 없음 영양소 원료명 식약처고시 :단백질 단백질종류:동...</td>\n",
       "      <td>{'주요 기능성 식약처인증': '해당', '없음 영양소 원료명 식약처고시': '단백...</td>\n",
       "      <td>해당 단백질 동물성 분리유청단백질 분리대두단백질 산양유단백질 19g 성인남녀 물에 ...</td>\n",
       "      <td>해당 단백질 동물성 분리 유청 단백질 분리 단백질 산양 유 단백질 성인 남녀 물 스...</td>\n",
       "      <td>해당 단백질 동물성 분리 유청 단백질 분리 단백질 산양 단백질 성인 남녀 스푼 하루</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10187</th>\n",
       "      <td>10187</td>\n",
       "      <td>B002-02374-00002</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0002</td>\n",
       "      <td>B002-02374</td>\n",
       "      <td>10</td>\n",
       "      <td>7</td>\n",
       "      <td>6</td>\n",
       "      <td>5</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>주요 기능성(식약처인증):영양보충 영양소 원료명(식약처고시):비타민D 영양소 원료명...</td>\n",
       "      <td>113.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>주요 기능성 식약처인증 :영양보충 영양소 원료명 식약처고시 :비타민D 영양소 원료명...</td>\n",
       "      <td>{'주요 기능성 식약처인증': '영양보충', '영양소 원료명 식약처고시': '셀레늄...</td>\n",
       "      <td>영양보충 셀레늄 망간 12개 110mg 25 15mg 임산부 정 2개월분 2정 하루...</td>\n",
       "      <td>영양 보충 셀레늄 망간 개 임산부 정 개월 정 하루 물 개 정</td>\n",
       "      <td>영양 보충 셀레늄 망간 임산부 개월 하루</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10188</th>\n",
       "      <td>10188</td>\n",
       "      <td>B002-02374-00003</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-02374</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>제품타입:액상 섭취방법:물에 섞어서 섭취대상:임산부 섭취횟수:하루 한 번 1일 총 ...</td>\n",
       "      <td>37.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>제품타입:액상 섭취방법:물에 섞어서 섭취대상:임산부 섭취횟수:하루 한 번 1일 총 ...</td>\n",
       "      <td>{'제품타입': '액상', '섭취방법': '물에', '섞어서 섭취대상': '임산부'...</td>\n",
       "      <td>액상 물에 임산부 하루 1포 2개월분 영양보충 철 1개 10ml x 60포</td>\n",
       "      <td>액 물 임산부 하루 포 개월 영양 보충 철 개 포</td>\n",
       "      <td>임산부 하루 개월 영양 보충</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13495</th>\n",
       "      <td>13495</td>\n",
       "      <td>B002-03222-00002</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0004</td>\n",
       "      <td>B002-03222</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>6</td>\n",
       "      <td>2</td>\n",
       "      <td>종류:웨이 단백질종류:동물성+식물성 단백질성분:농축유청단백질(WPC) 단백질성분:분...</td>\n",
       "      <td>101.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>종류:웨이 단백질종류:동물성 식물성 단백질성분:농축유청단백질 WPC 단백질성분:분리...</td>\n",
       "      <td>{'종류': '웨이', '단백질종류': '동물성', '식물성 단백질성분': '농축유...</td>\n",
       "      <td>웨이 동물성 농축유청단백질 분리유청단백질 분리대두단백질 37g 성인남녀 초코 물에 ...</td>\n",
       "      <td>웨이 동물성 농축 유청 단백질 분리 유청 단백질 분리 단백질 성인 남녀 초코 물 개...</td>\n",
       "      <td>웨이 동물성 농축 유청 단백질 분리 유청 단백질 분리 단백질 성인 남녀 초코 개인 ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4929</th>\n",
       "      <td>4929</td>\n",
       "      <td>B002-01179-00002</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-01179</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>제품타입:캡슐 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 ...</td>\n",
       "      <td>21.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>제품타입:캡슐 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 ...</td>\n",
       "      <td>{'제품타입': '캡슐', '섭취방법': '물과', '함께 섭취대상': '성인남녀'...</td>\n",
       "      <td>캡슐 물과 성인남녀 하루 1캡슐 1개월분 항산화 비타민E 1개 10 500mg x ...</td>\n",
       "      <td>캡슐 물 성인 남녀 하루 캡슐 개월 항산화 비타민 개 캡슐</td>\n",
       "      <td>캡슐 성인 남녀 하루 캡슐 개월 항산화 비타민 캡슐</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4928</th>\n",
       "      <td>4928</td>\n",
       "      <td>B002-01179-00001</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-01179</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 섭...</td>\n",
       "      <td>213.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 섭...</td>\n",
       "      <td>{'제품타입': '정', '섭취방법': '물과', '함께 섭취대상': '성인남녀',...</td>\n",
       "      <td>정 물과 성인남녀 하루 1정 2개월분 영양보충 엽산 800 g 400 450mg x...</td>\n",
       "      <td>정 물 성인 남녀 하루 정 개월 영양 보충 엽산 정 개 요오드 개 성인 남성 정 물 개</td>\n",
       "      <td>성인 남녀 하루 개월 영양 보충 엽산 요오드 성인 남성</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13462</th>\n",
       "      <td>13462</td>\n",
       "      <td>B002-03211-00004</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-03211</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 섭...</td>\n",
       "      <td>30.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 섭...</td>\n",
       "      <td>{'제품타입': '정', '섭취방법': '물과', '함께 섭취대상': '성인남녀',...</td>\n",
       "      <td>정 물과 성인남녀 하루 2정 1개월분 위건강 셀레늄 1개 500mg x 60정</td>\n",
       "      <td>정 물 성인 남녀 하루 정 개월 위 건강 셀레늄 개 정</td>\n",
       "      <td>성인 남녀 하루 개월 건강 셀레늄</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11104</th>\n",
       "      <td>11104</td>\n",
       "      <td>B002-02556-00006</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0005</td>\n",
       "      <td>B002-02556</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>홍삼농축액 함량:15.5% 1일 총 섭취량:6스푼 제품용량:3개월분 섭취횟수:하루 ...</td>\n",
       "      <td>153.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>홍삼농축액 함량:15 5 1일 총 섭취량:6스푼 제품용량:3개월분 섭취횟수:하루 세...</td>\n",
       "      <td>{'홍삼농축액 함량': '15', '5 1일 총 섭취량': '6스푼', '제품용량'...</td>\n",
       "      <td>15 6스푼 100일분 하루 물에 성인남녀 건강기능식품 면역력 해당 1개 60 4m...</td>\n",
       "      <td>스푼 하루 물 성인 남녀 건강 기능 식품 면역 해당 개 뚜껑 스푼 농축액 개 성인 ...</td>\n",
       "      <td>스푼 하루 성인 남녀 건강 기능 식품 면역 해당 뚜껑 스푼 농축액 성인 남녀 건강 ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13415</th>\n",
       "      <td>13415</td>\n",
       "      <td>B002-03201-00002</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0002</td>\n",
       "      <td>B002-03201</td>\n",
       "      <td>7</td>\n",
       "      <td>5</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>섭취대상:유아/청소년 :1개 700mg x 120정</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>섭취대상:유아 청소년 :1개 700mg x 120정</td>\n",
       "      <td>{'섭취대상': '유아', '청소년': '1개 700mg x 120정'}</td>\n",
       "      <td>유아 1개 700mg x 120정</td>\n",
       "      <td>유아 개 정</td>\n",
       "      <td>유아</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13411</th>\n",
       "      <td>13411</td>\n",
       "      <td>B002-03198-00001</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-03198</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>2</td>\n",
       "      <td>8</td>\n",
       "      <td>생균:100억 CFU 1일 총 섭취량:1포 제품용량:2개월분 제품타입:분말 섭취횟수...</td>\n",
       "      <td>22.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>생균:100억 CFU 1일 총 섭취량:1포 제품용량:2개월분 제품타입:분말 섭취횟수...</td>\n",
       "      <td>{'생균': '100억', 'CFU 1일 총 섭취량': '1포', '제품용량': '...</td>\n",
       "      <td>100억 1포 2개월분 분말 하루 바로 성인남녀 장건강 해당 1개 2g x 60포</td>\n",
       "      <td>포 개월 분말 하루 바로 성인 남녀 장 건강 해당 개 포</td>\n",
       "      <td>개월 분말 하루 바로 성인 남녀 건강 해당</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11103</th>\n",
       "      <td>11103</td>\n",
       "      <td>B002-02556-00005</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0005</td>\n",
       "      <td>B002-02556</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1일 총 섭취량:2스푼 제품용량:100일분 섭취횟수:하루 두 번 섭취방법:바로 음용...</td>\n",
       "      <td>15.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1일 총 섭취량:2스푼 제품용량:100일분 섭취횟수:하루 두 번 섭취방법:바로 음용...</td>\n",
       "      <td>{'1일 총 섭취량': '2스푼', '제품용량': '100일분', '섭취횟수': '...</td>\n",
       "      <td>2스푼 100일분 하루 바로 성인남녀 1개 250g x 4개입</td>\n",
       "      <td>스푼 하루 바로 성인 남녀 개 개입</td>\n",
       "      <td>스푼 하루 바로 성인 남녀 개입</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13408</th>\n",
       "      <td>13408</td>\n",
       "      <td>B002-03194-00003</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0002</td>\n",
       "      <td>B002-03194</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>6</td>\n",
       "      <td>12</td>\n",
       "      <td>주요 기능성(식약처인증):영양보충 영양소 원료명(식약처고시):비타민D 영양소 원료명...</td>\n",
       "      <td>75.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>주요 기능성 식약처인증 :영양보충 영양소 원료명 식약처고시 :비타민D 영양소 원료명...</td>\n",
       "      <td>{'주요 기능성 식약처인증': '영양보충', '영양소 원료명 식약처고시': '아연'...</td>\n",
       "      <td>영양보충 아연 5 7mg 유아 구미 15일분 1포 하루 1개 3종 선물세트 구미</td>\n",
       "      <td>영양 보충 아연 유아 구미 포 하루 개 종 선물 세트 구미</td>\n",
       "      <td>영양 보충 아연 유아 구미 하루 선물 세트 구미</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13407</th>\n",
       "      <td>13407</td>\n",
       "      <td>B002-03194-00002</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-03194</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>제품타입:액상 섭취방법:바로 음용 섭취대상:성인남녀 섭취횟수:수시로 제품유형:일반식...</td>\n",
       "      <td>8.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>제품타입:액상 섭취방법:바로 음용 섭취대상:성인남녀 섭취횟수:수시로 제품유형:일반식...</td>\n",
       "      <td>{'제품타입': '액상', '섭취방법': '바로', '음용 섭취대상': '성인남녀'...</td>\n",
       "      <td>액상 바로 성인남녀 수시로 1개 30ml</td>\n",
       "      <td>액 바로 성인 남녀 개</td>\n",
       "      <td>바로 성인 남녀</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13406</th>\n",
       "      <td>13406</td>\n",
       "      <td>B002-03194-00001</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0002</td>\n",
       "      <td>B002-03194</td>\n",
       "      <td>73</td>\n",
       "      <td>54</td>\n",
       "      <td>90</td>\n",
       "      <td>95</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>주요 기능성(식약처인증):영양보충 영양소 원료명(식약처고시):비타민D 영양소 원료명...</td>\n",
       "      <td>55.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>주요 기능성 식약처인증 :영양보충 영양소 원료명 식약처고시 :비타민D 영양소 원료명...</td>\n",
       "      <td>{'주요 기능성 식약처인증': '영양보충', '영양소 원료명 식약처고시': '아연'...</td>\n",
       "      <td>영양보충 아연 5 7mg 유아 구미 15일분 1포 하루 1개 15g x 15포</td>\n",
       "      <td>영양 보충 아연 유아 구미 포 하루 개 포</td>\n",
       "      <td>영양 보충 아연 유아 구미 하루</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>50 rows × 473 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          ID                제품             대분류             중분류  \\\n",
       "11376  11376  B002-02643-00001  B002-C001-0001  B002-C002-0001   \n",
       "4955    4955  B002-01188-00009  B002-C001-0001  B002-C002-0001   \n",
       "4954    4954  B002-01188-00008  B002-C001-0001  B002-C002-0001   \n",
       "4953    4953  B002-01188-00007  B002-C001-0001  B002-C002-0001   \n",
       "4952    4952  B002-01188-00006  B002-C001-0001  B002-C002-0001   \n",
       "4951    4951  B002-01188-00005  B002-C001-0001  B002-C002-0001   \n",
       "7353    7353  B002-01804-00001  B002-C001-0001  B002-C002-0001   \n",
       "7351    7351  B002-01802-00002  B002-C001-0001  B002-C002-0001   \n",
       "7350    7350  B002-01802-00001  B002-C001-0001  B002-C002-0001   \n",
       "7349    7349  B002-01801-00001  B002-C001-0001  B002-C002-0001   \n",
       "4950    4950  B002-01188-00004  B002-C001-0001  B002-C002-0001   \n",
       "4949    4949  B002-01188-00003  B002-C001-0001  B002-C002-0001   \n",
       "4948    4948  B002-01188-00002  B002-C001-0001  B002-C002-0001   \n",
       "4947    4947  B002-01188-00001  B002-C001-0001  B002-C002-0001   \n",
       "11126  11126  B002-02563-00004  B002-C001-0001  B002-C002-0001   \n",
       "11125  11125  B002-02563-00003  B002-C001-0001  B002-C002-0001   \n",
       "11124  11124  B002-02563-00002  B002-C001-0001  B002-C002-0001   \n",
       "11123  11123  B002-02563-00001  B002-C001-0001  B002-C002-0001   \n",
       "10189  10189  B002-02374-00004  B002-C001-0001  B002-C002-0001   \n",
       "4930    4930  B002-01180-00001  B002-C001-0001  B002-C002-0001   \n",
       "13494  13494  B002-03222-00001  B002-C001-0001  B002-C002-0001   \n",
       "13496  13496  B002-03222-00003  B002-C001-0001  B002-C002-0001   \n",
       "13534  13534  B002-03242-00001  B002-C001-0001  B002-C002-0001   \n",
       "13533  13533  B002-03241-00004  B002-C001-0001  B002-C002-0001   \n",
       "4958    4958  B002-01191-00001  B002-C001-0001  B002-C002-0009   \n",
       "4957    4957  B002-01190-00001  B002-C001-0001  B002-C002-0001   \n",
       "13519  13519  B002-03239-00004  B002-C001-0001  B002-C002-0001   \n",
       "10180  10180  B002-02373-00001  B002-C001-0001  B002-C002-0001   \n",
       "10182  10182  B002-02373-00003  B002-C001-0001  B002-C002-0001   \n",
       "10184  10184  B002-02373-00005  B002-C001-0001  B002-C002-0001   \n",
       "10185  10185  B002-02373-00006  B002-C001-0001  B002-C002-0001   \n",
       "13510  13510  B002-03232-00001  B002-C001-0001  B002-C002-0001   \n",
       "13509  13509  B002-03231-00002  B002-C001-0001  B002-C002-0001   \n",
       "13508  13508  B002-03231-00001  B002-C001-0001  B002-C002-0001   \n",
       "13504  13504  B002-03227-00001  B002-C001-0001  B002-C002-0001   \n",
       "10186  10186  B002-02374-00001  B002-C001-0001  B002-C002-0001   \n",
       "13500  13500  B002-03224-00001  B002-C001-0001  B002-C002-0001   \n",
       "10187  10187  B002-02374-00002  B002-C001-0001  B002-C002-0001   \n",
       "10188  10188  B002-02374-00003  B002-C001-0001  B002-C002-0001   \n",
       "13495  13495  B002-03222-00002  B002-C001-0001  B002-C002-0001   \n",
       "4929    4929  B002-01179-00002  B002-C001-0001  B002-C002-0001   \n",
       "4928    4928  B002-01179-00001  B002-C001-0001  B002-C002-0001   \n",
       "13462  13462  B002-03211-00004  B002-C001-0001  B002-C002-0001   \n",
       "11104  11104  B002-02556-00006  B002-C001-0001  B002-C002-0001   \n",
       "13415  13415  B002-03201-00002  B002-C001-0001  B002-C002-0001   \n",
       "13411  13411  B002-03198-00001  B002-C001-0001  B002-C002-0001   \n",
       "11103  11103  B002-02556-00005  B002-C001-0001  B002-C002-0001   \n",
       "13408  13408  B002-03194-00003  B002-C001-0001  B002-C002-0001   \n",
       "13407  13407  B002-03194-00002  B002-C001-0001  B002-C002-0001   \n",
       "13406  13406  B002-03194-00001  B002-C001-0001  B002-C002-0001   \n",
       "\n",
       "                  소분류         브랜드  2022-01-01  2022-01-02  2022-01-03  \\\n",
       "11376  B002-C003-0001  B002-02643           0           0           0   \n",
       "4955   B002-C003-0003  B002-01188           0           0           0   \n",
       "4954   B002-C003-0002  B002-01188           0           0           0   \n",
       "4953   B002-C003-0003  B002-01188           0           0           0   \n",
       "4952   B002-C003-0003  B002-01188           0           0           0   \n",
       "4951   B002-C003-0003  B002-01188           0           0           0   \n",
       "7353   B002-C003-0003  B002-01804           0           0           0   \n",
       "7351   B002-C003-0003  B002-01802           0           0           0   \n",
       "7350   B002-C003-0003  B002-01802           0           0           0   \n",
       "7349   B002-C003-0001  B002-01801           0           0           0   \n",
       "4950   B002-C003-0003  B002-01188          64          56          50   \n",
       "4949   B002-C003-0002  B002-01188           0           0           0   \n",
       "4948   B002-C003-0002  B002-01188           3           1           0   \n",
       "4947   B002-C003-0002  B002-01188           0           0           0   \n",
       "11126  B002-C003-0001  B002-02563           0           0           0   \n",
       "11125  B002-C003-0001  B002-02563           0           0           0   \n",
       "11124  B002-C003-0001  B002-02563           0           0           0   \n",
       "11123  B002-C003-0001  B002-02563           0           0           0   \n",
       "10189  B002-C003-0003  B002-02374           0           0           0   \n",
       "4930   B002-C003-0001  B002-01180           0           0           0   \n",
       "13494  B002-C003-0004  B002-03222           0           0           0   \n",
       "13496  B002-C003-0004  B002-03222           0           0           0   \n",
       "13534  B002-C003-0003  B002-03242          11          12          17   \n",
       "13533  B002-C003-0001  B002-03241           0           0           0   \n",
       "4958   B002-C003-0051  B002-01191           4           1           3   \n",
       "4957   B002-C003-0003  B002-01190           0           0           0   \n",
       "13519  B002-C003-0004  B002-03239           0           0           0   \n",
       "10180  B002-C003-0003  B002-02373           1           1           1   \n",
       "10182  B002-C003-0003  B002-02373          20          20          21   \n",
       "10184  B002-C003-0003  B002-02373           7           8          10   \n",
       "10185  B002-C003-0003  B002-02373           0           0           0   \n",
       "13510  B002-C003-0003  B002-03232           0           0           0   \n",
       "13509  B002-C003-0003  B002-03231          15          11           4   \n",
       "13508  B002-C003-0001  B002-03231          11          13          19   \n",
       "13504  B002-C003-0003  B002-03227           0           0           0   \n",
       "10186  B002-C003-0002  B002-02374          12           8           7   \n",
       "13500  B002-C003-0004  B002-03224           0           4           4   \n",
       "10187  B002-C003-0002  B002-02374          10           7           6   \n",
       "10188  B002-C003-0003  B002-02374           0           0           0   \n",
       "13495  B002-C003-0004  B002-03222           0           0           0   \n",
       "4929   B002-C003-0003  B002-01179           0           0           0   \n",
       "4928   B002-C003-0003  B002-01179           0           0           0   \n",
       "13462  B002-C003-0003  B002-03211           0           0           0   \n",
       "11104  B002-C003-0005  B002-02556           0           0           0   \n",
       "13415  B002-C003-0002  B002-03201           7           5           2   \n",
       "13411  B002-C003-0003  B002-03198           0           0           0   \n",
       "11103  B002-C003-0005  B002-02556           0           0           0   \n",
       "13408  B002-C003-0002  B002-03194           0           0           0   \n",
       "13407  B002-C003-0003  B002-03194           0           0           0   \n",
       "13406  B002-C003-0002  B002-03194          73          54          90   \n",
       "\n",
       "       2022-01-04  ...  2023-04-03  2023-04-04  \\\n",
       "11376           0  ...          11           0   \n",
       "4955            0  ...           0           0   \n",
       "4954            0  ...           0           0   \n",
       "4953            0  ...           0           0   \n",
       "4952            0  ...           0           0   \n",
       "4951            0  ...           0           0   \n",
       "7353            0  ...           0           0   \n",
       "7351            0  ...           0           0   \n",
       "7350            0  ...           0           0   \n",
       "7349            0  ...           0           0   \n",
       "4950           52  ...          81         139   \n",
       "4949            0  ...           0           0   \n",
       "4948            1  ...           0           0   \n",
       "4947            0  ...          14           4   \n",
       "11126           0  ...           2           0   \n",
       "11125           0  ...          23          16   \n",
       "11124           0  ...           0           0   \n",
       "11123           0  ...          15          10   \n",
       "10189           0  ...           0           0   \n",
       "4930            0  ...           0           0   \n",
       "13494           0  ...           0           0   \n",
       "13496           0  ...          22          10   \n",
       "13534          17  ...           0           2   \n",
       "13533           0  ...           0           0   \n",
       "4958            3  ...           0           1   \n",
       "4957            5  ...           0           0   \n",
       "13519           0  ...           0           0   \n",
       "10180           3  ...          29          31   \n",
       "10182          24  ...           6           4   \n",
       "10184           8  ...           0           1   \n",
       "10185           5  ...           0           0   \n",
       "13510           0  ...           0           0   \n",
       "13509          20  ...          21          14   \n",
       "13508          18  ...           4           9   \n",
       "13504           0  ...           0           0   \n",
       "10186           8  ...           0           0   \n",
       "13500           0  ...           0           0   \n",
       "10187           5  ...           0           0   \n",
       "10188           0  ...           0           0   \n",
       "13495           0  ...           6           2   \n",
       "4929            0  ...           0           0   \n",
       "4928            0  ...           0           0   \n",
       "13462           0  ...           0           0   \n",
       "11104           0  ...           0           0   \n",
       "13415           2  ...           0           0   \n",
       "13411           0  ...           2           8   \n",
       "11103           0  ...           0           0   \n",
       "13408           0  ...           6          12   \n",
       "13407           0  ...           0           0   \n",
       "13406          95  ...           0           0   \n",
       "\n",
       "                                                    제품특성  desc_length  \\\n",
       "11376  HCA:750mg 영양소 원료명(식약처고시):해당 없음 1일 총 섭취량:2포 제품용...         56.0   \n",
       "4955   생균:20억 CFU 1일 총 섭취량:1캡슐 제품용량:1개월분 제품타입:캡슐 섭취횟수...         19.0   \n",
       "4954   1일 총 섭취량:1캡슐 제품타입:캡슐 섭취횟수:하루 한 번 섭취방법:물과 함께 주요...         16.0   \n",
       "4953   생균:10억 CFU 1일 총 섭취량:1포 제품용량:2개월분 제품타입:분말 섭취횟수:...         18.0   \n",
       "4952   아연:10mg 영양소 원료명(식약처고시):아연 섭취대상:유아/청소년 제품용량:1개월...         15.0   \n",
       "4951   생균:1억 CFU 제품용량:1개월분 제품타입:액상 섭취횟수:하루 한 번 섭취대상:유...         11.0   \n",
       "7353   영양소 원료명(식약처고시)DHA+EPA제품타입섭취대상제품용량1일 총 섭취량섭취횟수섭...        259.0   \n",
       "7351   제품타입:분말 섭취방법:바로 음용 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 ...         18.0   \n",
       "7350   제품타입:분말 섭취방법:물에 섞어서 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총...         16.0   \n",
       "7349                제품유형:일반식품 섭취대상:성인남녀 제품타입:분말 :1개 102g          5.0   \n",
       "4950   생균:1억 CFU 1일 총 섭취량:6방울 제품용량:1개월분 제품타입:액상 섭취횟수:...         19.0   \n",
       "4949   주요 기능성(식약처인증):영양보충 영양소 원료명(식약처고시):비타민D 영양소 원료명...        121.0   \n",
       "4948   주요 기능성(식약처인증):영양보충 영양소 원료명(식약처고시):비타민A 영양소 원료명...         53.0   \n",
       "4947   비타민D:10µg 섭취대상:유아/청소년 1일 총 섭취량:1방울 제품용량:개인별 다름...         29.0   \n",
       "11126  HCA:750mg 1일 총 섭취량:2포 제품용량:1개월분 제품타입:분말 섭취횟수:하...         19.0   \n",
       "11125  HCA:850mg 영양소 원료명(식약처고시):식이섬유 1일 총 섭취량:2포 제품용량...         44.0   \n",
       "11124  제품유형:일반식품 영양소 원료명(식약처고시):비타민C 콜라겐 펩타이드:1000mg ...         22.0   \n",
       "11123  HCA:750mg 1일 총 섭취량:2포 제품용량:1개월분 제품타입:분말 섭취횟수:하...        123.0   \n",
       "10189  주요 기능성(식약처인증):혈행개선 DHA+EPA:526mg 제품타입:캡슐 섭취대상:...         34.0   \n",
       "4930   세트종류:4종 메뉴종류:곤약밥 메뉴종류:잡곡밥 메뉴종류:볶음밥 포장형태:용기형 보관...         23.0   \n",
       "13494  종류:웨이 단백질종류:동물성+식물성 단백질성분:농축유청단백질(WPC) 단백질성분:분...         20.0   \n",
       "13496  종류:웨이 단백질종류:동물성+식물성 단백질성분:농축유청단백질(WPC) 단백질성분:분...        436.0   \n",
       "13534  종류_A섭취대상:아르기닌 섭취방법:성인남녀 1일 총 섭취량:바로 음용 섭취횟수:1포...         15.0   \n",
       "13533  주요 기능성(식약처인증):장건강 영양소 원료명(식약처고시):식이섬유 제품타입:분말 ...         18.0   \n",
       "4958   최소연령:신생아 단계별:1단계 종류:일반분유 제품형태:분말 포장형태:캔 용량:800...        297.0   \n",
       "4957   총 플라보노이드:17mg 1일 총 섭취량:2캡슐 제품용량:10개월분 제품타입:캡슐 ...         21.0   \n",
       "13519  영양소 원료명(식약처고시)_A단백질종류:아연 단백질:동물성+식물성 맛:12g 섭취대...         10.0   \n",
       "10180  제품타입:캡슐 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 두 번 1일 총 ...         28.0   \n",
       "10182  생균:50억 CFU 1일 총 섭취량:9정 제품용량:2개월분 제품타입:캡슐 섭취횟수:...         19.0   \n",
       "10184  생균:50억 CFU 1일 총 섭취량:1캡슐 제품용량:4개월분 제품타입:베지캡슐 섭취...         19.0   \n",
       "10185  제품타입:베지캡슐 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 세 번 1일 ...         41.0   \n",
       "13510  중량포장형태:400g, 포장형태제품용량섭취횟수1일 총 섭취량섭취방법:파우치형, 포장...         15.0   \n",
       "13509                         제품타입:환 섭취방법:물과 함께 :1개 100g          5.0   \n",
       "13508  제품유형:일반식품 종류:어류 분자량:1980 섭취대상:성인남녀 제품타입:구미/젤리 ...         17.0   \n",
       "13504  제품타입:구미/젤리 섭취방법:씹어서 섭취대상:유아/청소년 섭취횟수:하루 두 번 1일...         20.0   \n",
       "10186  주요 기능성(식약처인증):영양보충 영양소 원료명(식약처고시):비타민D 영양소 원료명...        113.0   \n",
       "13500  주요 기능성(식약처인증):해당 없음 영양소 원료명(식약처고시):단백질 단백질종류:동...         22.0   \n",
       "10187  주요 기능성(식약처인증):영양보충 영양소 원료명(식약처고시):비타민D 영양소 원료명...        113.0   \n",
       "10188  제품타입:액상 섭취방법:물에 섞어서 섭취대상:임산부 섭취횟수:하루 한 번 1일 총 ...         37.0   \n",
       "13495  종류:웨이 단백질종류:동물성+식물성 단백질성분:농축유청단백질(WPC) 단백질성분:분...        101.0   \n",
       "4929   제품타입:캡슐 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 ...         21.0   \n",
       "4928   제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 섭...        213.0   \n",
       "13462  제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 섭...         30.0   \n",
       "11104  홍삼농축액 함량:15.5% 1일 총 섭취량:6스푼 제품용량:3개월분 섭취횟수:하루 ...        153.0   \n",
       "13415                       섭취대상:유아/청소년 :1개 700mg x 120정          5.0   \n",
       "13411  생균:100억 CFU 1일 총 섭취량:1포 제품용량:2개월분 제품타입:분말 섭취횟수...         22.0   \n",
       "11103  1일 총 섭취량:2스푼 제품용량:100일분 섭취횟수:하루 두 번 섭취방법:바로 음용...         15.0   \n",
       "13408  주요 기능성(식약처인증):영양보충 영양소 원료명(식약처고시):비타민D 영양소 원료명...         75.0   \n",
       "13407  제품타입:액상 섭취방법:바로 음용 섭취대상:성인남녀 섭취횟수:수시로 제품유형:일반식...          8.0   \n",
       "13406  주요 기능성(식약처인증):영양보충 영양소 원료명(식약처고시):비타민D 영양소 원료명...         55.0   \n",
       "\n",
       "       consecutive_repeats                                       cleaned_제품특성  \\\n",
       "11376                  0.0  HCA:750mg 영양소 원료명 식약처고시 :해당 없음 1일 총 섭취량:2포 제품용...   \n",
       "4955                   0.0  생균:20억 CFU 1일 총 섭취량:1캡슐 제품용량:1개월분 제품타입:캡슐 섭취횟수...   \n",
       "4954                   0.0  1일 총 섭취량:1캡슐 제품타입:캡슐 섭취횟수:하루 한 번 섭취방법:물과 함께 주요...   \n",
       "4953                   0.0  생균:10억 CFU 1일 총 섭취량:1포 제품용량:2개월분 제품타입:분말 섭취횟수:...   \n",
       "4952                   0.0  아연:10mg 영양소 원료명 식약처고시 :아연 섭취대상:유아 청소년 제품용량:1개월...   \n",
       "4951                   0.0  생균:1억 CFU 제품용량:1개월분 제품타입:액상 섭취횟수:하루 한 번 섭취대상:유...   \n",
       "7353                   0.0  영양소 원료명 식약처고시 DHA EPA제품타입섭취대상제품용량1일 총 섭취량섭취횟수섭...   \n",
       "7351                   0.0  제품타입:분말 섭취방법:바로 음용 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 ...   \n",
       "7350                   0.0  제품타입:분말 섭취방법:물에 섞어서 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총...   \n",
       "7349                   0.0               제품유형:일반식품 섭취대상:성인남녀 제품타입:분말 :1개 102g   \n",
       "4950                   0.0  생균:1억 CFU 1일 총 섭취량:6방울 제품용량:1개월분 제품타입:액상 섭취횟수:...   \n",
       "4949                   0.0  주요 기능성 식약처인증 :영양보충 영양소 원료명 식약처고시 :비타민D 영양소 원료명...   \n",
       "4948                   0.0  주요 기능성 식약처인증 :영양보충 영양소 원료명 식약처고시 :비타민A 영양소 원료명...   \n",
       "4947                   0.0  비타민D:10 g 섭취대상:유아 청소년 1일 총 섭취량:1방울 제품용량:개인별 다름...   \n",
       "11126                  0.0  HCA:750mg 1일 총 섭취량:2포 제품용량:1개월분 제품타입:분말 섭취횟수:하...   \n",
       "11125                  0.0  HCA:850mg 영양소 원료명 식약처고시 :식이섬유 1일 총 섭취량:2포 제품용량...   \n",
       "11124                  0.0  제품유형:일반식품 영양소 원료명 식약처고시 :비타민C 콜라겐 펩타이드:1000mg ...   \n",
       "11123                  0.0  HCA:750mg 1일 총 섭취량:2포 제품용량:1개월분 제품타입:분말 섭취횟수:하...   \n",
       "10189                  0.0  주요 기능성 식약처인증 :혈행개선 DHA EPA:526mg 제품타입:캡슐 섭취대상:...   \n",
       "4930                   0.0  세트종류:4종 메뉴종류:곤약밥 메뉴종류:잡곡밥 메뉴종류:볶음밥 포장형태:용기형 보관...   \n",
       "13494                  0.0  종류:웨이 단백질종류:동물성 식물성 단백질성분:농축유청단백질 WPC 단백질성분:분리...   \n",
       "13496                  0.0  종류:웨이 단백질종류:동물성 식물성 단백질성분:농축유청단백질 WPC 단백질성분:분리...   \n",
       "13534                  0.0  종류 A섭취대상:아르기닌 섭취방법:성인남녀 1일 총 섭취량:바로 음용 섭취횟수:1포...   \n",
       "13533                  0.0  주요 기능성 식약처인증 :장건강 영양소 원료명 식약처고시 :식이섬유 제품타입:분말 ...   \n",
       "4958                   0.0  최소연령:신생아 단계별:1단계 종류:일반분유 제품형태:분말 포장형태:캔 용량:800...   \n",
       "4957                   0.0  총 플라보노이드:17mg 1일 총 섭취량:2캡슐 제품용량:10개월분 제품타입:캡슐 ...   \n",
       "13519                  0.0  영양소 원료명 식약처고시 A단백질종류:아연 단백질:동물성 식물성 맛:12g 섭취대상...   \n",
       "10180                  0.0  제품타입:캡슐 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 두 번 1일 총 ...   \n",
       "10182                  0.0  생균:50억 CFU 1일 총 섭취량:9정 제품용량:2개월분 제품타입:캡슐 섭취횟수:...   \n",
       "10184                  0.0  생균:50억 CFU 1일 총 섭취량:1캡슐 제품용량:4개월분 제품타입:베지캡슐 섭취...   \n",
       "10185                  0.0  제품타입:베지캡슐 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 세 번 1일 ...   \n",
       "13510                  0.0  중량포장형태:400g 포장형태제품용량섭취횟수1일 총 섭취량섭취방법:파우치형 포장형태...   \n",
       "13509                  0.0                         제품타입:환 섭취방법:물과 함께 :1개 100g   \n",
       "13508                  0.0  제품유형:일반식품 종류:어류 분자량:1980 섭취대상:성인남녀 제품타입:구미 젤리 ...   \n",
       "13504                  0.0  제품타입:구미 젤리 섭취방법:씹어서 섭취대상:유아 청소년 섭취횟수:하루 두 번 1일...   \n",
       "10186                  0.0  주요 기능성 식약처인증 :영양보충 영양소 원료명 식약처고시 :비타민D 영양소 원료명...   \n",
       "13500                  0.0  주요 기능성 식약처인증 :해당 없음 영양소 원료명 식약처고시 :단백질 단백질종류:동...   \n",
       "10187                  0.0  주요 기능성 식약처인증 :영양보충 영양소 원료명 식약처고시 :비타민D 영양소 원료명...   \n",
       "10188                  0.0  제품타입:액상 섭취방법:물에 섞어서 섭취대상:임산부 섭취횟수:하루 한 번 1일 총 ...   \n",
       "13495                  0.0  종류:웨이 단백질종류:동물성 식물성 단백질성분:농축유청단백질 WPC 단백질성분:분리...   \n",
       "4929                   0.0  제품타입:캡슐 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 ...   \n",
       "4928                   0.0  제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 섭...   \n",
       "13462                  0.0  제품타입:정 섭취방법:물과 함께 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 섭...   \n",
       "11104                  1.0  홍삼농축액 함량:15 5 1일 총 섭취량:6스푼 제품용량:3개월분 섭취횟수:하루 세...   \n",
       "13415                  0.0                       섭취대상:유아 청소년 :1개 700mg x 120정   \n",
       "13411                  0.0  생균:100억 CFU 1일 총 섭취량:1포 제품용량:2개월분 제품타입:분말 섭취횟수...   \n",
       "11103                  0.0  1일 총 섭취량:2스푼 제품용량:100일분 섭취횟수:하루 두 번 섭취방법:바로 음용...   \n",
       "13408                  2.0  주요 기능성 식약처인증 :영양보충 영양소 원료명 식약처고시 :비타민D 영양소 원료명...   \n",
       "13407                  0.0  제품타입:액상 섭취방법:바로 음용 섭취대상:성인남녀 섭취횟수:수시로 제품유형:일반식...   \n",
       "13406                  2.0  주요 기능성 식약처인증 :영양보충 영양소 원료명 식약처고시 :비타민D 영양소 원료명...   \n",
       "\n",
       "                                             parsed_제품특성  \\\n",
       "11376  {'HCA': '750mg', '영양소 원료명 식약처고시': '비타민B1', '없음...   \n",
       "4955   {'생균': '20억', 'CFU 1일 총 섭취량': '1캡슐', '제품용량': '...   \n",
       "4954   {'1일 총 섭취량': '1캡슐', '제품타입': '캡슐', '섭취횟수': '하루'...   \n",
       "4953   {'생균': '10억', 'CFU 1일 총 섭취량': '1포', '제품용량': '2...   \n",
       "4952   {'아연': '10mg', '영양소 원료명 식약처고시': '아연', '섭취대상': ...   \n",
       "4951   {'생균': '1억', 'CFU 제품용량': '1개월분', '제품타입': '액상',...   \n",
       "7353   {'영양소 원료명 식약처고시 DHA EPA제품타입섭취대상제품용량1일 총 섭취량섭취횟...   \n",
       "7351   {'제품타입': '분말', '섭취방법': '바로', '음용 섭취대상': '성인남녀'...   \n",
       "7350   {'제품타입': '분말', '섭취방법': '물에', '섞어서 섭취대상': '성인남녀...   \n",
       "7349   {'제품유형': '일반식품', '섭취대상': '성인남녀', '분말': '1개 102g'}   \n",
       "4950   {'생균': '1억', 'CFU 1일 총 섭취량': '6방울', '제품용량': '1...   \n",
       "4949   {'주요 기능성 식약처인증': '영양보충', '영양소 원료명 식약처고시': '망간'...   \n",
       "4948   {'주요 기능성 식약처인증': '영양보충', '영양소 원료명 식약처고시': '망간'...   \n",
       "4947   {'비타민D': '1개 400IU 6ml', 'g 섭취대상': '유아', '청소년 ...   \n",
       "11126  {'HCA': '750mg', '1일 총 섭취량': '2포', '제품용량': '1개...   \n",
       "11125  {'HCA': '850mg', '영양소 원료명 식약처고시': '식이섬유', '1일 ...   \n",
       "11124  {'제품유형': '일반식품', '영양소 원료명 식약처고시': '비타민C', '콜라겐...   \n",
       "11123  {'HCA': '850mg', '1일 총 섭취량': '2포', '제품용량': '2개...   \n",
       "10189  {'주요 기능성 식약처인증': '혈행개선', 'DHA EPA': '526mg', '...   \n",
       "4930   {'세트종류': '4종', '메뉴종류': '볶음밥', '포장형태': '용기형', '...   \n",
       "13494  {'종류': '웨이', '단백질종류': '동물성', '식물성 단백질성분': '농축유...   \n",
       "13496  {'종류': '게이너', '단백질종류': '동물성', '식물성 단백질성분': '농축...   \n",
       "13534  {'종류 A섭취대상': '아르기닌', '섭취방법': '성인남녀', '1일 총 섭취량...   \n",
       "13533  {'주요 기능성 식약처인증': '장건강', '영양소 원료명 식약처고시': '식이섬유...   \n",
       "4958   {'최소연령': '4개월', '단계별': '2단계', '종류': '일반분유', '제...   \n",
       "4957   {'총 플라보노이드': '17mg', '1일 총 섭취량': '2캡슐', '제품용량'...   \n",
       "13519  {'영양소 원료명 식약처고시 A단백질종류': '아연', '단백질': '동물성', '...   \n",
       "10180  {'제품타입': '베지캡슐', '섭취방법': '물과', '함께 섭취대상': '성인남...   \n",
       "10182  {'생균': '50억', 'CFU 1일 총 섭취량': '9정', '제품용량': '2...   \n",
       "10184  {'생균': '50억', 'CFU 1일 총 섭취량': '1캡슐', '제품용량': '...   \n",
       "10185  {'제품타입': '정', '섭취방법': '물과', '함께 섭취대상': '성인남녀',...   \n",
       "13510  {'중량포장형태': '400g', '포장형태제품용량섭취횟수1일 총 섭취량섭취방법':...   \n",
       "13509       {'제품타입': '환', '섭취방법': '물과', '함께': '1개 100g'}   \n",
       "13508  {'제품유형': '일반식품', '종류': '어류', '분자량': '1980', '섭...   \n",
       "13504  {'제품타입': '구미', '젤리 섭취방법': '씹어서', '섭취대상': '유아',...   \n",
       "10186  {'주요 기능성 식약처인증': '영양보충', '영양소 원료명 식약처고시': '셀레늄...   \n",
       "13500  {'주요 기능성 식약처인증': '해당', '없음 영양소 원료명 식약처고시': '단백...   \n",
       "10187  {'주요 기능성 식약처인증': '영양보충', '영양소 원료명 식약처고시': '셀레늄...   \n",
       "10188  {'제품타입': '액상', '섭취방법': '물에', '섞어서 섭취대상': '임산부'...   \n",
       "13495  {'종류': '웨이', '단백질종류': '동물성', '식물성 단백질성분': '농축유...   \n",
       "4929   {'제품타입': '캡슐', '섭취방법': '물과', '함께 섭취대상': '성인남녀'...   \n",
       "4928   {'제품타입': '정', '섭취방법': '물과', '함께 섭취대상': '성인남녀',...   \n",
       "13462  {'제품타입': '정', '섭취방법': '물과', '함께 섭취대상': '성인남녀',...   \n",
       "11104  {'홍삼농축액 함량': '15', '5 1일 총 섭취량': '6스푼', '제품용량'...   \n",
       "13415           {'섭취대상': '유아', '청소년': '1개 700mg x 120정'}   \n",
       "13411  {'생균': '100억', 'CFU 1일 총 섭취량': '1포', '제품용량': '...   \n",
       "11103  {'1일 총 섭취량': '2스푼', '제품용량': '100일분', '섭취횟수': '...   \n",
       "13408  {'주요 기능성 식약처인증': '영양보충', '영양소 원료명 식약처고시': '아연'...   \n",
       "13407  {'제품타입': '액상', '섭취방법': '바로', '음용 섭취대상': '성인남녀'...   \n",
       "13406  {'주요 기능성 식약처인증': '영양보충', '영양소 원료명 식약처고시': '아연'...   \n",
       "\n",
       "                                           combined_제품특성  \\\n",
       "11376  750mg 비타민B1 1포 15일분 분말 하루 물에 성인남녀 체지방 감소 3 5g ...   \n",
       "4955          20억 1캡슐 1개월분 캡슐 하루 물과 성인여성 1개 180mg x 30캡슐   \n",
       "4954                   1캡슐 캡슐 하루 물과 영양보충 1개 1000IU 100캡슐   \n",
       "4953             10억 1포 2개월분 분말 하루 물에 유아 장건강 1 9g x 60개입   \n",
       "4952                   10mg 아연 유아 1개월분 액상 하루 물에 1개 120ml   \n",
       "4951                            1억 1개월분 액상 하루 유아 장건강 8ml   \n",
       "7353   비타민E 혈행개선 혈행개선 비타민E 600mg 동물성 캡슐 성인남녀 6개월분 1캡슐...   \n",
       "7351                 분말 바로 성인남녀 하루 1포 1개월분 비타민C 3g x 30포   \n",
       "7350                   분말 물에 성인남녀 하루 1포 1개월분 1개 3g x 30포   \n",
       "7349                                   일반식품 성인남녀 1개 102g   \n",
       "4950                  1억 6방울 1개월분 액상 하루 바로 유아 장건강 1개 8ml   \n",
       "4949   영양보충 망간 요오드 15개 110mg 15 15mg 임산부 캡슐 2개월분 2캡슐 ...   \n",
       "4948   영양보충 망간 8개 227 151mg 10 3mg 유아 츄어블 50일분 2정 하루 ...   \n",
       "4947    1개 400IU 6ml 유아 1방울 개인별 액상 하루 바로 비타민D 1개 액상 영양보충   \n",
       "11126    750mg 2포 1개월분 분말 하루 물에 성인남녀 체지방 1개 1500mg x 60포   \n",
       "11125  850mg 식이섬유 2포 15일분 분말 하루 물과 성인남녀 체지방 1개 5g x 3...   \n",
       "11124  일반식품 비타민C 1000mg 어류 500Da 성인남녀 분말 15일분 하루 1포 바...   \n",
       "11123  850mg 2포 2개월분 정 하루 물과 성인남녀 콜레스테롤 1개 해당 성인남녀 물과...   \n",
       "10189  혈행개선 526mg 캡슐 성인남녀 2개월분 3캡슐 하루 물과 1개 440mg x 9...   \n",
       "4930         4종 볶음밥 용기형 1개 200g 8종 x 4팩 볶음밥 200g 300kcal   \n",
       "13494  웨이 동물성 농축유청단백질 분리유청단백질 분리대두단백질 33g 성인남녀 초코 물에 ...   \n",
       "13496  게이너 동물성 농축유청단백질 분리유청단백질 분리대두단백질 29g 성인남녀 초코 물에...   \n",
       "13534             아르기닌 성인남녀 바로 1포 하루 15일분 6500 20g x 15포   \n",
       "13533              장건강 식이섬유 분말 물에 성인남녀 하루 2포 14일분 1개 28포   \n",
       "4958   4개월 2단계 일반분유 분말 스틱 280g 2020년도 프로바이오틱스 미숙아 소화촉...   \n",
       "4957   17mg 2캡슐 10개월분 캡슐 하루 물과 성인남녀 항산화 1개 1개 500mg 6...   \n",
       "13519                      아연 동물성 12g 우유 바로 음용 365 250ml   \n",
       "10180  베지캡슐 물과 성인남녀 하루 2캡슐 1개 2캡슐 2개월분 1개 1000mg x 12...   \n",
       "10182          50억 9정 2개월분 캡슐 하루 물과 성인여성 1개 10억 유산균 60캡슐   \n",
       "10184    50억 1캡슐 4개월분 베지캡슐 하루 물과 성인남녀 1개 50억 유산균 120베지캡슐   \n",
       "10185   정 물과 성인남녀 하루 3정 1개 1000mg x 200캡슐 성인남녀 1정 1개 개인별   \n",
       "13510                      400g 용기형 4000 4 2g x 30포 3개월분   \n",
       "13509                                       환 물과 1개 100g   \n",
       "13508      일반식품 어류 1980 성인남녀 구미 1개월분 하루 1포 1개 20g x 30개입   \n",
       "13504      구미 씹어서 유아 하루 2포 7일분 성장발육 단백질 1개 042 25g x 14포   \n",
       "10186  영양보충 셀레늄 망간 12개 110mg 25 15mg 임산부 정 2개월분 2정 하루...   \n",
       "13500  해당 단백질 동물성 분리유청단백질 분리대두단백질 산양유단백질 19g 성인남녀 물에 ...   \n",
       "10187  영양보충 셀레늄 망간 12개 110mg 25 15mg 임산부 정 2개월분 2정 하루...   \n",
       "10188          액상 물에 임산부 하루 1포 2개월분 영양보충 철 1개 10ml x 60포   \n",
       "13495  웨이 동물성 농축유청단백질 분리유청단백질 분리대두단백질 37g 성인남녀 초코 물에 ...   \n",
       "4929   캡슐 물과 성인남녀 하루 1캡슐 1개월분 항산화 비타민E 1개 10 500mg x ...   \n",
       "4928   정 물과 성인남녀 하루 1정 2개월분 영양보충 엽산 800 g 400 450mg x...   \n",
       "13462        정 물과 성인남녀 하루 2정 1개월분 위건강 셀레늄 1개 500mg x 60정   \n",
       "11104  15 6스푼 100일분 하루 물에 성인남녀 건강기능식품 면역력 해당 1개 60 4m...   \n",
       "13415                                 유아 1개 700mg x 120정   \n",
       "13411      100억 1포 2개월분 분말 하루 바로 성인남녀 장건강 해당 1개 2g x 60포   \n",
       "11103                 2스푼 100일분 하루 바로 성인남녀 1개 250g x 4개입   \n",
       "13408       영양보충 아연 5 7mg 유아 구미 15일분 1포 하루 1개 3종 선물세트 구미   \n",
       "13407                             액상 바로 성인남녀 수시로 1개 30ml   \n",
       "13406        영양보충 아연 5 7mg 유아 구미 15일분 1포 하루 1개 15g x 15포   \n",
       "\n",
       "                                          tokenized_제품특성  \\\n",
       "11376                   비타민 포 분말 하루 물 성인 남녀 체지방 감소 포 물 포   \n",
       "4955                            캡슐 개월 캡슐 하루 물 성인 여성 개 캡슐   \n",
       "4954                               캡슐 캡슐 하루 물 영양 보충 개 캡슐   \n",
       "4953                             포 개월 분말 하루 물 유아 장 건강 개입   \n",
       "4952                                   아연 유아 개월 액 하루 물 개   \n",
       "4951                                     개월 액 하루 유아 장 건강   \n",
       "7353   비타민 혈행 개선 혈행 개선 비타민 동물성 캡슐 성인 남녀 개월 캡슐 하루 물 개 ...   \n",
       "7351                           분말 바로 성인 남녀 하루 포 개월 비타민 포   \n",
       "7350                              분말 물 성인 남녀 하루 포 개월 개 포   \n",
       "7349                                       일반 식품 성인 남녀 개   \n",
       "4950                             방울 개월 액 하루 바로 유아 장 건강 개   \n",
       "4949                영양 보충 망간 요오드 개 임산부 캡슐 개월 캡슐 하루 물 개 정   \n",
       "4948                          영양 보충 망간 개 유아 츄어블 정 하루 개 정   \n",
       "4947                  개 유아 방울 개인 별 액 하루 바로 비타민 개 액 영양 보충   \n",
       "11126                         포 개월 분말 하루 물 성인 남녀 체지방 개 포   \n",
       "11125                식이섬유 포 분말 하루 물 성인 남녀 체지방 개 포 라인 핏 포   \n",
       "11124                  일반 식품 비타민 어류 성인 남녀 분말 하루 포 바로 개 포   \n",
       "11123  포 개월 정 하루 물 성인 남녀 콜레스테롤 개 해당 성인 남녀 물 정 개 일반 식품...   \n",
       "10189                 혈행 개선 캡슐 성인 남녀 개월 캡슐 하루 물 개 캡슐 식물성   \n",
       "4930                                  종 볶음밥 용기 개 종 팩 볶음밥   \n",
       "13494  웨이 동물성 농축 유청 단백질 분리 유청 단백질 분리 단백질 성인 남녀 초코 물 스...   \n",
       "13496  게이 너 동물성 농축 유청 단백질 분리 유청 단백질 분리 단백질 성인 남녀 초코 물...   \n",
       "13534                               아르기닌 성인 남녀 바로 포 하루 포   \n",
       "13533                      장 건강 식이섬유 분말 물 성인 남녀 하루 포 개 포   \n",
       "4958   개월 단계 일반 분유 분말 스틱 프로바이오틱스 미숙아 소화 촉진 단계 신생아 개 개...   \n",
       "4957                      캡슐 개월 캡슐 하루 물 성인 남녀 항산화 개 개 캡슐   \n",
       "13519                                    아연 동물성 우유 바로 음용   \n",
       "10180                      캡슐 물 성인 남녀 하루 캡슐 개 캡슐 개월 개 캡슐   \n",
       "10182                        정 개월 캡슐 하루 물 성인 여성 개 유산균 캡슐   \n",
       "10184                       캡슐 개월 캡슐 하루 물 성인 남녀 개 유산균 캡슐   \n",
       "10185                 정 물 성인 남녀 하루 정 개 캡슐 성인 남녀 정 개 개인 별   \n",
       "13510                                            용기 포 개월   \n",
       "13509                                              환 물 개   \n",
       "13508                     일반 식품 어류 성인 남녀 구미 개월 하루 포 개 개입   \n",
       "13504                           구미 유아 하루 포 성장 발육 단백질 개 포   \n",
       "10186                 영양 보충 셀레늄 망간 개 임산부 정 개월 정 하루 물 개 정   \n",
       "13500  해당 단백질 동물성 분리 유청 단백질 분리 단백질 산양 유 단백질 성인 남녀 물 스...   \n",
       "10187                 영양 보충 셀레늄 망간 개 임산부 정 개월 정 하루 물 개 정   \n",
       "10188                        액 물 임산부 하루 포 개월 영양 보충 철 개 포   \n",
       "13495  웨이 동물성 농축 유청 단백질 분리 유청 단백질 분리 단백질 성인 남녀 초코 물 개...   \n",
       "4929                    캡슐 물 성인 남녀 하루 캡슐 개월 항산화 비타민 개 캡슐   \n",
       "4928    정 물 성인 남녀 하루 정 개월 영양 보충 엽산 정 개 요오드 개 성인 남성 정 물 개   \n",
       "13462                     정 물 성인 남녀 하루 정 개월 위 건강 셀레늄 개 정   \n",
       "11104  스푼 하루 물 성인 남녀 건강 기능 식품 면역 해당 개 뚜껑 스푼 농축액 개 성인 ...   \n",
       "13415                                             유아 개 정   \n",
       "13411                    포 개월 분말 하루 바로 성인 남녀 장 건강 해당 개 포   \n",
       "11103                                스푼 하루 바로 성인 남녀 개 개입   \n",
       "13408                   영양 보충 아연 유아 구미 포 하루 개 종 선물 세트 구미   \n",
       "13407                                       액 바로 성인 남녀 개   \n",
       "13406                            영양 보충 아연 유아 구미 포 하루 개 포   \n",
       "\n",
       "                                  tokenized_제품특성_cleaned  \n",
       "11376                             비타민 분말 하루 성인 남녀 체지방 감소  \n",
       "4955                                캡슐 개월 캡슐 하루 성인 여성 캡슐  \n",
       "4954                                   캡슐 캡슐 하루 영양 보충 캡슐  \n",
       "4953                                   개월 분말 하루 유아 건강 개입  \n",
       "4952                                         아연 유아 개월 하루  \n",
       "4951                                         개월 하루 유아 건강  \n",
       "7353   비타민 혈행 개선 혈행 개선 비타민 동물성 캡슐 성인 남녀 개월 캡슐 하루 플러스 ...  \n",
       "7351                               분말 바로 성인 남녀 하루 개월 비타민  \n",
       "7350                                      분말 성인 남녀 하루 개월  \n",
       "7349                                         일반 식품 성인 남녀  \n",
       "4950                                   방울 개월 하루 바로 유아 건강  \n",
       "4949                        영양 보충 망간 요오드 임산부 캡슐 개월 캡슐 하루  \n",
       "4948                                  영양 보충 망간 유아 츄어블 하루  \n",
       "4947                            유아 방울 개인 하루 바로 비타민 영양 보충  \n",
       "11126                                 개월 분말 하루 성인 남녀 체지방  \n",
       "11125                            식이섬유 분말 하루 성인 남녀 체지방 라인  \n",
       "11124                        일반 식품 비타민 어류 성인 남녀 분말 하루 바로  \n",
       "11123          개월 하루 성인 남녀 콜레스테롤 해당 성인 남녀 일반 식품 어류 성인 남녀  \n",
       "10189                     혈행 개선 캡슐 성인 남녀 개월 캡슐 하루 캡슐 식물성  \n",
       "4930                                          볶음밥 용기 볶음밥  \n",
       "13494  웨이 동물성 농축 유청 단백질 분리 유청 단백질 분리 단백질 성인 남녀 초코 스푼 ...  \n",
       "13496  게이 동물성 농축 유청 단백질 분리 유청 단백질 분리 단백질 성인 남녀 초코 스푼 ...  \n",
       "13534                                   아르기닌 성인 남녀 바로 하루  \n",
       "13533                                건강 식이섬유 분말 성인 남녀 하루  \n",
       "4958    개월 단계 일반 분유 분말 스틱 프로바이오틱스 미숙아 소화 촉진 단계 신생아 소화 촉진  \n",
       "4957                            캡슐 개월 캡슐 하루 성인 남녀 항산화 캡슐  \n",
       "13519                                    아연 동물성 우유 바로 음용  \n",
       "10180                            캡슐 성인 남녀 하루 캡슐 캡슐 개월 캡슐  \n",
       "10182                              개월 캡슐 하루 성인 여성 유산균 캡슐  \n",
       "10184                           캡슐 개월 캡슐 하루 성인 남녀 유산균 캡슐  \n",
       "10185                               성인 남녀 하루 캡슐 성인 남녀 개인  \n",
       "13510                                              용기 개월  \n",
       "13509                                                     \n",
       "13508                         일반 식품 어류 성인 남녀 구미 개월 하루 개입  \n",
       "13504                                 구미 유아 하루 성장 발육 단백질  \n",
       "10186                             영양 보충 셀레늄 망간 임산부 개월 하루  \n",
       "13500     해당 단백질 동물성 분리 유청 단백질 분리 단백질 산양 단백질 성인 남녀 스푼 하루  \n",
       "10187                             영양 보충 셀레늄 망간 임산부 개월 하루  \n",
       "10188                                    임산부 하루 개월 영양 보충  \n",
       "13495  웨이 동물성 농축 유청 단백질 분리 유청 단백질 분리 단백질 성인 남녀 초코 개인 ...  \n",
       "4929                        캡슐 성인 남녀 하루 캡슐 개월 항산화 비타민 캡슐  \n",
       "4928                      성인 남녀 하루 개월 영양 보충 엽산 요오드 성인 남성  \n",
       "13462                                 성인 남녀 하루 개월 건강 셀레늄  \n",
       "11104  스푼 하루 성인 남녀 건강 기능 식품 면역 해당 뚜껑 스푼 농축액 성인 남녀 건강 ...  \n",
       "13415                                                 유아  \n",
       "13411                            개월 분말 하루 바로 성인 남녀 건강 해당  \n",
       "11103                                  스푼 하루 바로 성인 남녀 개입  \n",
       "13408                         영양 보충 아연 유아 구미 하루 선물 세트 구미  \n",
       "13407                                           바로 성인 남녀  \n",
       "13406                                  영양 보충 아연 유아 구미 하루  \n",
       "\n",
       "[50 rows x 473 columns]"
      ]
     },
     "execution_count": 66,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merged_data_nonan.sort_values(by='대분류').head(50)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "id": "197096c9",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "대분류\n",
       "B002-C001-0002    7158\n",
       "B002-C001-0001    2642\n",
       "B002-C001-0005     448\n",
       "B002-C001-0003     144\n",
       "B002-C001-0004      89\n",
       "Name: count, dtype: int64"
      ]
     },
     "execution_count": 64,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merged_data_nonan['대분류'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 62,
   "id": "9939c976",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>제품</th>\n",
       "      <th>대분류</th>\n",
       "      <th>중분류</th>\n",
       "      <th>소분류</th>\n",
       "      <th>브랜드</th>\n",
       "      <th>2022-01-01</th>\n",
       "      <th>2022-01-02</th>\n",
       "      <th>2022-01-03</th>\n",
       "      <th>2022-01-04</th>\n",
       "      <th>...</th>\n",
       "      <th>2023-04-03</th>\n",
       "      <th>2023-04-04</th>\n",
       "      <th>제품특성</th>\n",
       "      <th>desc_length</th>\n",
       "      <th>consecutive_repeats</th>\n",
       "      <th>cleaned_제품특성</th>\n",
       "      <th>parsed_제품특성</th>\n",
       "      <th>combined_제품특성</th>\n",
       "      <th>tokenized_제품특성</th>\n",
       "      <th>tokenized_제품특성_cleaned</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>12</td>\n",
       "      <td>B002-00003-00009</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-00003</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>생균:100억 CFU 1일 총 섭취량:1캡슐 제품용량:1개월분 제품타입:캡슐 섭취횟...</td>\n",
       "      <td>19.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>생균:100억 CFU 1일 총 섭취량:1캡슐 제품용량:1개월분 제품타입:캡슐 섭취횟...</td>\n",
       "      <td>{'생균': '100억', 'CFU 1일 총 섭취량': '1캡슐', '제품용량': ...</td>\n",
       "      <td>100억 1캡슐 1개월분 캡슐 하루 물과 성인남녀 체지방 감소 480mg x 30캡슐</td>\n",
       "      <td>캡슐 개월 캡슐 하루 물 성인 남녀 체지방 감소 캡슐</td>\n",
       "      <td>캡슐 개월 캡슐 하루 성인 남녀 체지방 감소 캡슐</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>30</td>\n",
       "      <td>B002-00008-00001</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0001</td>\n",
       "      <td>B002-00008</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>4</td>\n",
       "      <td>...</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>주요 기능성(식약처인증):장건강 영양소 원료명(식약처고시):식이섬유 제품타입:구미/...</td>\n",
       "      <td>19.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>주요 기능성 식약처인증 :장건강 영양소 원료명 식약처고시 :식이섬유 제품타입:구미 ...</td>\n",
       "      <td>{'주요 기능성 식약처인증': '장건강', '영양소 원료명 식약처고시': '식이섬유...</td>\n",
       "      <td>장건강 식이섬유 구미 씹어서 성인남녀 하루 1포 14일분 1개 20g x 14포</td>\n",
       "      <td>장 건강 식이섬유 구미 성인 남녀 하루 포 개 포</td>\n",
       "      <td>건강 식이섬유 구미 성인 남녀 하루</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>31</th>\n",
       "      <td>31</td>\n",
       "      <td>B002-00009-00001</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0004</td>\n",
       "      <td>B002-00009</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>단백질종류:동물성+식물성 단백질성분:농축유청단백질(WPC) 단백질성분:분리대두단백질...</td>\n",
       "      <td>18.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>단백질종류:동물성 식물성 단백질성분:농축유청단백질 WPC 단백질성분:분리대두단백질 ...</td>\n",
       "      <td>{'단백질종류': '동물성', '식물성 단백질성분': '농축유청단백질', 'WPC ...</td>\n",
       "      <td>동물성 농축유청단백질 분리대두단백질 산양유단백질 26g 성인남녀 우유 물에 1스푼 ...</td>\n",
       "      <td>동물성 농축 유청 단백질 분리 단백질 산양 유 단백질 성인 남녀 우유 물 스푼 하루 개</td>\n",
       "      <td>동물성 농축 유청 단백질 분리 단백질 산양 단백질 성인 남녀 우유 스푼 하루</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>33</th>\n",
       "      <td>33</td>\n",
       "      <td>B002-00011-00001</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0005</td>\n",
       "      <td>B002-00011</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>홍삼농축액 함량:2.5% 고형분 함량:60% 포장형태:스틱형 1일 총 섭취량:1포 ...</td>\n",
       "      <td>22.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>홍삼농축액 함량:2 5 고형분 함량:60 포장형태:스틱형 1일 총 섭취량:1포 제품...</td>\n",
       "      <td>{'홍삼농축액 함량': '2', '5 고형분 함량': '60', '포장형태': '스...</td>\n",
       "      <td>2 60 스틱형 1포 1개월분 하루 바로 유아 농축액 1개 20ml x 10개입</td>\n",
       "      <td>스틱 포 개월 하루 바로 유아 농축액 개 개입</td>\n",
       "      <td>스틱 개월 하루 바로 유아 농축액 개입</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>37</th>\n",
       "      <td>37</td>\n",
       "      <td>B002-00015-00001</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0005</td>\n",
       "      <td>B002-00015</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>홍삼농축액 함량:0% 고형분 함량:87% 1일 총 섭취량:1포 제품용량:개인별 다름...</td>\n",
       "      <td>83.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>홍삼농축액 함량:0 고형분 함량:87 1일 총 섭취량:1포 제품용량:개인별 다름 섭...</td>\n",
       "      <td>{'홍삼농축액 함량': '0', '고형분 함량': '87', '1일 총 섭취량': ...</td>\n",
       "      <td>0 87 3스푼 80일분 하루 씹어서 1개 씹어서 하루 물에 성인남녀 농축액 건강기...</td>\n",
       "      <td>스푼 하루 개 하루 물 성인 남녀 농축액 건강 기능 식품 면역 해당 개 농축액 해당...</td>\n",
       "      <td>스푼 하루 하루 성인 남녀 농축액 건강 기능 식품 면역 해당 농축액 해당 개인</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15826</th>\n",
       "      <td>15826</td>\n",
       "      <td>B002-03796-00008</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0004</td>\n",
       "      <td>B002-03796</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>주요 기능성(식약처인증):해당 없음 영양소 원료명(식약처고시):해당 없음 섭취대상:...</td>\n",
       "      <td>35.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>주요 기능성 식약처인증 :해당 없음 영양소 원료명 식약처고시 :해당 없음 섭취대상:...</td>\n",
       "      <td>{'주요 기능성 식약처인증': '해당', '없음 영양소 원료명 식약처고시': '해당...</td>\n",
       "      <td>해당 해당 성인남녀 물에 2스푼 하루 1개 동물성 분리유청단백질 분리대두단백질 산양...</td>\n",
       "      <td>해당 해당 성인 남녀 물 스푼 하루 개 동물성 분리 유청 단백질 분리 단백질 산양 ...</td>\n",
       "      <td>해당 해당 성인 남녀 스푼 하루 동물성 분리 유청 단백질 분리 단백질 산양 단백질 ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15827</th>\n",
       "      <td>15827</td>\n",
       "      <td>B002-03796-00009</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-03796</td>\n",
       "      <td>23</td>\n",
       "      <td>23</td>\n",
       "      <td>26</td>\n",
       "      <td>44</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>생균:10억 CFU 1일 총 섭취량:1포 제품용량:1개월분 제품타입:분말 섭취횟수:...</td>\n",
       "      <td>23.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>생균:10억 CFU 1일 총 섭취량:1포 제품용량:1개월분 제품타입:분말 섭취횟수:...</td>\n",
       "      <td>{'생균': '10억', 'CFU 1일 총 섭취량': '1포', '제품용량': '1...</td>\n",
       "      <td>10억 1포 1개월분 분말 하루 바로 성인남녀 장건강 셀레늄 1개 2 5g x 30포</td>\n",
       "      <td>포 개월 분말 하루 바로 성인 남녀 장 건강 셀레늄 개 포</td>\n",
       "      <td>개월 분말 하루 바로 성인 남녀 건강 셀레늄</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15828</th>\n",
       "      <td>15828</td>\n",
       "      <td>B002-03796-00010</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-03796</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>제품타입:분말 섭취방법:바로 음용 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 ...</td>\n",
       "      <td>16.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>제품타입:분말 섭취방법:바로 음용 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 ...</td>\n",
       "      <td>{'제품타입': '분말', '섭취방법': '바로', '음용 섭취대상': '성인남녀'...</td>\n",
       "      <td>분말 바로 성인남녀 하루 1포 1개월분 1개 2 8g x 30포</td>\n",
       "      <td>분말 바로 성인 남녀 하루 포 개월 개 포</td>\n",
       "      <td>분말 바로 성인 남녀 하루 개월</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15829</th>\n",
       "      <td>15829</td>\n",
       "      <td>B002-03796-00011</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0001</td>\n",
       "      <td>B002-03796</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>제품유형:일반식품 종류:어류 분자량:600Da 섭취대상:성인남녀 제품타입:구미/젤리...</td>\n",
       "      <td>17.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>제품유형:일반식품 종류:어류 분자량:600Da 섭취대상:성인남녀 제품타입:구미 젤리...</td>\n",
       "      <td>{'제품유형': '일반식품', '종류': '어류', '분자량': '600Da', '...</td>\n",
       "      <td>일반식품 어류 600Da 성인남녀 구미 14일분 하루 1포 2개 20g x 15포</td>\n",
       "      <td>일반 식품 어류 성인 남녀 구미 하루 포 개 포</td>\n",
       "      <td>일반 식품 어류 성인 남녀 구미 하루</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15830</th>\n",
       "      <td>15830</td>\n",
       "      <td>B002-03796-00012</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0001</td>\n",
       "      <td>B002-03796</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>제품유형:일반식품 종류:어류 분자량:300Da 섭취대상:성인남녀 제품타입:구미/젤리...</td>\n",
       "      <td>17.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>제품유형:일반식품 종류:어류 분자량:300Da 섭취대상:성인남녀 제품타입:구미 젤리...</td>\n",
       "      <td>{'제품유형': '일반식품', '종류': '어류', '분자량': '300Da', '...</td>\n",
       "      <td>일반식품 어류 300Da 성인남녀 구미 15일분 하루 1포 1개 20g x 15포</td>\n",
       "      <td>일반 식품 어류 성인 남녀 구미 하루 포 개 포</td>\n",
       "      <td>일반 식품 어류 성인 남녀 구미 하루</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2642 rows × 473 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          ID                제품             대분류             중분류  \\\n",
       "12        12  B002-00003-00009  B002-C001-0001  B002-C002-0001   \n",
       "30        30  B002-00008-00001  B002-C001-0001  B002-C002-0001   \n",
       "31        31  B002-00009-00001  B002-C001-0001  B002-C002-0001   \n",
       "33        33  B002-00011-00001  B002-C001-0001  B002-C002-0001   \n",
       "37        37  B002-00015-00001  B002-C001-0001  B002-C002-0001   \n",
       "...      ...               ...             ...             ...   \n",
       "15826  15826  B002-03796-00008  B002-C001-0001  B002-C002-0001   \n",
       "15827  15827  B002-03796-00009  B002-C001-0001  B002-C002-0001   \n",
       "15828  15828  B002-03796-00010  B002-C001-0001  B002-C002-0001   \n",
       "15829  15829  B002-03796-00011  B002-C001-0001  B002-C002-0001   \n",
       "15830  15830  B002-03796-00012  B002-C001-0001  B002-C002-0001   \n",
       "\n",
       "                  소분류         브랜드  2022-01-01  2022-01-02  2022-01-03  \\\n",
       "12     B002-C003-0003  B002-00003           0           0           0   \n",
       "30     B002-C003-0001  B002-00008           0           0           3   \n",
       "31     B002-C003-0004  B002-00009           0           0           0   \n",
       "33     B002-C003-0005  B002-00011           0           0           0   \n",
       "37     B002-C003-0005  B002-00015           0           0           0   \n",
       "...               ...         ...         ...         ...         ...   \n",
       "15826  B002-C003-0004  B002-03796           0           0           0   \n",
       "15827  B002-C003-0003  B002-03796          23          23          26   \n",
       "15828  B002-C003-0003  B002-03796           0           0           0   \n",
       "15829  B002-C003-0001  B002-03796           0           0           0   \n",
       "15830  B002-C003-0001  B002-03796           0           0           0   \n",
       "\n",
       "       2022-01-04  ...  2023-04-03  2023-04-04  \\\n",
       "12              0  ...           0           0   \n",
       "30              4  ...           2           0   \n",
       "31              0  ...           0           0   \n",
       "33              0  ...           0           0   \n",
       "37              0  ...           0           0   \n",
       "...           ...  ...         ...         ...   \n",
       "15826           0  ...           1           2   \n",
       "15827          44  ...           0           0   \n",
       "15828           0  ...           3           2   \n",
       "15829           0  ...           0           0   \n",
       "15830           0  ...           0           0   \n",
       "\n",
       "                                                    제품특성  desc_length  \\\n",
       "12     생균:100억 CFU 1일 총 섭취량:1캡슐 제품용량:1개월분 제품타입:캡슐 섭취횟...         19.0   \n",
       "30     주요 기능성(식약처인증):장건강 영양소 원료명(식약처고시):식이섬유 제품타입:구미/...         19.0   \n",
       "31     단백질종류:동물성+식물성 단백질성분:농축유청단백질(WPC) 단백질성분:분리대두단백질...         18.0   \n",
       "33     홍삼농축액 함량:2.5% 고형분 함량:60% 포장형태:스틱형 1일 총 섭취량:1포 ...         22.0   \n",
       "37     홍삼농축액 함량:0% 고형분 함량:87% 1일 총 섭취량:1포 제품용량:개인별 다름...         83.0   \n",
       "...                                                  ...          ...   \n",
       "15826  주요 기능성(식약처인증):해당 없음 영양소 원료명(식약처고시):해당 없음 섭취대상:...         35.0   \n",
       "15827  생균:10억 CFU 1일 총 섭취량:1포 제품용량:1개월분 제품타입:분말 섭취횟수:...         23.0   \n",
       "15828  제품타입:분말 섭취방법:바로 음용 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 ...         16.0   \n",
       "15829  제품유형:일반식품 종류:어류 분자량:600Da 섭취대상:성인남녀 제품타입:구미/젤리...         17.0   \n",
       "15830  제품유형:일반식품 종류:어류 분자량:300Da 섭취대상:성인남녀 제품타입:구미/젤리...         17.0   \n",
       "\n",
       "       consecutive_repeats                                       cleaned_제품특성  \\\n",
       "12                     0.0  생균:100억 CFU 1일 총 섭취량:1캡슐 제품용량:1개월분 제품타입:캡슐 섭취횟...   \n",
       "30                     0.0  주요 기능성 식약처인증 :장건강 영양소 원료명 식약처고시 :식이섬유 제품타입:구미 ...   \n",
       "31                     0.0  단백질종류:동물성 식물성 단백질성분:농축유청단백질 WPC 단백질성분:분리대두단백질 ...   \n",
       "33                     0.0  홍삼농축액 함량:2 5 고형분 함량:60 포장형태:스틱형 1일 총 섭취량:1포 제품...   \n",
       "37                     0.0  홍삼농축액 함량:0 고형분 함량:87 1일 총 섭취량:1포 제품용량:개인별 다름 섭...   \n",
       "...                    ...                                                ...   \n",
       "15826                  0.0  주요 기능성 식약처인증 :해당 없음 영양소 원료명 식약처고시 :해당 없음 섭취대상:...   \n",
       "15827                  0.0  생균:10억 CFU 1일 총 섭취량:1포 제품용량:1개월분 제품타입:분말 섭취횟수:...   \n",
       "15828                  0.0  제품타입:분말 섭취방법:바로 음용 섭취대상:성인남녀 섭취횟수:하루 한 번 1일 총 ...   \n",
       "15829                  0.0  제품유형:일반식품 종류:어류 분자량:600Da 섭취대상:성인남녀 제품타입:구미 젤리...   \n",
       "15830                  0.0  제품유형:일반식품 종류:어류 분자량:300Da 섭취대상:성인남녀 제품타입:구미 젤리...   \n",
       "\n",
       "                                             parsed_제품특성  \\\n",
       "12     {'생균': '100억', 'CFU 1일 총 섭취량': '1캡슐', '제품용량': ...   \n",
       "30     {'주요 기능성 식약처인증': '장건강', '영양소 원료명 식약처고시': '식이섬유...   \n",
       "31     {'단백질종류': '동물성', '식물성 단백질성분': '농축유청단백질', 'WPC ...   \n",
       "33     {'홍삼농축액 함량': '2', '5 고형분 함량': '60', '포장형태': '스...   \n",
       "37     {'홍삼농축액 함량': '0', '고형분 함량': '87', '1일 총 섭취량': ...   \n",
       "...                                                  ...   \n",
       "15826  {'주요 기능성 식약처인증': '해당', '없음 영양소 원료명 식약처고시': '해당...   \n",
       "15827  {'생균': '10억', 'CFU 1일 총 섭취량': '1포', '제품용량': '1...   \n",
       "15828  {'제품타입': '분말', '섭취방법': '바로', '음용 섭취대상': '성인남녀'...   \n",
       "15829  {'제품유형': '일반식품', '종류': '어류', '분자량': '600Da', '...   \n",
       "15830  {'제품유형': '일반식품', '종류': '어류', '분자량': '300Da', '...   \n",
       "\n",
       "                                           combined_제품특성  \\\n",
       "12       100억 1캡슐 1개월분 캡슐 하루 물과 성인남녀 체지방 감소 480mg x 30캡슐   \n",
       "30          장건강 식이섬유 구미 씹어서 성인남녀 하루 1포 14일분 1개 20g x 14포   \n",
       "31     동물성 농축유청단백질 분리대두단백질 산양유단백질 26g 성인남녀 우유 물에 1스푼 ...   \n",
       "33          2 60 스틱형 1포 1개월분 하루 바로 유아 농축액 1개 20ml x 10개입   \n",
       "37     0 87 3스푼 80일분 하루 씹어서 1개 씹어서 하루 물에 성인남녀 농축액 건강기...   \n",
       "...                                                  ...   \n",
       "15826  해당 해당 성인남녀 물에 2스푼 하루 1개 동물성 분리유청단백질 분리대두단백질 산양...   \n",
       "15827    10억 1포 1개월분 분말 하루 바로 성인남녀 장건강 셀레늄 1개 2 5g x 30포   \n",
       "15828                분말 바로 성인남녀 하루 1포 1개월분 1개 2 8g x 30포   \n",
       "15829      일반식품 어류 600Da 성인남녀 구미 14일분 하루 1포 2개 20g x 15포   \n",
       "15830      일반식품 어류 300Da 성인남녀 구미 15일분 하루 1포 1개 20g x 15포   \n",
       "\n",
       "                                          tokenized_제품특성  \\\n",
       "12                         캡슐 개월 캡슐 하루 물 성인 남녀 체지방 감소 캡슐   \n",
       "30                           장 건강 식이섬유 구미 성인 남녀 하루 포 개 포   \n",
       "31      동물성 농축 유청 단백질 분리 단백질 산양 유 단백질 성인 남녀 우유 물 스푼 하루 개   \n",
       "33                             스틱 포 개월 하루 바로 유아 농축액 개 개입   \n",
       "37     스푼 하루 개 하루 물 성인 남녀 농축액 건강 기능 식품 면역 해당 개 농축액 해당...   \n",
       "...                                                  ...   \n",
       "15826  해당 해당 성인 남녀 물 스푼 하루 개 동물성 분리 유청 단백질 분리 단백질 산양 ...   \n",
       "15827                   포 개월 분말 하루 바로 성인 남녀 장 건강 셀레늄 개 포   \n",
       "15828                            분말 바로 성인 남녀 하루 포 개월 개 포   \n",
       "15829                         일반 식품 어류 성인 남녀 구미 하루 포 개 포   \n",
       "15830                         일반 식품 어류 성인 남녀 구미 하루 포 개 포   \n",
       "\n",
       "                                  tokenized_제품특성_cleaned  \n",
       "12                           캡슐 개월 캡슐 하루 성인 남녀 체지방 감소 캡슐  \n",
       "30                                   건강 식이섬유 구미 성인 남녀 하루  \n",
       "31            동물성 농축 유청 단백질 분리 단백질 산양 단백질 성인 남녀 우유 스푼 하루  \n",
       "33                                 스틱 개월 하루 바로 유아 농축액 개입  \n",
       "37           스푼 하루 하루 성인 남녀 농축액 건강 기능 식품 면역 해당 농축액 해당 개인  \n",
       "...                                                  ...  \n",
       "15826  해당 해당 성인 남녀 스푼 하루 동물성 분리 유청 단백질 분리 단백질 산양 단백질 ...  \n",
       "15827                           개월 분말 하루 바로 성인 남녀 건강 셀레늄  \n",
       "15828                                  분말 바로 성인 남녀 하루 개월  \n",
       "15829                               일반 식품 어류 성인 남녀 구미 하루  \n",
       "15830                               일반 식품 어류 성인 남녀 구미 하루  \n",
       "\n",
       "[2642 rows x 473 columns]"
      ]
     },
     "execution_count": 62,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merged_data_nonan[merged_data_nonan['대분류'] =='B002-C001-0001']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 67,
   "id": "6e46a2c2",
   "metadata": {},
   "outputs": [],
   "source": [
    "merged = merged_data_nonan"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 76,
   "id": "eee1a76c",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>제품</th>\n",
       "      <th>대분류</th>\n",
       "      <th>중분류</th>\n",
       "      <th>소분류</th>\n",
       "      <th>브랜드</th>\n",
       "      <th>2022-01-01</th>\n",
       "      <th>2022-01-02</th>\n",
       "      <th>2022-01-03</th>\n",
       "      <th>2022-01-04</th>\n",
       "      <th>...</th>\n",
       "      <th>2023-04-03</th>\n",
       "      <th>2023-04-04</th>\n",
       "      <th>제품특성</th>\n",
       "      <th>desc_length</th>\n",
       "      <th>consecutive_repeats</th>\n",
       "      <th>cleaned_제품특성</th>\n",
       "      <th>parsed_제품특성</th>\n",
       "      <th>combined_제품특성</th>\n",
       "      <th>tokenized_제품특성</th>\n",
       "      <th>tokenized_제품특성_cleaned</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>B002-00001-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0007</td>\n",
       "      <td>B002-C003-0038</td>\n",
       "      <td>B002-00001</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>헤어타입:모든 모발용 제품형태:스프레이형 주요제품특징:머릿결개선 주요제품특징:흡수력...</td>\n",
       "      <td>13.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>헤어타입:모든 모발용 제품형태:스프레이형 주요제품특징:머릿결개선 주요제품특징:흡수력...</td>\n",
       "      <td>{'헤어타입': '모든', '모발용 제품형태': '스프레이형', '주요제품특징': ...</td>\n",
       "      <td>모든 스프레이형 흡수력 부드러운 윤기부여 영양공급 30ml 1개 50ml</td>\n",
       "      <td>모든 스프레이 흡수 윤기 부여 영양 공급 개</td>\n",
       "      <td>모든 스프레이 흡수 윤기 부여 영양 공급</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>12</td>\n",
       "      <td>B002-00003-00009</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-00003</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>생균:100억 CFU 1일 총 섭취량:1캡슐 제품용량:1개월분 제품타입:캡슐 섭취횟...</td>\n",
       "      <td>19.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>생균:100억 CFU 1일 총 섭취량:1캡슐 제품용량:1개월분 제품타입:캡슐 섭취횟...</td>\n",
       "      <td>{'생균': '100억', 'CFU 1일 총 섭취량': '1캡슐', '제품용량': ...</td>\n",
       "      <td>100억 1캡슐 1개월분 캡슐 하루 물과 성인남녀 체지방 감소 480mg x 30캡슐</td>\n",
       "      <td>캡슐 개월 캡슐 하루 물 성인 남녀 체지방 감소 캡슐</td>\n",
       "      <td>캡슐 개월 캡슐 하루 성인 남녀 체지방 감소 캡슐</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>16</td>\n",
       "      <td>B002-00005-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>피부타입:모든피부용 향계열:과일향 주요제품특징:향 주요제품특징:촉촉함(수분공급) 용...</td>\n",
       "      <td>8.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>피부타입:모든피부용 향계열:과일향 주요제품특징:향 주요제품특징:촉촉함 수분공급 용기...</td>\n",
       "      <td>{'피부타입': '모든피부용', '향계열': '과일향', '주요제품특징': '촉촉함...</td>\n",
       "      <td>모든피부용 과일향 촉촉함 펌프형 500ml 1개 500ml</td>\n",
       "      <td>피부 용 과일 향 펌프 개</td>\n",
       "      <td>피부 과일 펌프</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>17</td>\n",
       "      <td>B002-00005-00002</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>향계열:과일향 주요제품특징:향 용기형태:펌프형 :1개 500ml</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>향계열:과일향 주요제품특징:향 용기형태:펌프형 :1개 500ml</td>\n",
       "      <td>{'향계열': '과일향', '주요제품특징': '향', '펌프형': '1개 500ml'}</td>\n",
       "      <td>과일향 향 1개 500ml</td>\n",
       "      <td>과일 향 향 개</td>\n",
       "      <td>과일</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>19</td>\n",
       "      <td>B002-00005-00004</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>형태:펌프형 용량:575ml :1개, 형태:펌프형 용량:520ml :1개, 형태:튜...</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>형태:펌프형 용량:575ml :1개 형태:펌프형 용량:520ml :1개 형태:튜브형...</td>\n",
       "      <td>{'형태': '튜브형', '575ml': '1개', '520ml': '1개', '6...</td>\n",
       "      <td>튜브형 1개 1개 1개 575ml</td>\n",
       "      <td>튜브 개 개 개</td>\n",
       "      <td>튜브</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15877</th>\n",
       "      <td>15877</td>\n",
       "      <td>B002-03798-00049</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>재질:실리콘 재질:기타</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>재질:실리콘 재질:기타</td>\n",
       "      <td>{'재질': '기타'}</td>\n",
       "      <td>기타</td>\n",
       "      <td>기타</td>\n",
       "      <td>기타</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15882</th>\n",
       "      <td>15882</td>\n",
       "      <td>B002-03798-00054</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>형태:빨대형 용량:300ml 특징:양손잡이 특징:보온보냉 특징:샘방지/흘림방지 재질...</td>\n",
       "      <td>28.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>형태:빨대형 용량:300ml 특징:양손잡이 특징:보온보냉 특징:샘방지 흘림방지 재질...</td>\n",
       "      <td>{'형태': '빨대형', '용량': '300ml', '특징': '양손잡이', '흘림...</td>\n",
       "      <td>빨대형 300ml 양손잡이 PE 스테인리스스틸</td>\n",
       "      <td>빨대 양손잡이 스테인리스 스틸</td>\n",
       "      <td>빨대 양손잡이 스테인리스 스틸</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15883</th>\n",
       "      <td>15883</td>\n",
       "      <td>B002-03798-00055</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>형태:머그형 용량:240ml 특징:양손잡이 특징:미끄럼방지 특징:비스페놀A(BPA)...</td>\n",
       "      <td>21.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>형태:머그형 용량:240ml 특징:양손잡이 특징:미끄럼방지 특징:비스페놀A BPA ...</td>\n",
       "      <td>{'형태': '머그형', '용량': '240ml', '특징': '미끄럼방지', 'B...</td>\n",
       "      <td>머그형 240ml 미끄럼방지 ABS 스테인리스스틸</td>\n",
       "      <td>머그 미끄럼 방지 스테인리스 스틸</td>\n",
       "      <td>머그 미끄럼 방지 스테인리스 스틸</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15887</th>\n",
       "      <td>15887</td>\n",
       "      <td>B002-03799-00004</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG508S3</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG508S3</td>\n",
       "      <td>{'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...</td>\n",
       "      <td>이유식보관용기 전자레인지사용 실리콘 3개세트 LLG508S3</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 개 세트</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 세트</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15888</th>\n",
       "      <td>15888</td>\n",
       "      <td>B002-03799-00005</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG509S3</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG509S3</td>\n",
       "      <td>{'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...</td>\n",
       "      <td>이유식보관용기 전자레인지사용 실리콘 3개세트 LLG509S3</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 개 세트</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 세트</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10481 rows × 473 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          ID                제품             대분류             중분류  \\\n",
       "0          0  B002-00001-00001  B002-C001-0002  B002-C002-0007   \n",
       "12        12  B002-00003-00009  B002-C001-0001  B002-C002-0001   \n",
       "16        16  B002-00005-00001  B002-C001-0002  B002-C002-0006   \n",
       "17        17  B002-00005-00002  B002-C001-0002  B002-C002-0006   \n",
       "19        19  B002-00005-00004  B002-C001-0002  B002-C002-0006   \n",
       "...      ...               ...             ...             ...   \n",
       "15877  15877  B002-03798-00049  B002-C001-0003  B002-C002-0008   \n",
       "15882  15882  B002-03798-00054  B002-C001-0003  B002-C002-0008   \n",
       "15883  15883  B002-03798-00055  B002-C001-0003  B002-C002-0008   \n",
       "15887  15887  B002-03799-00004  B002-C001-0003  B002-C002-0008   \n",
       "15888  15888  B002-03799-00005  B002-C001-0003  B002-C002-0008   \n",
       "\n",
       "                  소분류         브랜드  2022-01-01  2022-01-02  2022-01-03  \\\n",
       "0      B002-C003-0038  B002-00001           0           0           0   \n",
       "12     B002-C003-0003  B002-00003           0           0           0   \n",
       "16     B002-C003-0032  B002-00005           0           0           0   \n",
       "17     B002-C003-0032  B002-00005           0           0           0   \n",
       "19     B002-C003-0032  B002-00005           0           0           0   \n",
       "...               ...         ...         ...         ...         ...   \n",
       "15877  B002-C003-0044  B002-03798           0           0           0   \n",
       "15882  B002-C003-0044  B002-03798           0           0           0   \n",
       "15883  B002-C003-0044  B002-03798           0           0           0   \n",
       "15887  B002-C003-0044  B002-03799           0           0           0   \n",
       "15888  B002-C003-0044  B002-03799           0           0           0   \n",
       "\n",
       "       2022-01-04  ...  2023-04-03  2023-04-04  \\\n",
       "0               0  ...           0           0   \n",
       "12              0  ...           0           0   \n",
       "16              0  ...           0           0   \n",
       "17              0  ...           0           0   \n",
       "19              0  ...           0           0   \n",
       "...           ...  ...         ...         ...   \n",
       "15877           0  ...           0           1   \n",
       "15882           0  ...           1           0   \n",
       "15883           0  ...           2           0   \n",
       "15887           0  ...           0           0   \n",
       "15888           0  ...           0           2   \n",
       "\n",
       "                                                    제품특성  desc_length  \\\n",
       "0      헤어타입:모든 모발용 제품형태:스프레이형 주요제품특징:머릿결개선 주요제품특징:흡수력...         13.0   \n",
       "12     생균:100억 CFU 1일 총 섭취량:1캡슐 제품용량:1개월분 제품타입:캡슐 섭취횟...         19.0   \n",
       "16     피부타입:모든피부용 향계열:과일향 주요제품특징:향 주요제품특징:촉촉함(수분공급) 용...          8.0   \n",
       "17                   향계열:과일향 주요제품특징:향 용기형태:펌프형 :1개 500ml          5.0   \n",
       "19     형태:펌프형 용량:575ml :1개, 형태:펌프형 용량:520ml :1개, 형태:튜...         10.0   \n",
       "...                                                  ...          ...   \n",
       "15877                                      재질:실리콘 재질:기타           2.0   \n",
       "15882  형태:빨대형 용량:300ml 특징:양손잡이 특징:보온보냉 특징:샘방지/흘림방지 재질...         28.0   \n",
       "15883  형태:머그형 용량:240ml 특징:양손잡이 특징:미끄럼방지 특징:비스페놀A(BPA)...         21.0   \n",
       "15887         종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG508S3          5.0   \n",
       "15888         종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG509S3          5.0   \n",
       "\n",
       "       consecutive_repeats                                       cleaned_제품특성  \\\n",
       "0                      0.0  헤어타입:모든 모발용 제품형태:스프레이형 주요제품특징:머릿결개선 주요제품특징:흡수력...   \n",
       "12                     0.0  생균:100억 CFU 1일 총 섭취량:1캡슐 제품용량:1개월분 제품타입:캡슐 섭취횟...   \n",
       "16                     0.0  피부타입:모든피부용 향계열:과일향 주요제품특징:향 주요제품특징:촉촉함 수분공급 용기...   \n",
       "17                     0.0                향계열:과일향 주요제품특징:향 용기형태:펌프형 :1개 500ml   \n",
       "19                     0.0  형태:펌프형 용량:575ml :1개 형태:펌프형 용량:520ml :1개 형태:튜브형...   \n",
       "...                    ...                                                ...   \n",
       "15877                  0.0                                       재질:실리콘 재질:기타   \n",
       "15882                  0.0  형태:빨대형 용량:300ml 특징:양손잡이 특징:보온보냉 특징:샘방지 흘림방지 재질...   \n",
       "15883                  0.0  형태:머그형 용량:240ml 특징:양손잡이 특징:미끄럼방지 특징:비스페놀A BPA ...   \n",
       "15887                  0.0         종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG508S3   \n",
       "15888                  0.0         종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG509S3   \n",
       "\n",
       "                                             parsed_제품특성  \\\n",
       "0      {'헤어타입': '모든', '모발용 제품형태': '스프레이형', '주요제품특징': ...   \n",
       "12     {'생균': '100억', 'CFU 1일 총 섭취량': '1캡슐', '제품용량': ...   \n",
       "16     {'피부타입': '모든피부용', '향계열': '과일향', '주요제품특징': '촉촉함...   \n",
       "17      {'향계열': '과일향', '주요제품특징': '향', '펌프형': '1개 500ml'}   \n",
       "19     {'형태': '튜브형', '575ml': '1개', '520ml': '1개', '6...   \n",
       "...                                                  ...   \n",
       "15877                                       {'재질': '기타'}   \n",
       "15882  {'형태': '빨대형', '용량': '300ml', '특징': '양손잡이', '흘림...   \n",
       "15883  {'형태': '머그형', '용량': '240ml', '특징': '미끄럼방지', 'B...   \n",
       "15887  {'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...   \n",
       "15888  {'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...   \n",
       "\n",
       "                                         combined_제품특성  \\\n",
       "0             모든 스프레이형 흡수력 부드러운 윤기부여 영양공급 30ml 1개 50ml   \n",
       "12     100억 1캡슐 1개월분 캡슐 하루 물과 성인남녀 체지방 감소 480mg x 30캡슐   \n",
       "16                    모든피부용 과일향 촉촉함 펌프형 500ml 1개 500ml   \n",
       "17                                      과일향 향 1개 500ml   \n",
       "19                                  튜브형 1개 1개 1개 575ml   \n",
       "...                                                ...   \n",
       "15877                                               기타   \n",
       "15882                        빨대형 300ml 양손잡이 PE 스테인리스스틸   \n",
       "15883                      머그형 240ml 미끄럼방지 ABS 스테인리스스틸   \n",
       "15887                이유식보관용기 전자레인지사용 실리콘 3개세트 LLG508S3   \n",
       "15888                이유식보관용기 전자레인지사용 실리콘 3개세트 LLG509S3   \n",
       "\n",
       "                      tokenized_제품특성       tokenized_제품특성_cleaned  \n",
       "0           모든 스프레이 흡수 윤기 부여 영양 공급 개       모든 스프레이 흡수 윤기 부여 영양 공급  \n",
       "12     캡슐 개월 캡슐 하루 물 성인 남녀 체지방 감소 캡슐  캡슐 개월 캡슐 하루 성인 남녀 체지방 감소 캡슐  \n",
       "16                    피부 용 과일 향 펌프 개                     피부 과일 펌프  \n",
       "17                          과일 향 향 개                           과일  \n",
       "19                          튜브 개 개 개                           튜브  \n",
       "...                              ...                          ...  \n",
       "15877                             기타                           기타  \n",
       "15882               빨대 양손잡이 스테인리스 스틸             빨대 양손잡이 스테인리스 스틸  \n",
       "15883             머그 미끄럼 방지 스테인리스 스틸           머그 미끄럼 방지 스테인리스 스틸  \n",
       "15887    이유식 보관 용기 전자레인지 사용 실리콘 개 세트    이유식 보관 용기 전자레인지 사용 실리콘 세트  \n",
       "15888    이유식 보관 용기 전자레인지 사용 실리콘 개 세트    이유식 보관 용기 전자레인지 사용 실리콘 세트  \n",
       "\n",
       "[10481 rows x 473 columns]"
      ]
     },
     "execution_count": 76,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merged"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "26bfe19f",
   "metadata": {},
   "source": [
    " ##  대분류 분석"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 70,
   "id": "56bf4e6d",
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "filtered_data = merged[merged['대분류'] == 'B002-C001-0001']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 74,
   "id": "5b3f5522",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[('성인', 2703), ('하루', 2547), ('남녀', 2497), ('캡슐', 1854), ('개월', 1747), ('건강', 810), ('단백질', 789), ('비타민', 745), ('바로', 722), ('분말', 545), ('식품', 535), ('영양', 470), ('보충', 468), ('분리', 372), ('해당', 369), ('유아', 350), ('유청', 339), ('동물성', 321), ('기능', 314), ('일반', 273)]\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Karl\\AppData\\Local\\Temp\\ipykernel_29388\\1486778846.py:2: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  filtered_data['tokenized_제품특성_cleaned'] = filtered_data['tokenized_제품특성_cleaned'].apply(lambda x: x.split() if isinstance(x, str) else [])\n"
     ]
    }
   ],
   "source": [
    "# Convert the space-separated string to a list by splitting by spaces\n",
    "filtered_data['tokenized_제품특성_cleaned'] = filtered_data['tokenized_제품특성_cleaned'].apply(lambda x: x.split() if isinstance(x, str) else [])\n",
    "\n",
    "# Now sum up all the token lists into a single list\n",
    "all_tokens = sum(filtered_data['tokenized_제품특성_cleaned'], [])\n",
    "\n",
    "# Proceed with counting the tokens\n",
    "from collections import Counter\n",
    "token_counts = Counter(all_tokens)\n",
    "\n",
    "# Identify the most common tokens\n",
    "most_common_tokens = token_counts.most_common(20)  # adjust the number as needed\n",
    "\n",
    "print(most_common_tokens)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 77,
   "id": "66546cee",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Karl\\AppData\\Local\\Temp\\ipykernel_29388\\481800992.py:1: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  merged['대분류:건강식품'] = merged['대분류'].apply(lambda x: 1 if x == 'B002-C001-0001' else 0)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>제품</th>\n",
       "      <th>대분류</th>\n",
       "      <th>중분류</th>\n",
       "      <th>소분류</th>\n",
       "      <th>브랜드</th>\n",
       "      <th>2022-01-01</th>\n",
       "      <th>2022-01-02</th>\n",
       "      <th>2022-01-03</th>\n",
       "      <th>2022-01-04</th>\n",
       "      <th>...</th>\n",
       "      <th>2023-04-04</th>\n",
       "      <th>제품특성</th>\n",
       "      <th>desc_length</th>\n",
       "      <th>consecutive_repeats</th>\n",
       "      <th>cleaned_제품특성</th>\n",
       "      <th>parsed_제품특성</th>\n",
       "      <th>combined_제품특성</th>\n",
       "      <th>tokenized_제품특성</th>\n",
       "      <th>tokenized_제품특성_cleaned</th>\n",
       "      <th>대분류:건강식품</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>B002-00001-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0007</td>\n",
       "      <td>B002-C003-0038</td>\n",
       "      <td>B002-00001</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>헤어타입:모든 모발용 제품형태:스프레이형 주요제품특징:머릿결개선 주요제품특징:흡수력...</td>\n",
       "      <td>13.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>헤어타입:모든 모발용 제품형태:스프레이형 주요제품특징:머릿결개선 주요제품특징:흡수력...</td>\n",
       "      <td>{'헤어타입': '모든', '모발용 제품형태': '스프레이형', '주요제품특징': ...</td>\n",
       "      <td>모든 스프레이형 흡수력 부드러운 윤기부여 영양공급 30ml 1개 50ml</td>\n",
       "      <td>모든 스프레이 흡수 윤기 부여 영양 공급 개</td>\n",
       "      <td>모든 스프레이 흡수 윤기 부여 영양 공급</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>12</td>\n",
       "      <td>B002-00003-00009</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-00003</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>생균:100억 CFU 1일 총 섭취량:1캡슐 제품용량:1개월분 제품타입:캡슐 섭취횟...</td>\n",
       "      <td>19.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>생균:100억 CFU 1일 총 섭취량:1캡슐 제품용량:1개월분 제품타입:캡슐 섭취횟...</td>\n",
       "      <td>{'생균': '100억', 'CFU 1일 총 섭취량': '1캡슐', '제품용량': ...</td>\n",
       "      <td>100억 1캡슐 1개월분 캡슐 하루 물과 성인남녀 체지방 감소 480mg x 30캡슐</td>\n",
       "      <td>캡슐 개월 캡슐 하루 물 성인 남녀 체지방 감소 캡슐</td>\n",
       "      <td>캡슐 개월 캡슐 하루 성인 남녀 체지방 감소 캡슐</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>16</td>\n",
       "      <td>B002-00005-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>피부타입:모든피부용 향계열:과일향 주요제품특징:향 주요제품특징:촉촉함(수분공급) 용...</td>\n",
       "      <td>8.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>피부타입:모든피부용 향계열:과일향 주요제품특징:향 주요제품특징:촉촉함 수분공급 용기...</td>\n",
       "      <td>{'피부타입': '모든피부용', '향계열': '과일향', '주요제품특징': '촉촉함...</td>\n",
       "      <td>모든피부용 과일향 촉촉함 펌프형 500ml 1개 500ml</td>\n",
       "      <td>피부 용 과일 향 펌프 개</td>\n",
       "      <td>피부 과일 펌프</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>17</td>\n",
       "      <td>B002-00005-00002</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>향계열:과일향 주요제품특징:향 용기형태:펌프형 :1개 500ml</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>향계열:과일향 주요제품특징:향 용기형태:펌프형 :1개 500ml</td>\n",
       "      <td>{'향계열': '과일향', '주요제품특징': '향', '펌프형': '1개 500ml'}</td>\n",
       "      <td>과일향 향 1개 500ml</td>\n",
       "      <td>과일 향 향 개</td>\n",
       "      <td>과일</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>19</td>\n",
       "      <td>B002-00005-00004</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>형태:펌프형 용량:575ml :1개, 형태:펌프형 용량:520ml :1개, 형태:튜...</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>형태:펌프형 용량:575ml :1개 형태:펌프형 용량:520ml :1개 형태:튜브형...</td>\n",
       "      <td>{'형태': '튜브형', '575ml': '1개', '520ml': '1개', '6...</td>\n",
       "      <td>튜브형 1개 1개 1개 575ml</td>\n",
       "      <td>튜브 개 개 개</td>\n",
       "      <td>튜브</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15877</th>\n",
       "      <td>15877</td>\n",
       "      <td>B002-03798-00049</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>재질:실리콘 재질:기타</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>재질:실리콘 재질:기타</td>\n",
       "      <td>{'재질': '기타'}</td>\n",
       "      <td>기타</td>\n",
       "      <td>기타</td>\n",
       "      <td>기타</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15882</th>\n",
       "      <td>15882</td>\n",
       "      <td>B002-03798-00054</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>형태:빨대형 용량:300ml 특징:양손잡이 특징:보온보냉 특징:샘방지/흘림방지 재질...</td>\n",
       "      <td>28.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>형태:빨대형 용량:300ml 특징:양손잡이 특징:보온보냉 특징:샘방지 흘림방지 재질...</td>\n",
       "      <td>{'형태': '빨대형', '용량': '300ml', '특징': '양손잡이', '흘림...</td>\n",
       "      <td>빨대형 300ml 양손잡이 PE 스테인리스스틸</td>\n",
       "      <td>빨대 양손잡이 스테인리스 스틸</td>\n",
       "      <td>빨대 양손잡이 스테인리스 스틸</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15883</th>\n",
       "      <td>15883</td>\n",
       "      <td>B002-03798-00055</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>형태:머그형 용량:240ml 특징:양손잡이 특징:미끄럼방지 특징:비스페놀A(BPA)...</td>\n",
       "      <td>21.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>형태:머그형 용량:240ml 특징:양손잡이 특징:미끄럼방지 특징:비스페놀A BPA ...</td>\n",
       "      <td>{'형태': '머그형', '용량': '240ml', '특징': '미끄럼방지', 'B...</td>\n",
       "      <td>머그형 240ml 미끄럼방지 ABS 스테인리스스틸</td>\n",
       "      <td>머그 미끄럼 방지 스테인리스 스틸</td>\n",
       "      <td>머그 미끄럼 방지 스테인리스 스틸</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15887</th>\n",
       "      <td>15887</td>\n",
       "      <td>B002-03799-00004</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG508S3</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG508S3</td>\n",
       "      <td>{'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...</td>\n",
       "      <td>이유식보관용기 전자레인지사용 실리콘 3개세트 LLG508S3</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 개 세트</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 세트</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15888</th>\n",
       "      <td>15888</td>\n",
       "      <td>B002-03799-00005</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>2</td>\n",
       "      <td>종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG509S3</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG509S3</td>\n",
       "      <td>{'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...</td>\n",
       "      <td>이유식보관용기 전자레인지사용 실리콘 3개세트 LLG509S3</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 개 세트</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 세트</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10481 rows × 474 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          ID                제품             대분류             중분류  \\\n",
       "0          0  B002-00001-00001  B002-C001-0002  B002-C002-0007   \n",
       "12        12  B002-00003-00009  B002-C001-0001  B002-C002-0001   \n",
       "16        16  B002-00005-00001  B002-C001-0002  B002-C002-0006   \n",
       "17        17  B002-00005-00002  B002-C001-0002  B002-C002-0006   \n",
       "19        19  B002-00005-00004  B002-C001-0002  B002-C002-0006   \n",
       "...      ...               ...             ...             ...   \n",
       "15877  15877  B002-03798-00049  B002-C001-0003  B002-C002-0008   \n",
       "15882  15882  B002-03798-00054  B002-C001-0003  B002-C002-0008   \n",
       "15883  15883  B002-03798-00055  B002-C001-0003  B002-C002-0008   \n",
       "15887  15887  B002-03799-00004  B002-C001-0003  B002-C002-0008   \n",
       "15888  15888  B002-03799-00005  B002-C001-0003  B002-C002-0008   \n",
       "\n",
       "                  소분류         브랜드  2022-01-01  2022-01-02  2022-01-03  \\\n",
       "0      B002-C003-0038  B002-00001           0           0           0   \n",
       "12     B002-C003-0003  B002-00003           0           0           0   \n",
       "16     B002-C003-0032  B002-00005           0           0           0   \n",
       "17     B002-C003-0032  B002-00005           0           0           0   \n",
       "19     B002-C003-0032  B002-00005           0           0           0   \n",
       "...               ...         ...         ...         ...         ...   \n",
       "15877  B002-C003-0044  B002-03798           0           0           0   \n",
       "15882  B002-C003-0044  B002-03798           0           0           0   \n",
       "15883  B002-C003-0044  B002-03798           0           0           0   \n",
       "15887  B002-C003-0044  B002-03799           0           0           0   \n",
       "15888  B002-C003-0044  B002-03799           0           0           0   \n",
       "\n",
       "       2022-01-04  ...  2023-04-04  \\\n",
       "0               0  ...           0   \n",
       "12              0  ...           0   \n",
       "16              0  ...           0   \n",
       "17              0  ...           0   \n",
       "19              0  ...           0   \n",
       "...           ...  ...         ...   \n",
       "15877           0  ...           1   \n",
       "15882           0  ...           0   \n",
       "15883           0  ...           0   \n",
       "15887           0  ...           0   \n",
       "15888           0  ...           2   \n",
       "\n",
       "                                                    제품특성  desc_length  \\\n",
       "0      헤어타입:모든 모발용 제품형태:스프레이형 주요제품특징:머릿결개선 주요제품특징:흡수력...         13.0   \n",
       "12     생균:100억 CFU 1일 총 섭취량:1캡슐 제품용량:1개월분 제품타입:캡슐 섭취횟...         19.0   \n",
       "16     피부타입:모든피부용 향계열:과일향 주요제품특징:향 주요제품특징:촉촉함(수분공급) 용...          8.0   \n",
       "17                   향계열:과일향 주요제품특징:향 용기형태:펌프형 :1개 500ml          5.0   \n",
       "19     형태:펌프형 용량:575ml :1개, 형태:펌프형 용량:520ml :1개, 형태:튜...         10.0   \n",
       "...                                                  ...          ...   \n",
       "15877                                      재질:실리콘 재질:기타           2.0   \n",
       "15882  형태:빨대형 용량:300ml 특징:양손잡이 특징:보온보냉 특징:샘방지/흘림방지 재질...         28.0   \n",
       "15883  형태:머그형 용량:240ml 특징:양손잡이 특징:미끄럼방지 특징:비스페놀A(BPA)...         21.0   \n",
       "15887         종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG508S3          5.0   \n",
       "15888         종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG509S3          5.0   \n",
       "\n",
       "       consecutive_repeats                                       cleaned_제품특성  \\\n",
       "0                      0.0  헤어타입:모든 모발용 제품형태:스프레이형 주요제품특징:머릿결개선 주요제품특징:흡수력...   \n",
       "12                     0.0  생균:100억 CFU 1일 총 섭취량:1캡슐 제품용량:1개월분 제품타입:캡슐 섭취횟...   \n",
       "16                     0.0  피부타입:모든피부용 향계열:과일향 주요제품특징:향 주요제품특징:촉촉함 수분공급 용기...   \n",
       "17                     0.0                향계열:과일향 주요제품특징:향 용기형태:펌프형 :1개 500ml   \n",
       "19                     0.0  형태:펌프형 용량:575ml :1개 형태:펌프형 용량:520ml :1개 형태:튜브형...   \n",
       "...                    ...                                                ...   \n",
       "15877                  0.0                                       재질:실리콘 재질:기타   \n",
       "15882                  0.0  형태:빨대형 용량:300ml 특징:양손잡이 특징:보온보냉 특징:샘방지 흘림방지 재질...   \n",
       "15883                  0.0  형태:머그형 용량:240ml 특징:양손잡이 특징:미끄럼방지 특징:비스페놀A BPA ...   \n",
       "15887                  0.0         종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG508S3   \n",
       "15888                  0.0         종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG509S3   \n",
       "\n",
       "                                             parsed_제품특성  \\\n",
       "0      {'헤어타입': '모든', '모발용 제품형태': '스프레이형', '주요제품특징': ...   \n",
       "12     {'생균': '100억', 'CFU 1일 총 섭취량': '1캡슐', '제품용량': ...   \n",
       "16     {'피부타입': '모든피부용', '향계열': '과일향', '주요제품특징': '촉촉함...   \n",
       "17      {'향계열': '과일향', '주요제품특징': '향', '펌프형': '1개 500ml'}   \n",
       "19     {'형태': '튜브형', '575ml': '1개', '520ml': '1개', '6...   \n",
       "...                                                  ...   \n",
       "15877                                       {'재질': '기타'}   \n",
       "15882  {'형태': '빨대형', '용량': '300ml', '특징': '양손잡이', '흘림...   \n",
       "15883  {'형태': '머그형', '용량': '240ml', '특징': '미끄럼방지', 'B...   \n",
       "15887  {'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...   \n",
       "15888  {'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...   \n",
       "\n",
       "                                         combined_제품특성  \\\n",
       "0             모든 스프레이형 흡수력 부드러운 윤기부여 영양공급 30ml 1개 50ml   \n",
       "12     100억 1캡슐 1개월분 캡슐 하루 물과 성인남녀 체지방 감소 480mg x 30캡슐   \n",
       "16                    모든피부용 과일향 촉촉함 펌프형 500ml 1개 500ml   \n",
       "17                                      과일향 향 1개 500ml   \n",
       "19                                  튜브형 1개 1개 1개 575ml   \n",
       "...                                                ...   \n",
       "15877                                               기타   \n",
       "15882                        빨대형 300ml 양손잡이 PE 스테인리스스틸   \n",
       "15883                      머그형 240ml 미끄럼방지 ABS 스테인리스스틸   \n",
       "15887                이유식보관용기 전자레인지사용 실리콘 3개세트 LLG508S3   \n",
       "15888                이유식보관용기 전자레인지사용 실리콘 3개세트 LLG509S3   \n",
       "\n",
       "                      tokenized_제품특성       tokenized_제품특성_cleaned  대분류:건강식품  \n",
       "0           모든 스프레이 흡수 윤기 부여 영양 공급 개       모든 스프레이 흡수 윤기 부여 영양 공급         0  \n",
       "12     캡슐 개월 캡슐 하루 물 성인 남녀 체지방 감소 캡슐  캡슐 개월 캡슐 하루 성인 남녀 체지방 감소 캡슐         1  \n",
       "16                    피부 용 과일 향 펌프 개                     피부 과일 펌프         0  \n",
       "17                          과일 향 향 개                           과일         0  \n",
       "19                          튜브 개 개 개                           튜브         0  \n",
       "...                              ...                          ...       ...  \n",
       "15877                             기타                           기타         0  \n",
       "15882               빨대 양손잡이 스테인리스 스틸             빨대 양손잡이 스테인리스 스틸         0  \n",
       "15883             머그 미끄럼 방지 스테인리스 스틸           머그 미끄럼 방지 스테인리스 스틸         0  \n",
       "15887    이유식 보관 용기 전자레인지 사용 실리콘 개 세트    이유식 보관 용기 전자레인지 사용 실리콘 세트         0  \n",
       "15888    이유식 보관 용기 전자레인지 사용 실리콘 개 세트    이유식 보관 용기 전자레인지 사용 실리콘 세트         0  \n",
       "\n",
       "[10481 rows x 474 columns]"
      ]
     },
     "execution_count": 77,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merged['대분류:건강식품'] = merged['대분류'].apply(lambda x: 1 if x == 'B002-C001-0001' else 0)\n",
    "merged"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 79,
   "id": "e58cf44d",
   "metadata": {},
   "outputs": [],
   "source": [
    "major_category = {'B002-C001-0001': '건강식품'}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 105,
   "id": "ec7cc63d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>제품</th>\n",
       "      <th>대분류</th>\n",
       "      <th>중분류</th>\n",
       "      <th>소분류</th>\n",
       "      <th>브랜드</th>\n",
       "      <th>2022-01-01</th>\n",
       "      <th>2022-01-02</th>\n",
       "      <th>2022-01-03</th>\n",
       "      <th>2022-01-04</th>\n",
       "      <th>...</th>\n",
       "      <th>consecutive_repeats</th>\n",
       "      <th>cleaned_제품특성</th>\n",
       "      <th>parsed_제품특성</th>\n",
       "      <th>combined_제품특성</th>\n",
       "      <th>tokenized_제품특성</th>\n",
       "      <th>tokenized_제품특성_cleaned</th>\n",
       "      <th>대분류:건강식품</th>\n",
       "      <th>대분류:뷰티</th>\n",
       "      <th>대분류:출산/유아동</th>\n",
       "      <th>대분류:유아 선크림</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>B002-00001-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0007</td>\n",
       "      <td>B002-C003-0038</td>\n",
       "      <td>B002-00001</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>헤어타입:모든 모발용 제품형태:스프레이형 주요제품특징:머릿결개선 주요제품특징:흡수력...</td>\n",
       "      <td>{'헤어타입': '모든', '모발용 제품형태': '스프레이형', '주요제품특징': ...</td>\n",
       "      <td>모든 스프레이형 흡수력 부드러운 윤기부여 영양공급 30ml 1개 50ml</td>\n",
       "      <td>모든 스프레이 흡수 윤기 부여 영양 공급 개</td>\n",
       "      <td>모든 스프레이 흡수 윤기 부여 영양 공급</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>16</td>\n",
       "      <td>B002-00005-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>피부타입:모든피부용 향계열:과일향 주요제품특징:향 주요제품특징:촉촉함 수분공급 용기...</td>\n",
       "      <td>{'피부타입': '모든피부용', '향계열': '과일향', '주요제품특징': '촉촉함...</td>\n",
       "      <td>모든피부용 과일향 촉촉함 펌프형 500ml 1개 500ml</td>\n",
       "      <td>피부 용 과일 향 펌프 개</td>\n",
       "      <td>피부 과일 펌프</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>17</td>\n",
       "      <td>B002-00005-00002</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>향계열:과일향 주요제품특징:향 용기형태:펌프형 :1개 500ml</td>\n",
       "      <td>{'향계열': '과일향', '주요제품특징': '향', '펌프형': '1개 500ml'}</td>\n",
       "      <td>과일향 향 1개 500ml</td>\n",
       "      <td>과일 향 향 개</td>\n",
       "      <td>과일</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>19</td>\n",
       "      <td>B002-00005-00004</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>형태:펌프형 용량:575ml :1개 형태:펌프형 용량:520ml :1개 형태:튜브형...</td>\n",
       "      <td>{'형태': '튜브형', '575ml': '1개', '520ml': '1개', '6...</td>\n",
       "      <td>튜브형 1개 1개 1개 575ml</td>\n",
       "      <td>튜브 개 개 개</td>\n",
       "      <td>튜브</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>20</td>\n",
       "      <td>B002-00005-00005</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0034</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>포장형태:캡형 특징:수분공급 용량:600ml :1개 포장형태:캡형 용량:600ml ...</td>\n",
       "      <td>{'포장형태': '캡형', '특징': '수분공급', '600ml': '1개 600ml'}</td>\n",
       "      <td>캡형 수분공급 1개 600ml</td>\n",
       "      <td>캡 수분 공급 개</td>\n",
       "      <td>수분 공급</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15812</th>\n",
       "      <td>15812</td>\n",
       "      <td>B002-03792-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0003</td>\n",
       "      <td>B002-C003-0015</td>\n",
       "      <td>B002-03792</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>종류특징특징특징가로사이즈세로사이즈최대길이 봉 :밀대 패드 용기타입용량포장수량특징특징...</td>\n",
       "      <td>{'종류특징특징특징가로사이즈세로사이즈최대길이 봉': '밀대', '패드 용기타입용량포...</td>\n",
       "      <td>밀대 기타 닦이 액세서리set 10kg</td>\n",
       "      <td>밀대 기타 액세서리</td>\n",
       "      <td>밀대 기타 액세서리</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15813</th>\n",
       "      <td>15813</td>\n",
       "      <td>B002-03793-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0007</td>\n",
       "      <td>B002-C003-0035</td>\n",
       "      <td>B002-03793</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>타입:일반샴푸 제품형태:펌프형 주요제품특징:세정력 세부제품특징:저자극 세부제품특징:...</td>\n",
       "      <td>{'타입': '일반샴푸', '제품형태': '펌프형', '주요제품특징': '세정력',...</td>\n",
       "      <td>일반샴푸 펌프형 세정력 모발윤기 1개 1500ml</td>\n",
       "      <td>일반 샴푸 펌프 정력 모발 윤기 개</td>\n",
       "      <td>일반 샴푸 펌프 정력 모발 윤기</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15814</th>\n",
       "      <td>15814</td>\n",
       "      <td>B002-03794-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0033</td>\n",
       "      <td>B002-03794</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>면도방식:습식 건식면도 헤드수:3헤드 헤드종류:고정헤드 충전시간:2시간 충전방식:C...</td>\n",
       "      <td>{'면도방식': '습식', '건식면도 헤드수': '3헤드', '헤드종류': '고정헤...</td>\n",
       "      <td>습식 3헤드 고정헤드 2시간 C타입 전체방수 잠금기능 배터리 구레나룻 케이블포함</td>\n",
       "      <td>습 헤드 고정 헤드 타입 전체 방수 기능 배터리 구레나룻 케이블 포함</td>\n",
       "      <td>헤드 고정 헤드 타입 전체 방수 기능 배터리 구레나룻 케이블 포함</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15815</th>\n",
       "      <td>15815</td>\n",
       "      <td>B002-03794-00002</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0033</td>\n",
       "      <td>B002-03794</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>품목:교체형면도날 개수:1개</td>\n",
       "      <td>{'품목': '교체형면도날', '개수': '1개'}</td>\n",
       "      <td>교체형면도날 1개</td>\n",
       "      <td>교체 면도날 개</td>\n",
       "      <td>교체 면도날</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15855</th>\n",
       "      <td>15855</td>\n",
       "      <td>B002-03798-00026</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0009</td>\n",
       "      <td>B002-C003-0049</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>종류:유아칫솔 단계별:2단계 칫솔모타입:부드러운모 특징:목찔림방지 재질:실리콘 최소...</td>\n",
       "      <td>{'종류': '손가락칫솔', '단계별': '2단계', '칫솔모타입': '부드러운모'...</td>\n",
       "      <td>손가락칫솔 2단계 부드러운모 목찔림방지 실리콘 1개 1개 2단계</td>\n",
       "      <td>손가락 칫솔 단계 모 목 방지 실리콘 개 개 단계</td>\n",
       "      <td>손가락 칫솔 단계 방지 실리콘 단계</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>7158 rows × 477 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          ID                제품             대분류             중분류  \\\n",
       "0          0  B002-00001-00001  B002-C001-0002  B002-C002-0007   \n",
       "16        16  B002-00005-00001  B002-C001-0002  B002-C002-0006   \n",
       "17        17  B002-00005-00002  B002-C001-0002  B002-C002-0006   \n",
       "19        19  B002-00005-00004  B002-C001-0002  B002-C002-0006   \n",
       "20        20  B002-00005-00005  B002-C001-0002  B002-C002-0006   \n",
       "...      ...               ...             ...             ...   \n",
       "15812  15812  B002-03792-00001  B002-C001-0002  B002-C002-0003   \n",
       "15813  15813  B002-03793-00001  B002-C001-0002  B002-C002-0007   \n",
       "15814  15814  B002-03794-00001  B002-C001-0002  B002-C002-0006   \n",
       "15815  15815  B002-03794-00002  B002-C001-0002  B002-C002-0006   \n",
       "15855  15855  B002-03798-00026  B002-C001-0002  B002-C002-0009   \n",
       "\n",
       "                  소분류         브랜드  2022-01-01  2022-01-02  2022-01-03  \\\n",
       "0      B002-C003-0038  B002-00001           0           0           0   \n",
       "16     B002-C003-0032  B002-00005           0           0           0   \n",
       "17     B002-C003-0032  B002-00005           0           0           0   \n",
       "19     B002-C003-0032  B002-00005           0           0           0   \n",
       "20     B002-C003-0034  B002-00005           0           0           0   \n",
       "...               ...         ...         ...         ...         ...   \n",
       "15812  B002-C003-0015  B002-03792           0           0           0   \n",
       "15813  B002-C003-0035  B002-03793           0           0           0   \n",
       "15814  B002-C003-0033  B002-03794           0           0           0   \n",
       "15815  B002-C003-0033  B002-03794           0           0           0   \n",
       "15855  B002-C003-0049  B002-03798           0           0           0   \n",
       "\n",
       "       2022-01-04  ...  consecutive_repeats  \\\n",
       "0               0  ...                  0.0   \n",
       "16              0  ...                  0.0   \n",
       "17              0  ...                  0.0   \n",
       "19              0  ...                  0.0   \n",
       "20              0  ...                  0.0   \n",
       "...           ...  ...                  ...   \n",
       "15812           0  ...                  0.0   \n",
       "15813           0  ...                  0.0   \n",
       "15814           0  ...                  0.0   \n",
       "15815           0  ...                  0.0   \n",
       "15855           1  ...                  0.0   \n",
       "\n",
       "                                            cleaned_제품특성  \\\n",
       "0      헤어타입:모든 모발용 제품형태:스프레이형 주요제품특징:머릿결개선 주요제품특징:흡수력...   \n",
       "16     피부타입:모든피부용 향계열:과일향 주요제품특징:향 주요제품특징:촉촉함 수분공급 용기...   \n",
       "17                   향계열:과일향 주요제품특징:향 용기형태:펌프형 :1개 500ml   \n",
       "19     형태:펌프형 용량:575ml :1개 형태:펌프형 용량:520ml :1개 형태:튜브형...   \n",
       "20     포장형태:캡형 특징:수분공급 용량:600ml :1개 포장형태:캡형 용량:600ml ...   \n",
       "...                                                  ...   \n",
       "15812  종류특징특징특징가로사이즈세로사이즈최대길이 봉 :밀대 패드 용기타입용량포장수량특징특징...   \n",
       "15813  타입:일반샴푸 제품형태:펌프형 주요제품특징:세정력 세부제품특징:저자극 세부제품특징:...   \n",
       "15814  면도방식:습식 건식면도 헤드수:3헤드 헤드종류:고정헤드 충전시간:2시간 충전방식:C...   \n",
       "15815                                    품목:교체형면도날 개수:1개   \n",
       "15855  종류:유아칫솔 단계별:2단계 칫솔모타입:부드러운모 특징:목찔림방지 재질:실리콘 최소...   \n",
       "\n",
       "                                             parsed_제품특성  \\\n",
       "0      {'헤어타입': '모든', '모발용 제품형태': '스프레이형', '주요제품특징': ...   \n",
       "16     {'피부타입': '모든피부용', '향계열': '과일향', '주요제품특징': '촉촉함...   \n",
       "17      {'향계열': '과일향', '주요제품특징': '향', '펌프형': '1개 500ml'}   \n",
       "19     {'형태': '튜브형', '575ml': '1개', '520ml': '1개', '6...   \n",
       "20     {'포장형태': '캡형', '특징': '수분공급', '600ml': '1개 600ml'}   \n",
       "...                                                  ...   \n",
       "15812  {'종류특징특징특징가로사이즈세로사이즈최대길이 봉': '밀대', '패드 용기타입용량포...   \n",
       "15813  {'타입': '일반샴푸', '제품형태': '펌프형', '주요제품특징': '세정력',...   \n",
       "15814  {'면도방식': '습식', '건식면도 헤드수': '3헤드', '헤드종류': '고정헤...   \n",
       "15815                       {'품목': '교체형면도날', '개수': '1개'}   \n",
       "15855  {'종류': '손가락칫솔', '단계별': '2단계', '칫솔모타입': '부드러운모'...   \n",
       "\n",
       "                                      combined_제품특성  \\\n",
       "0          모든 스프레이형 흡수력 부드러운 윤기부여 영양공급 30ml 1개 50ml   \n",
       "16                 모든피부용 과일향 촉촉함 펌프형 500ml 1개 500ml   \n",
       "17                                   과일향 향 1개 500ml   \n",
       "19                               튜브형 1개 1개 1개 575ml   \n",
       "20                                 캡형 수분공급 1개 600ml   \n",
       "...                                             ...   \n",
       "15812                         밀대 기타 닦이 액세서리set 10kg   \n",
       "15813                   일반샴푸 펌프형 세정력 모발윤기 1개 1500ml   \n",
       "15814  습식 3헤드 고정헤드 2시간 C타입 전체방수 잠금기능 배터리 구레나룻 케이블포함   \n",
       "15815                                     교체형면도날 1개   \n",
       "15855           손가락칫솔 2단계 부드러운모 목찔림방지 실리콘 1개 1개 2단계   \n",
       "\n",
       "                               tokenized_제품특성  \\\n",
       "0                    모든 스프레이 흡수 윤기 부여 영양 공급 개   \n",
       "16                             피부 용 과일 향 펌프 개   \n",
       "17                                   과일 향 향 개   \n",
       "19                                   튜브 개 개 개   \n",
       "20                                  캡 수분 공급 개   \n",
       "...                                       ...   \n",
       "15812                              밀대 기타 액세서리   \n",
       "15813                     일반 샴푸 펌프 정력 모발 윤기 개   \n",
       "15814  습 헤드 고정 헤드 타입 전체 방수 기능 배터리 구레나룻 케이블 포함   \n",
       "15815                                교체 면도날 개   \n",
       "15855             손가락 칫솔 단계 모 목 방지 실리콘 개 개 단계   \n",
       "\n",
       "                     tokenized_제품특성_cleaned  대분류:건강식품  대분류:뷰티  대분류:출산/유아동  \\\n",
       "0                    모든 스프레이 흡수 윤기 부여 영양 공급         0       1           0   \n",
       "16                                 피부 과일 펌프         0       1           0   \n",
       "17                                       과일         0       1           0   \n",
       "19                                       튜브         0       1           0   \n",
       "20                                    수분 공급         0       1           0   \n",
       "...                                     ...       ...     ...         ...   \n",
       "15812                            밀대 기타 액세서리         0       1           0   \n",
       "15813                     일반 샴푸 펌프 정력 모발 윤기         0       1           0   \n",
       "15814  헤드 고정 헤드 타입 전체 방수 기능 배터리 구레나룻 케이블 포함         0       1           0   \n",
       "15815                                교체 면도날         0       1           0   \n",
       "15855                   손가락 칫솔 단계 방지 실리콘 단계         0       1           0   \n",
       "\n",
       "       대분류:유아 선크림  \n",
       "0               0  \n",
       "16              0  \n",
       "17              0  \n",
       "19              0  \n",
       "20              0  \n",
       "...           ...  \n",
       "15812           0  \n",
       "15813           0  \n",
       "15814           0  \n",
       "15815           0  \n",
       "15855           0  \n",
       "\n",
       "[7158 rows x 477 columns]"
      ]
     },
     "execution_count": 105,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "filtered_data = merged[merged['대분류'] == 'B002-C001-0002']\n",
    "filtered_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 106,
   "id": "7d8afe13",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[('일반', 1568), ('펌프', 1455), ('모든', 1419), ('피부', 1396), ('영양', 1197), ('공급', 1029), ('샴푸', 965), ('자극', 829), ('상형', 734), ('윤기', 671), ('부여', 637), ('튜브', 615), ('케어', 572), ('기타', 533), ('모발', 512), ('흡수', 491), ('엠보싱', 486), ('두피', 486), ('효과', 364), ('크림', 359), ('단계', 353), ('개선', 335), ('날개', 331), ('머릿결', 319), ('기본', 307), ('헤드', 307), ('리필', 304), ('세트', 302), ('구성', 301), ('바디', 296), ('스프레이', 288), ('플라스틱', 286), ('무향', 280), ('계정수', 274), ('칫솔', 273), ('각질', 252), ('수분', 241), ('정력', 236), ('손상', 229), ('강화', 228), ('유아', 227), ('인증', 220), ('제거', 215), ('파라', 205), ('예방', 203), ('미세', 200), ('보습', 195), ('고정력', 188), ('충전', 188), ('산성', 187)]\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Karl\\AppData\\Local\\Temp\\ipykernel_29388\\605448823.py:2: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  filtered_data['tokenized_제품특성_cleaned'] = filtered_data['tokenized_제품특성_cleaned'].apply(lambda x: x.split() if isinstance(x, str) else [])\n"
     ]
    }
   ],
   "source": [
    "# Convert the space-separated string to a list by splitting by spaces\n",
    "filtered_data['tokenized_제품특성_cleaned'] = filtered_data['tokenized_제품특성_cleaned'].apply(lambda x: x.split() if isinstance(x, str) else [])\n",
    "\n",
    "# Now sum up all the token lists into a single list\n",
    "all_tokens = sum(filtered_data['tokenized_제품특성_cleaned'], [])\n",
    "\n",
    "# Proceed with counting the tokens\n",
    "from collections import Counter\n",
    "token_counts = Counter(all_tokens)\n",
    "\n",
    "# Identify the most common tokens\n",
    "most_common_tokens = token_counts.most_common(50)  # adjust the number as needed\n",
    "\n",
    "print(most_common_tokens)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 107,
   "id": "54b3b3cd",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Karl\\AppData\\Local\\Temp\\ipykernel_29388\\2477687216.py:2: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  merged['대분류:생활용품/뷰티'] = merged['대분류'].apply(lambda x: 1 if x == 'B002-C001-0002' else 0)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>제품</th>\n",
       "      <th>대분류</th>\n",
       "      <th>중분류</th>\n",
       "      <th>소분류</th>\n",
       "      <th>브랜드</th>\n",
       "      <th>2022-01-01</th>\n",
       "      <th>2022-01-02</th>\n",
       "      <th>2022-01-03</th>\n",
       "      <th>2022-01-04</th>\n",
       "      <th>...</th>\n",
       "      <th>consecutive_repeats</th>\n",
       "      <th>cleaned_제품특성</th>\n",
       "      <th>parsed_제품특성</th>\n",
       "      <th>combined_제품특성</th>\n",
       "      <th>tokenized_제품특성</th>\n",
       "      <th>tokenized_제품특성_cleaned</th>\n",
       "      <th>대분류:건강식품</th>\n",
       "      <th>대분류:출산/유아동</th>\n",
       "      <th>대분류:유아 선크림</th>\n",
       "      <th>대분류:생활용품/뷰티</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>B002-00001-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0007</td>\n",
       "      <td>B002-C003-0038</td>\n",
       "      <td>B002-00001</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>헤어타입:모든 모발용 제품형태:스프레이형 주요제품특징:머릿결개선 주요제품특징:흡수력...</td>\n",
       "      <td>{'헤어타입': '모든', '모발용 제품형태': '스프레이형', '주요제품특징': ...</td>\n",
       "      <td>모든 스프레이형 흡수력 부드러운 윤기부여 영양공급 30ml 1개 50ml</td>\n",
       "      <td>모든 스프레이 흡수 윤기 부여 영양 공급 개</td>\n",
       "      <td>모든 스프레이 흡수 윤기 부여 영양 공급</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>12</td>\n",
       "      <td>B002-00003-00009</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-00003</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>생균:100억 CFU 1일 총 섭취량:1캡슐 제품용량:1개월분 제품타입:캡슐 섭취횟...</td>\n",
       "      <td>{'생균': '100억', 'CFU 1일 총 섭취량': '1캡슐', '제품용량': ...</td>\n",
       "      <td>100억 1캡슐 1개월분 캡슐 하루 물과 성인남녀 체지방 감소 480mg x 30캡슐</td>\n",
       "      <td>캡슐 개월 캡슐 하루 물 성인 남녀 체지방 감소 캡슐</td>\n",
       "      <td>캡슐 개월 캡슐 하루 성인 남녀 체지방 감소 캡슐</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>16</td>\n",
       "      <td>B002-00005-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>피부타입:모든피부용 향계열:과일향 주요제품특징:향 주요제품특징:촉촉함 수분공급 용기...</td>\n",
       "      <td>{'피부타입': '모든피부용', '향계열': '과일향', '주요제품특징': '촉촉함...</td>\n",
       "      <td>모든피부용 과일향 촉촉함 펌프형 500ml 1개 500ml</td>\n",
       "      <td>피부 용 과일 향 펌프 개</td>\n",
       "      <td>피부 과일 펌프</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>17</td>\n",
       "      <td>B002-00005-00002</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>향계열:과일향 주요제품특징:향 용기형태:펌프형 :1개 500ml</td>\n",
       "      <td>{'향계열': '과일향', '주요제품특징': '향', '펌프형': '1개 500ml'}</td>\n",
       "      <td>과일향 향 1개 500ml</td>\n",
       "      <td>과일 향 향 개</td>\n",
       "      <td>과일</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>19</td>\n",
       "      <td>B002-00005-00004</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>형태:펌프형 용량:575ml :1개 형태:펌프형 용량:520ml :1개 형태:튜브형...</td>\n",
       "      <td>{'형태': '튜브형', '575ml': '1개', '520ml': '1개', '6...</td>\n",
       "      <td>튜브형 1개 1개 1개 575ml</td>\n",
       "      <td>튜브 개 개 개</td>\n",
       "      <td>튜브</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15877</th>\n",
       "      <td>15877</td>\n",
       "      <td>B002-03798-00049</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>재질:실리콘 재질:기타</td>\n",
       "      <td>{'재질': '기타'}</td>\n",
       "      <td>기타</td>\n",
       "      <td>기타</td>\n",
       "      <td>기타</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15882</th>\n",
       "      <td>15882</td>\n",
       "      <td>B002-03798-00054</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>형태:빨대형 용량:300ml 특징:양손잡이 특징:보온보냉 특징:샘방지 흘림방지 재질...</td>\n",
       "      <td>{'형태': '빨대형', '용량': '300ml', '특징': '양손잡이', '흘림...</td>\n",
       "      <td>빨대형 300ml 양손잡이 PE 스테인리스스틸</td>\n",
       "      <td>빨대 양손잡이 스테인리스 스틸</td>\n",
       "      <td>빨대 양손잡이 스테인리스 스틸</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15883</th>\n",
       "      <td>15883</td>\n",
       "      <td>B002-03798-00055</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>형태:머그형 용량:240ml 특징:양손잡이 특징:미끄럼방지 특징:비스페놀A BPA ...</td>\n",
       "      <td>{'형태': '머그형', '용량': '240ml', '특징': '미끄럼방지', 'B...</td>\n",
       "      <td>머그형 240ml 미끄럼방지 ABS 스테인리스스틸</td>\n",
       "      <td>머그 미끄럼 방지 스테인리스 스틸</td>\n",
       "      <td>머그 미끄럼 방지 스테인리스 스틸</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15887</th>\n",
       "      <td>15887</td>\n",
       "      <td>B002-03799-00004</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG508S3</td>\n",
       "      <td>{'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...</td>\n",
       "      <td>이유식보관용기 전자레인지사용 실리콘 3개세트 LLG508S3</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 개 세트</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 세트</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15888</th>\n",
       "      <td>15888</td>\n",
       "      <td>B002-03799-00005</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG509S3</td>\n",
       "      <td>{'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...</td>\n",
       "      <td>이유식보관용기 전자레인지사용 실리콘 3개세트 LLG509S3</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 개 세트</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 세트</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10481 rows × 477 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          ID                제품             대분류             중분류  \\\n",
       "0          0  B002-00001-00001  B002-C001-0002  B002-C002-0007   \n",
       "12        12  B002-00003-00009  B002-C001-0001  B002-C002-0001   \n",
       "16        16  B002-00005-00001  B002-C001-0002  B002-C002-0006   \n",
       "17        17  B002-00005-00002  B002-C001-0002  B002-C002-0006   \n",
       "19        19  B002-00005-00004  B002-C001-0002  B002-C002-0006   \n",
       "...      ...               ...             ...             ...   \n",
       "15877  15877  B002-03798-00049  B002-C001-0003  B002-C002-0008   \n",
       "15882  15882  B002-03798-00054  B002-C001-0003  B002-C002-0008   \n",
       "15883  15883  B002-03798-00055  B002-C001-0003  B002-C002-0008   \n",
       "15887  15887  B002-03799-00004  B002-C001-0003  B002-C002-0008   \n",
       "15888  15888  B002-03799-00005  B002-C001-0003  B002-C002-0008   \n",
       "\n",
       "                  소분류         브랜드  2022-01-01  2022-01-02  2022-01-03  \\\n",
       "0      B002-C003-0038  B002-00001           0           0           0   \n",
       "12     B002-C003-0003  B002-00003           0           0           0   \n",
       "16     B002-C003-0032  B002-00005           0           0           0   \n",
       "17     B002-C003-0032  B002-00005           0           0           0   \n",
       "19     B002-C003-0032  B002-00005           0           0           0   \n",
       "...               ...         ...         ...         ...         ...   \n",
       "15877  B002-C003-0044  B002-03798           0           0           0   \n",
       "15882  B002-C003-0044  B002-03798           0           0           0   \n",
       "15883  B002-C003-0044  B002-03798           0           0           0   \n",
       "15887  B002-C003-0044  B002-03799           0           0           0   \n",
       "15888  B002-C003-0044  B002-03799           0           0           0   \n",
       "\n",
       "       2022-01-04  ...  consecutive_repeats  \\\n",
       "0               0  ...                  0.0   \n",
       "12              0  ...                  0.0   \n",
       "16              0  ...                  0.0   \n",
       "17              0  ...                  0.0   \n",
       "19              0  ...                  0.0   \n",
       "...           ...  ...                  ...   \n",
       "15877           0  ...                  0.0   \n",
       "15882           0  ...                  0.0   \n",
       "15883           0  ...                  0.0   \n",
       "15887           0  ...                  0.0   \n",
       "15888           0  ...                  0.0   \n",
       "\n",
       "                                            cleaned_제품특성  \\\n",
       "0      헤어타입:모든 모발용 제품형태:스프레이형 주요제품특징:머릿결개선 주요제품특징:흡수력...   \n",
       "12     생균:100억 CFU 1일 총 섭취량:1캡슐 제품용량:1개월분 제품타입:캡슐 섭취횟...   \n",
       "16     피부타입:모든피부용 향계열:과일향 주요제품특징:향 주요제품특징:촉촉함 수분공급 용기...   \n",
       "17                   향계열:과일향 주요제품특징:향 용기형태:펌프형 :1개 500ml   \n",
       "19     형태:펌프형 용량:575ml :1개 형태:펌프형 용량:520ml :1개 형태:튜브형...   \n",
       "...                                                  ...   \n",
       "15877                                       재질:실리콘 재질:기타   \n",
       "15882  형태:빨대형 용량:300ml 특징:양손잡이 특징:보온보냉 특징:샘방지 흘림방지 재질...   \n",
       "15883  형태:머그형 용량:240ml 특징:양손잡이 특징:미끄럼방지 특징:비스페놀A BPA ...   \n",
       "15887         종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG508S3   \n",
       "15888         종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG509S3   \n",
       "\n",
       "                                             parsed_제품특성  \\\n",
       "0      {'헤어타입': '모든', '모발용 제품형태': '스프레이형', '주요제품특징': ...   \n",
       "12     {'생균': '100억', 'CFU 1일 총 섭취량': '1캡슐', '제품용량': ...   \n",
       "16     {'피부타입': '모든피부용', '향계열': '과일향', '주요제품특징': '촉촉함...   \n",
       "17      {'향계열': '과일향', '주요제품특징': '향', '펌프형': '1개 500ml'}   \n",
       "19     {'형태': '튜브형', '575ml': '1개', '520ml': '1개', '6...   \n",
       "...                                                  ...   \n",
       "15877                                       {'재질': '기타'}   \n",
       "15882  {'형태': '빨대형', '용량': '300ml', '특징': '양손잡이', '흘림...   \n",
       "15883  {'형태': '머그형', '용량': '240ml', '특징': '미끄럼방지', 'B...   \n",
       "15887  {'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...   \n",
       "15888  {'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...   \n",
       "\n",
       "                                         combined_제품특성  \\\n",
       "0             모든 스프레이형 흡수력 부드러운 윤기부여 영양공급 30ml 1개 50ml   \n",
       "12     100억 1캡슐 1개월분 캡슐 하루 물과 성인남녀 체지방 감소 480mg x 30캡슐   \n",
       "16                    모든피부용 과일향 촉촉함 펌프형 500ml 1개 500ml   \n",
       "17                                      과일향 향 1개 500ml   \n",
       "19                                  튜브형 1개 1개 1개 575ml   \n",
       "...                                                ...   \n",
       "15877                                               기타   \n",
       "15882                        빨대형 300ml 양손잡이 PE 스테인리스스틸   \n",
       "15883                      머그형 240ml 미끄럼방지 ABS 스테인리스스틸   \n",
       "15887                이유식보관용기 전자레인지사용 실리콘 3개세트 LLG508S3   \n",
       "15888                이유식보관용기 전자레인지사용 실리콘 3개세트 LLG509S3   \n",
       "\n",
       "                      tokenized_제품특성       tokenized_제품특성_cleaned  대분류:건강식품  \\\n",
       "0           모든 스프레이 흡수 윤기 부여 영양 공급 개       모든 스프레이 흡수 윤기 부여 영양 공급         0   \n",
       "12     캡슐 개월 캡슐 하루 물 성인 남녀 체지방 감소 캡슐  캡슐 개월 캡슐 하루 성인 남녀 체지방 감소 캡슐         1   \n",
       "16                    피부 용 과일 향 펌프 개                     피부 과일 펌프         0   \n",
       "17                          과일 향 향 개                           과일         0   \n",
       "19                          튜브 개 개 개                           튜브         0   \n",
       "...                              ...                          ...       ...   \n",
       "15877                             기타                           기타         0   \n",
       "15882               빨대 양손잡이 스테인리스 스틸             빨대 양손잡이 스테인리스 스틸         0   \n",
       "15883             머그 미끄럼 방지 스테인리스 스틸           머그 미끄럼 방지 스테인리스 스틸         0   \n",
       "15887    이유식 보관 용기 전자레인지 사용 실리콘 개 세트    이유식 보관 용기 전자레인지 사용 실리콘 세트         0   \n",
       "15888    이유식 보관 용기 전자레인지 사용 실리콘 개 세트    이유식 보관 용기 전자레인지 사용 실리콘 세트         0   \n",
       "\n",
       "       대분류:출산/유아동  대분류:유아 선크림  대분류:생활용품/뷰티  \n",
       "0               0           0            1  \n",
       "12              0           0            0  \n",
       "16              0           0            1  \n",
       "17              0           0            1  \n",
       "19              0           0            1  \n",
       "...           ...         ...          ...  \n",
       "15877           1           0            0  \n",
       "15882           1           0            0  \n",
       "15883           1           0            0  \n",
       "15887           1           0            0  \n",
       "15888           1           0            0  \n",
       "\n",
       "[10481 rows x 477 columns]"
      ]
     },
     "execution_count": 107,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "del merged['대분류:뷰티']\n",
    "merged['대분류:생활용품/뷰티'] = merged['대분류'].apply(lambda x: 1 if x == 'B002-C001-0002' else 0)\n",
    "merged"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 90,
   "id": "d711e9fd",
   "metadata": {},
   "outputs": [],
   "source": [
    "major_category = {'B002-C001-0001': '건강식품', 'B002-C001-0002':'뷰티/생활용품'}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 91,
   "id": "2d486d13",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[('실리콘', 53), ('비스페놀', 45), ('방지', 45), ('젖병', 37), ('빨대', 30), ('소재', 26), ('신생아', 22), ('단계', 21), ('배앓이', 20), ('세트', 18), ('일반', 17), ('전자레인지', 17), ('상형', 15), ('자외선', 14), ('와이드', 13), ('베이비', 13), ('기타', 13), ('기능', 12), ('보관', 11), ('피부', 11), ('용기', 10), ('열탕', 10), ('유선형', 10), ('몸체', 10), ('개월', 10), ('이탄', 9), ('모유', 9), ('실감', 9), ('멸균', 9), ('스테인리스', 9)]\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Karl\\AppData\\Local\\Temp\\ipykernel_29388\\3221042431.py:3: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  filtered_data['tokenized_제품특성_cleaned'] = filtered_data['tokenized_제품특성_cleaned'].apply(lambda x: x.split() if isinstance(x, str) else [])\n"
     ]
    }
   ],
   "source": [
    "filtered_data = merged[merged['대분류'] == 'B002-C001-0003']\n",
    "# Convert the space-separated string to a list by splitting by spaces\n",
    "filtered_data['tokenized_제품특성_cleaned'] = filtered_data['tokenized_제품특성_cleaned'].apply(lambda x: x.split() if isinstance(x, str) else [])\n",
    "\n",
    "# Now sum up all the token lists into a single list\n",
    "all_tokens = sum(filtered_data['tokenized_제품특성_cleaned'], [])\n",
    "\n",
    "# Proceed with counting the tokens\n",
    "from collections import Counter\n",
    "token_counts = Counter(all_tokens)\n",
    "\n",
    "# Identify the most common tokens\n",
    "most_common_tokens = token_counts.most_common(30)  # adjust the number as needed\n",
    "\n",
    "print(most_common_tokens)\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 92,
   "id": "098917b8",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Karl\\AppData\\Local\\Temp\\ipykernel_29388\\1006270654.py:1: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  merged['대분류:출산/유아동'] = merged['대분류'].apply(lambda x: 1 if x == 'B002-C001-0003' else 0)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>제품</th>\n",
       "      <th>대분류</th>\n",
       "      <th>중분류</th>\n",
       "      <th>소분류</th>\n",
       "      <th>브랜드</th>\n",
       "      <th>2022-01-01</th>\n",
       "      <th>2022-01-02</th>\n",
       "      <th>2022-01-03</th>\n",
       "      <th>2022-01-04</th>\n",
       "      <th>...</th>\n",
       "      <th>desc_length</th>\n",
       "      <th>consecutive_repeats</th>\n",
       "      <th>cleaned_제품특성</th>\n",
       "      <th>parsed_제품특성</th>\n",
       "      <th>combined_제품특성</th>\n",
       "      <th>tokenized_제품특성</th>\n",
       "      <th>tokenized_제품특성_cleaned</th>\n",
       "      <th>대분류:건강식품</th>\n",
       "      <th>대분류:뷰티</th>\n",
       "      <th>대분류:출산/유아동</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>B002-00001-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0007</td>\n",
       "      <td>B002-C003-0038</td>\n",
       "      <td>B002-00001</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>13.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>헤어타입:모든 모발용 제품형태:스프레이형 주요제품특징:머릿결개선 주요제품특징:흡수력...</td>\n",
       "      <td>{'헤어타입': '모든', '모발용 제품형태': '스프레이형', '주요제품특징': ...</td>\n",
       "      <td>모든 스프레이형 흡수력 부드러운 윤기부여 영양공급 30ml 1개 50ml</td>\n",
       "      <td>모든 스프레이 흡수 윤기 부여 영양 공급 개</td>\n",
       "      <td>모든 스프레이 흡수 윤기 부여 영양 공급</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>12</td>\n",
       "      <td>B002-00003-00009</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-00003</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>19.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>생균:100억 CFU 1일 총 섭취량:1캡슐 제품용량:1개월분 제품타입:캡슐 섭취횟...</td>\n",
       "      <td>{'생균': '100억', 'CFU 1일 총 섭취량': '1캡슐', '제품용량': ...</td>\n",
       "      <td>100억 1캡슐 1개월분 캡슐 하루 물과 성인남녀 체지방 감소 480mg x 30캡슐</td>\n",
       "      <td>캡슐 개월 캡슐 하루 물 성인 남녀 체지방 감소 캡슐</td>\n",
       "      <td>캡슐 개월 캡슐 하루 성인 남녀 체지방 감소 캡슐</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>16</td>\n",
       "      <td>B002-00005-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>8.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>피부타입:모든피부용 향계열:과일향 주요제품특징:향 주요제품특징:촉촉함 수분공급 용기...</td>\n",
       "      <td>{'피부타입': '모든피부용', '향계열': '과일향', '주요제품특징': '촉촉함...</td>\n",
       "      <td>모든피부용 과일향 촉촉함 펌프형 500ml 1개 500ml</td>\n",
       "      <td>피부 용 과일 향 펌프 개</td>\n",
       "      <td>피부 과일 펌프</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>17</td>\n",
       "      <td>B002-00005-00002</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>향계열:과일향 주요제품특징:향 용기형태:펌프형 :1개 500ml</td>\n",
       "      <td>{'향계열': '과일향', '주요제품특징': '향', '펌프형': '1개 500ml'}</td>\n",
       "      <td>과일향 향 1개 500ml</td>\n",
       "      <td>과일 향 향 개</td>\n",
       "      <td>과일</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>19</td>\n",
       "      <td>B002-00005-00004</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>형태:펌프형 용량:575ml :1개 형태:펌프형 용량:520ml :1개 형태:튜브형...</td>\n",
       "      <td>{'형태': '튜브형', '575ml': '1개', '520ml': '1개', '6...</td>\n",
       "      <td>튜브형 1개 1개 1개 575ml</td>\n",
       "      <td>튜브 개 개 개</td>\n",
       "      <td>튜브</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15877</th>\n",
       "      <td>15877</td>\n",
       "      <td>B002-03798-00049</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>재질:실리콘 재질:기타</td>\n",
       "      <td>{'재질': '기타'}</td>\n",
       "      <td>기타</td>\n",
       "      <td>기타</td>\n",
       "      <td>기타</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15882</th>\n",
       "      <td>15882</td>\n",
       "      <td>B002-03798-00054</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>28.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>형태:빨대형 용량:300ml 특징:양손잡이 특징:보온보냉 특징:샘방지 흘림방지 재질...</td>\n",
       "      <td>{'형태': '빨대형', '용량': '300ml', '특징': '양손잡이', '흘림...</td>\n",
       "      <td>빨대형 300ml 양손잡이 PE 스테인리스스틸</td>\n",
       "      <td>빨대 양손잡이 스테인리스 스틸</td>\n",
       "      <td>빨대 양손잡이 스테인리스 스틸</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15883</th>\n",
       "      <td>15883</td>\n",
       "      <td>B002-03798-00055</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>21.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>형태:머그형 용량:240ml 특징:양손잡이 특징:미끄럼방지 특징:비스페놀A BPA ...</td>\n",
       "      <td>{'형태': '머그형', '용량': '240ml', '특징': '미끄럼방지', 'B...</td>\n",
       "      <td>머그형 240ml 미끄럼방지 ABS 스테인리스스틸</td>\n",
       "      <td>머그 미끄럼 방지 스테인리스 스틸</td>\n",
       "      <td>머그 미끄럼 방지 스테인리스 스틸</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15887</th>\n",
       "      <td>15887</td>\n",
       "      <td>B002-03799-00004</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG508S3</td>\n",
       "      <td>{'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...</td>\n",
       "      <td>이유식보관용기 전자레인지사용 실리콘 3개세트 LLG508S3</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 개 세트</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 세트</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15888</th>\n",
       "      <td>15888</td>\n",
       "      <td>B002-03799-00005</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG509S3</td>\n",
       "      <td>{'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...</td>\n",
       "      <td>이유식보관용기 전자레인지사용 실리콘 3개세트 LLG509S3</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 개 세트</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 세트</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10481 rows × 476 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          ID                제품             대분류             중분류  \\\n",
       "0          0  B002-00001-00001  B002-C001-0002  B002-C002-0007   \n",
       "12        12  B002-00003-00009  B002-C001-0001  B002-C002-0001   \n",
       "16        16  B002-00005-00001  B002-C001-0002  B002-C002-0006   \n",
       "17        17  B002-00005-00002  B002-C001-0002  B002-C002-0006   \n",
       "19        19  B002-00005-00004  B002-C001-0002  B002-C002-0006   \n",
       "...      ...               ...             ...             ...   \n",
       "15877  15877  B002-03798-00049  B002-C001-0003  B002-C002-0008   \n",
       "15882  15882  B002-03798-00054  B002-C001-0003  B002-C002-0008   \n",
       "15883  15883  B002-03798-00055  B002-C001-0003  B002-C002-0008   \n",
       "15887  15887  B002-03799-00004  B002-C001-0003  B002-C002-0008   \n",
       "15888  15888  B002-03799-00005  B002-C001-0003  B002-C002-0008   \n",
       "\n",
       "                  소분류         브랜드  2022-01-01  2022-01-02  2022-01-03  \\\n",
       "0      B002-C003-0038  B002-00001           0           0           0   \n",
       "12     B002-C003-0003  B002-00003           0           0           0   \n",
       "16     B002-C003-0032  B002-00005           0           0           0   \n",
       "17     B002-C003-0032  B002-00005           0           0           0   \n",
       "19     B002-C003-0032  B002-00005           0           0           0   \n",
       "...               ...         ...         ...         ...         ...   \n",
       "15877  B002-C003-0044  B002-03798           0           0           0   \n",
       "15882  B002-C003-0044  B002-03798           0           0           0   \n",
       "15883  B002-C003-0044  B002-03798           0           0           0   \n",
       "15887  B002-C003-0044  B002-03799           0           0           0   \n",
       "15888  B002-C003-0044  B002-03799           0           0           0   \n",
       "\n",
       "       2022-01-04  ...  desc_length  consecutive_repeats  \\\n",
       "0               0  ...         13.0                  0.0   \n",
       "12              0  ...         19.0                  0.0   \n",
       "16              0  ...          8.0                  0.0   \n",
       "17              0  ...          5.0                  0.0   \n",
       "19              0  ...         10.0                  0.0   \n",
       "...           ...  ...          ...                  ...   \n",
       "15877           0  ...          2.0                  0.0   \n",
       "15882           0  ...         28.0                  0.0   \n",
       "15883           0  ...         21.0                  0.0   \n",
       "15887           0  ...          5.0                  0.0   \n",
       "15888           0  ...          5.0                  0.0   \n",
       "\n",
       "                                            cleaned_제품특성  \\\n",
       "0      헤어타입:모든 모발용 제품형태:스프레이형 주요제품특징:머릿결개선 주요제품특징:흡수력...   \n",
       "12     생균:100억 CFU 1일 총 섭취량:1캡슐 제품용량:1개월분 제품타입:캡슐 섭취횟...   \n",
       "16     피부타입:모든피부용 향계열:과일향 주요제품특징:향 주요제품특징:촉촉함 수분공급 용기...   \n",
       "17                   향계열:과일향 주요제품특징:향 용기형태:펌프형 :1개 500ml   \n",
       "19     형태:펌프형 용량:575ml :1개 형태:펌프형 용량:520ml :1개 형태:튜브형...   \n",
       "...                                                  ...   \n",
       "15877                                       재질:실리콘 재질:기타   \n",
       "15882  형태:빨대형 용량:300ml 특징:양손잡이 특징:보온보냉 특징:샘방지 흘림방지 재질...   \n",
       "15883  형태:머그형 용량:240ml 특징:양손잡이 특징:미끄럼방지 특징:비스페놀A BPA ...   \n",
       "15887         종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG508S3   \n",
       "15888         종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG509S3   \n",
       "\n",
       "                                             parsed_제품특성  \\\n",
       "0      {'헤어타입': '모든', '모발용 제품형태': '스프레이형', '주요제품특징': ...   \n",
       "12     {'생균': '100억', 'CFU 1일 총 섭취량': '1캡슐', '제품용량': ...   \n",
       "16     {'피부타입': '모든피부용', '향계열': '과일향', '주요제품특징': '촉촉함...   \n",
       "17      {'향계열': '과일향', '주요제품특징': '향', '펌프형': '1개 500ml'}   \n",
       "19     {'형태': '튜브형', '575ml': '1개', '520ml': '1개', '6...   \n",
       "...                                                  ...   \n",
       "15877                                       {'재질': '기타'}   \n",
       "15882  {'형태': '빨대형', '용량': '300ml', '특징': '양손잡이', '흘림...   \n",
       "15883  {'형태': '머그형', '용량': '240ml', '특징': '미끄럼방지', 'B...   \n",
       "15887  {'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...   \n",
       "15888  {'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...   \n",
       "\n",
       "                                         combined_제품특성  \\\n",
       "0             모든 스프레이형 흡수력 부드러운 윤기부여 영양공급 30ml 1개 50ml   \n",
       "12     100억 1캡슐 1개월분 캡슐 하루 물과 성인남녀 체지방 감소 480mg x 30캡슐   \n",
       "16                    모든피부용 과일향 촉촉함 펌프형 500ml 1개 500ml   \n",
       "17                                      과일향 향 1개 500ml   \n",
       "19                                  튜브형 1개 1개 1개 575ml   \n",
       "...                                                ...   \n",
       "15877                                               기타   \n",
       "15882                        빨대형 300ml 양손잡이 PE 스테인리스스틸   \n",
       "15883                      머그형 240ml 미끄럼방지 ABS 스테인리스스틸   \n",
       "15887                이유식보관용기 전자레인지사용 실리콘 3개세트 LLG508S3   \n",
       "15888                이유식보관용기 전자레인지사용 실리콘 3개세트 LLG509S3   \n",
       "\n",
       "                      tokenized_제품특성       tokenized_제품특성_cleaned  대분류:건강식품  \\\n",
       "0           모든 스프레이 흡수 윤기 부여 영양 공급 개       모든 스프레이 흡수 윤기 부여 영양 공급         0   \n",
       "12     캡슐 개월 캡슐 하루 물 성인 남녀 체지방 감소 캡슐  캡슐 개월 캡슐 하루 성인 남녀 체지방 감소 캡슐         1   \n",
       "16                    피부 용 과일 향 펌프 개                     피부 과일 펌프         0   \n",
       "17                          과일 향 향 개                           과일         0   \n",
       "19                          튜브 개 개 개                           튜브         0   \n",
       "...                              ...                          ...       ...   \n",
       "15877                             기타                           기타         0   \n",
       "15882               빨대 양손잡이 스테인리스 스틸             빨대 양손잡이 스테인리스 스틸         0   \n",
       "15883             머그 미끄럼 방지 스테인리스 스틸           머그 미끄럼 방지 스테인리스 스틸         0   \n",
       "15887    이유식 보관 용기 전자레인지 사용 실리콘 개 세트    이유식 보관 용기 전자레인지 사용 실리콘 세트         0   \n",
       "15888    이유식 보관 용기 전자레인지 사용 실리콘 개 세트    이유식 보관 용기 전자레인지 사용 실리콘 세트         0   \n",
       "\n",
       "       대분류:뷰티  대분류:출산/유아동  \n",
       "0           1           0  \n",
       "12          0           0  \n",
       "16          1           0  \n",
       "17          1           0  \n",
       "19          1           0  \n",
       "...       ...         ...  \n",
       "15877       0           1  \n",
       "15882       0           1  \n",
       "15883       0           1  \n",
       "15887       0           1  \n",
       "15888       0           1  \n",
       "\n",
       "[10481 rows x 476 columns]"
      ]
     },
     "execution_count": 92,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merged['대분류:출산/유아동'] = merged['대분류'].apply(lambda x: 1 if x == 'B002-C001-0003' else 0)\n",
    "merged"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 93,
   "id": "34cf2c40",
   "metadata": {},
   "outputs": [],
   "source": [
    "major_category = {'B002-C001-0001': '건강식품', 'B002-C001-0002':'뷰티', 'B002-C001-0003':'출산/유아동'}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 94,
   "id": "08b58795",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[('유아', 87), ('선크림', 59), ('자극', 58), ('공급', 54), ('피부', 48), ('스틱', 39), ('수분', 30), ('튜브', 28), ('영양', 24), ('페이스', 22), ('진정', 20), ('쿠션', 19), ('세트', 18), ('콤팩트', 16), ('무벤조페논', 12), ('로션', 10), ('오일', 10), ('프리', 10), ('무향', 8), ('무기', 8), ('장벽', 7), ('강화', 7), ('현상', 5), ('방지', 5), ('리필', 4), ('밀착', 4), ('어린이', 3), ('겸용', 3), ('쿨링감', 3), ('보정', 3)]\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Karl\\AppData\\Local\\Temp\\ipykernel_29388\\3023293417.py:3: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  filtered_data['tokenized_제품특성_cleaned'] = filtered_data['tokenized_제품특성_cleaned'].apply(lambda x: x.split() if isinstance(x, str) else [])\n"
     ]
    }
   ],
   "source": [
    "filtered_data = merged[merged['대분류'] == 'B002-C001-0004']\n",
    "# Convert the space-separated string to a list by splitting by spaces\n",
    "filtered_data['tokenized_제품특성_cleaned'] = filtered_data['tokenized_제품특성_cleaned'].apply(lambda x: x.split() if isinstance(x, str) else [])\n",
    "\n",
    "# Now sum up all the token lists into a single list\n",
    "all_tokens = sum(filtered_data['tokenized_제품특성_cleaned'], [])\n",
    "\n",
    "# Proceed with counting the tokens\n",
    "from collections import Counter\n",
    "token_counts = Counter(all_tokens)\n",
    "\n",
    "# Identify the most common tokens\n",
    "most_common_tokens = token_counts.most_common(30)  # adjust the number as needed\n",
    "\n",
    "print(most_common_tokens)\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 97,
   "id": "9bbff12e",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Karl\\AppData\\Local\\Temp\\ipykernel_29388\\2493734012.py:1: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  merged['대분류:유아 선크림'] = merged['대분류'].apply(lambda x: 1 if x == 'B002-C001-0004' else 0)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>제품</th>\n",
       "      <th>대분류</th>\n",
       "      <th>중분류</th>\n",
       "      <th>소분류</th>\n",
       "      <th>브랜드</th>\n",
       "      <th>2022-01-01</th>\n",
       "      <th>2022-01-02</th>\n",
       "      <th>2022-01-03</th>\n",
       "      <th>2022-01-04</th>\n",
       "      <th>...</th>\n",
       "      <th>consecutive_repeats</th>\n",
       "      <th>cleaned_제품특성</th>\n",
       "      <th>parsed_제품특성</th>\n",
       "      <th>combined_제품특성</th>\n",
       "      <th>tokenized_제품특성</th>\n",
       "      <th>tokenized_제품특성_cleaned</th>\n",
       "      <th>대분류:건강식품</th>\n",
       "      <th>대분류:뷰티</th>\n",
       "      <th>대분류:출산/유아동</th>\n",
       "      <th>대분류:유아 선크림</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>B002-00001-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0007</td>\n",
       "      <td>B002-C003-0038</td>\n",
       "      <td>B002-00001</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>헤어타입:모든 모발용 제품형태:스프레이형 주요제품특징:머릿결개선 주요제품특징:흡수력...</td>\n",
       "      <td>{'헤어타입': '모든', '모발용 제품형태': '스프레이형', '주요제품특징': ...</td>\n",
       "      <td>모든 스프레이형 흡수력 부드러운 윤기부여 영양공급 30ml 1개 50ml</td>\n",
       "      <td>모든 스프레이 흡수 윤기 부여 영양 공급 개</td>\n",
       "      <td>모든 스프레이 흡수 윤기 부여 영양 공급</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>12</td>\n",
       "      <td>B002-00003-00009</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-00003</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>생균:100억 CFU 1일 총 섭취량:1캡슐 제품용량:1개월분 제품타입:캡슐 섭취횟...</td>\n",
       "      <td>{'생균': '100억', 'CFU 1일 총 섭취량': '1캡슐', '제품용량': ...</td>\n",
       "      <td>100억 1캡슐 1개월분 캡슐 하루 물과 성인남녀 체지방 감소 480mg x 30캡슐</td>\n",
       "      <td>캡슐 개월 캡슐 하루 물 성인 남녀 체지방 감소 캡슐</td>\n",
       "      <td>캡슐 개월 캡슐 하루 성인 남녀 체지방 감소 캡슐</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>16</td>\n",
       "      <td>B002-00005-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>피부타입:모든피부용 향계열:과일향 주요제품특징:향 주요제품특징:촉촉함 수분공급 용기...</td>\n",
       "      <td>{'피부타입': '모든피부용', '향계열': '과일향', '주요제품특징': '촉촉함...</td>\n",
       "      <td>모든피부용 과일향 촉촉함 펌프형 500ml 1개 500ml</td>\n",
       "      <td>피부 용 과일 향 펌프 개</td>\n",
       "      <td>피부 과일 펌프</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>17</td>\n",
       "      <td>B002-00005-00002</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>향계열:과일향 주요제품특징:향 용기형태:펌프형 :1개 500ml</td>\n",
       "      <td>{'향계열': '과일향', '주요제품특징': '향', '펌프형': '1개 500ml'}</td>\n",
       "      <td>과일향 향 1개 500ml</td>\n",
       "      <td>과일 향 향 개</td>\n",
       "      <td>과일</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>19</td>\n",
       "      <td>B002-00005-00004</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>형태:펌프형 용량:575ml :1개 형태:펌프형 용량:520ml :1개 형태:튜브형...</td>\n",
       "      <td>{'형태': '튜브형', '575ml': '1개', '520ml': '1개', '6...</td>\n",
       "      <td>튜브형 1개 1개 1개 575ml</td>\n",
       "      <td>튜브 개 개 개</td>\n",
       "      <td>튜브</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15877</th>\n",
       "      <td>15877</td>\n",
       "      <td>B002-03798-00049</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>재질:실리콘 재질:기타</td>\n",
       "      <td>{'재질': '기타'}</td>\n",
       "      <td>기타</td>\n",
       "      <td>기타</td>\n",
       "      <td>기타</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15882</th>\n",
       "      <td>15882</td>\n",
       "      <td>B002-03798-00054</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>형태:빨대형 용량:300ml 특징:양손잡이 특징:보온보냉 특징:샘방지 흘림방지 재질...</td>\n",
       "      <td>{'형태': '빨대형', '용량': '300ml', '특징': '양손잡이', '흘림...</td>\n",
       "      <td>빨대형 300ml 양손잡이 PE 스테인리스스틸</td>\n",
       "      <td>빨대 양손잡이 스테인리스 스틸</td>\n",
       "      <td>빨대 양손잡이 스테인리스 스틸</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15883</th>\n",
       "      <td>15883</td>\n",
       "      <td>B002-03798-00055</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>형태:머그형 용량:240ml 특징:양손잡이 특징:미끄럼방지 특징:비스페놀A BPA ...</td>\n",
       "      <td>{'형태': '머그형', '용량': '240ml', '특징': '미끄럼방지', 'B...</td>\n",
       "      <td>머그형 240ml 미끄럼방지 ABS 스테인리스스틸</td>\n",
       "      <td>머그 미끄럼 방지 스테인리스 스틸</td>\n",
       "      <td>머그 미끄럼 방지 스테인리스 스틸</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15887</th>\n",
       "      <td>15887</td>\n",
       "      <td>B002-03799-00004</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG508S3</td>\n",
       "      <td>{'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...</td>\n",
       "      <td>이유식보관용기 전자레인지사용 실리콘 3개세트 LLG508S3</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 개 세트</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 세트</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15888</th>\n",
       "      <td>15888</td>\n",
       "      <td>B002-03799-00005</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG509S3</td>\n",
       "      <td>{'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...</td>\n",
       "      <td>이유식보관용기 전자레인지사용 실리콘 3개세트 LLG509S3</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 개 세트</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 세트</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10481 rows × 477 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          ID                제품             대분류             중분류  \\\n",
       "0          0  B002-00001-00001  B002-C001-0002  B002-C002-0007   \n",
       "12        12  B002-00003-00009  B002-C001-0001  B002-C002-0001   \n",
       "16        16  B002-00005-00001  B002-C001-0002  B002-C002-0006   \n",
       "17        17  B002-00005-00002  B002-C001-0002  B002-C002-0006   \n",
       "19        19  B002-00005-00004  B002-C001-0002  B002-C002-0006   \n",
       "...      ...               ...             ...             ...   \n",
       "15877  15877  B002-03798-00049  B002-C001-0003  B002-C002-0008   \n",
       "15882  15882  B002-03798-00054  B002-C001-0003  B002-C002-0008   \n",
       "15883  15883  B002-03798-00055  B002-C001-0003  B002-C002-0008   \n",
       "15887  15887  B002-03799-00004  B002-C001-0003  B002-C002-0008   \n",
       "15888  15888  B002-03799-00005  B002-C001-0003  B002-C002-0008   \n",
       "\n",
       "                  소분류         브랜드  2022-01-01  2022-01-02  2022-01-03  \\\n",
       "0      B002-C003-0038  B002-00001           0           0           0   \n",
       "12     B002-C003-0003  B002-00003           0           0           0   \n",
       "16     B002-C003-0032  B002-00005           0           0           0   \n",
       "17     B002-C003-0032  B002-00005           0           0           0   \n",
       "19     B002-C003-0032  B002-00005           0           0           0   \n",
       "...               ...         ...         ...         ...         ...   \n",
       "15877  B002-C003-0044  B002-03798           0           0           0   \n",
       "15882  B002-C003-0044  B002-03798           0           0           0   \n",
       "15883  B002-C003-0044  B002-03798           0           0           0   \n",
       "15887  B002-C003-0044  B002-03799           0           0           0   \n",
       "15888  B002-C003-0044  B002-03799           0           0           0   \n",
       "\n",
       "       2022-01-04  ...  consecutive_repeats  \\\n",
       "0               0  ...                  0.0   \n",
       "12              0  ...                  0.0   \n",
       "16              0  ...                  0.0   \n",
       "17              0  ...                  0.0   \n",
       "19              0  ...                  0.0   \n",
       "...           ...  ...                  ...   \n",
       "15877           0  ...                  0.0   \n",
       "15882           0  ...                  0.0   \n",
       "15883           0  ...                  0.0   \n",
       "15887           0  ...                  0.0   \n",
       "15888           0  ...                  0.0   \n",
       "\n",
       "                                            cleaned_제품특성  \\\n",
       "0      헤어타입:모든 모발용 제품형태:스프레이형 주요제품특징:머릿결개선 주요제품특징:흡수력...   \n",
       "12     생균:100억 CFU 1일 총 섭취량:1캡슐 제품용량:1개월분 제품타입:캡슐 섭취횟...   \n",
       "16     피부타입:모든피부용 향계열:과일향 주요제품특징:향 주요제품특징:촉촉함 수분공급 용기...   \n",
       "17                   향계열:과일향 주요제품특징:향 용기형태:펌프형 :1개 500ml   \n",
       "19     형태:펌프형 용량:575ml :1개 형태:펌프형 용량:520ml :1개 형태:튜브형...   \n",
       "...                                                  ...   \n",
       "15877                                       재질:실리콘 재질:기타   \n",
       "15882  형태:빨대형 용량:300ml 특징:양손잡이 특징:보온보냉 특징:샘방지 흘림방지 재질...   \n",
       "15883  형태:머그형 용량:240ml 특징:양손잡이 특징:미끄럼방지 특징:비스페놀A BPA ...   \n",
       "15887         종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG508S3   \n",
       "15888         종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG509S3   \n",
       "\n",
       "                                             parsed_제품특성  \\\n",
       "0      {'헤어타입': '모든', '모발용 제품형태': '스프레이형', '주요제품특징': ...   \n",
       "12     {'생균': '100억', 'CFU 1일 총 섭취량': '1캡슐', '제품용량': ...   \n",
       "16     {'피부타입': '모든피부용', '향계열': '과일향', '주요제품특징': '촉촉함...   \n",
       "17      {'향계열': '과일향', '주요제품특징': '향', '펌프형': '1개 500ml'}   \n",
       "19     {'형태': '튜브형', '575ml': '1개', '520ml': '1개', '6...   \n",
       "...                                                  ...   \n",
       "15877                                       {'재질': '기타'}   \n",
       "15882  {'형태': '빨대형', '용량': '300ml', '특징': '양손잡이', '흘림...   \n",
       "15883  {'형태': '머그형', '용량': '240ml', '특징': '미끄럼방지', 'B...   \n",
       "15887  {'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...   \n",
       "15888  {'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...   \n",
       "\n",
       "                                         combined_제품특성  \\\n",
       "0             모든 스프레이형 흡수력 부드러운 윤기부여 영양공급 30ml 1개 50ml   \n",
       "12     100억 1캡슐 1개월분 캡슐 하루 물과 성인남녀 체지방 감소 480mg x 30캡슐   \n",
       "16                    모든피부용 과일향 촉촉함 펌프형 500ml 1개 500ml   \n",
       "17                                      과일향 향 1개 500ml   \n",
       "19                                  튜브형 1개 1개 1개 575ml   \n",
       "...                                                ...   \n",
       "15877                                               기타   \n",
       "15882                        빨대형 300ml 양손잡이 PE 스테인리스스틸   \n",
       "15883                      머그형 240ml 미끄럼방지 ABS 스테인리스스틸   \n",
       "15887                이유식보관용기 전자레인지사용 실리콘 3개세트 LLG508S3   \n",
       "15888                이유식보관용기 전자레인지사용 실리콘 3개세트 LLG509S3   \n",
       "\n",
       "                      tokenized_제품특성       tokenized_제품특성_cleaned  대분류:건강식품  \\\n",
       "0           모든 스프레이 흡수 윤기 부여 영양 공급 개       모든 스프레이 흡수 윤기 부여 영양 공급         0   \n",
       "12     캡슐 개월 캡슐 하루 물 성인 남녀 체지방 감소 캡슐  캡슐 개월 캡슐 하루 성인 남녀 체지방 감소 캡슐         1   \n",
       "16                    피부 용 과일 향 펌프 개                     피부 과일 펌프         0   \n",
       "17                          과일 향 향 개                           과일         0   \n",
       "19                          튜브 개 개 개                           튜브         0   \n",
       "...                              ...                          ...       ...   \n",
       "15877                             기타                           기타         0   \n",
       "15882               빨대 양손잡이 스테인리스 스틸             빨대 양손잡이 스테인리스 스틸         0   \n",
       "15883             머그 미끄럼 방지 스테인리스 스틸           머그 미끄럼 방지 스테인리스 스틸         0   \n",
       "15887    이유식 보관 용기 전자레인지 사용 실리콘 개 세트    이유식 보관 용기 전자레인지 사용 실리콘 세트         0   \n",
       "15888    이유식 보관 용기 전자레인지 사용 실리콘 개 세트    이유식 보관 용기 전자레인지 사용 실리콘 세트         0   \n",
       "\n",
       "       대분류:뷰티  대분류:출산/유아동  대분류:유아 선크림  \n",
       "0           1           0           0  \n",
       "12          0           0           0  \n",
       "16          1           0           0  \n",
       "17          1           0           0  \n",
       "19          1           0           0  \n",
       "...       ...         ...         ...  \n",
       "15877       0           1           0  \n",
       "15882       0           1           0  \n",
       "15883       0           1           0  \n",
       "15887       0           1           0  \n",
       "15888       0           1           0  \n",
       "\n",
       "[10481 rows x 477 columns]"
      ]
     },
     "execution_count": 97,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merged['대분류:유아 선크림'] = merged['대분류'].apply(lambda x: 1 if x == 'B002-C001-0004' else 0)\n",
    "merged"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 108,
   "id": "dfe9fb1a",
   "metadata": {},
   "outputs": [],
   "source": [
    "major_category = {'B002-C001-0001': '건강식품', 'B002-C001-0002':'생활용품/뷰티', 'B002-C001-0003':'출산/유아동', 'B002-C001-0004':\"유아 선크림\"}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 103,
   "id": "d54cf74e",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[('기타', 290), ('아기', 174), ('개월', 144), ('파우치', 128), ('단계', 109), ('인증', 94), ('합성', 91), ('주스', 81), ('보관', 70), ('향료', 58), ('과자', 52), ('유기농', 49), ('성분', 48), ('유발', 47), ('쇠고기', 40), ('유기', 36), ('가공', 36), ('식품', 36), ('냉장', 35), ('대두', 35), ('실온', 29), ('반찬', 25), ('첨가', 24), ('티백', 20), ('우유', 19), ('진밥', 18), ('소스', 18), ('닭고기', 17), ('개입', 17), ('감미료', 16)]\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Karl\\AppData\\Local\\Temp\\ipykernel_29388\\90414284.py:3: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  filtered_data['tokenized_제품특성_cleaned'] = filtered_data['tokenized_제품특성_cleaned'].apply(lambda x: x.split() if isinstance(x, str) else [])\n"
     ]
    }
   ],
   "source": [
    "filtered_data = merged[merged['대분류'] == 'B002-C001-0005']\n",
    "# Convert the space-separated string to a list by splitting by spaces\n",
    "filtered_data['tokenized_제품특성_cleaned'] = filtered_data['tokenized_제품특성_cleaned'].apply(lambda x: x.split() if isinstance(x, str) else [])\n",
    "\n",
    "# Now sum up all the token lists into a single list\n",
    "all_tokens = sum(filtered_data['tokenized_제품특성_cleaned'], [])\n",
    "\n",
    "# Proceed with counting the tokens\n",
    "from collections import Counter\n",
    "token_counts = Counter(all_tokens)\n",
    "\n",
    "# Identify the most common tokens\n",
    "most_common_tokens = token_counts.most_common(30)  # adjust the number as needed\n",
    "\n",
    "print(most_common_tokens)\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 109,
   "id": "b2a3a764",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Karl\\AppData\\Local\\Temp\\ipykernel_29388\\4120673816.py:1: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  merged['대분류:식품'] = merged['대분류'].apply(lambda x: 1 if x == 'B002-C001-0005' else 0)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>제품</th>\n",
       "      <th>대분류</th>\n",
       "      <th>중분류</th>\n",
       "      <th>소분류</th>\n",
       "      <th>브랜드</th>\n",
       "      <th>2022-01-01</th>\n",
       "      <th>2022-01-02</th>\n",
       "      <th>2022-01-03</th>\n",
       "      <th>2022-01-04</th>\n",
       "      <th>...</th>\n",
       "      <th>cleaned_제품특성</th>\n",
       "      <th>parsed_제품특성</th>\n",
       "      <th>combined_제품특성</th>\n",
       "      <th>tokenized_제품특성</th>\n",
       "      <th>tokenized_제품특성_cleaned</th>\n",
       "      <th>대분류:건강식품</th>\n",
       "      <th>대분류:출산/유아동</th>\n",
       "      <th>대분류:유아 선크림</th>\n",
       "      <th>대분류:생활용품/뷰티</th>\n",
       "      <th>대분류:식품</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>B002-00001-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0007</td>\n",
       "      <td>B002-C003-0038</td>\n",
       "      <td>B002-00001</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>헤어타입:모든 모발용 제품형태:스프레이형 주요제품특징:머릿결개선 주요제품특징:흡수력...</td>\n",
       "      <td>{'헤어타입': '모든', '모발용 제품형태': '스프레이형', '주요제품특징': ...</td>\n",
       "      <td>모든 스프레이형 흡수력 부드러운 윤기부여 영양공급 30ml 1개 50ml</td>\n",
       "      <td>모든 스프레이 흡수 윤기 부여 영양 공급 개</td>\n",
       "      <td>모든 스프레이 흡수 윤기 부여 영양 공급</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>12</td>\n",
       "      <td>B002-00003-00009</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-00003</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>생균:100억 CFU 1일 총 섭취량:1캡슐 제품용량:1개월분 제품타입:캡슐 섭취횟...</td>\n",
       "      <td>{'생균': '100억', 'CFU 1일 총 섭취량': '1캡슐', '제품용량': ...</td>\n",
       "      <td>100억 1캡슐 1개월분 캡슐 하루 물과 성인남녀 체지방 감소 480mg x 30캡슐</td>\n",
       "      <td>캡슐 개월 캡슐 하루 물 성인 남녀 체지방 감소 캡슐</td>\n",
       "      <td>캡슐 개월 캡슐 하루 성인 남녀 체지방 감소 캡슐</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>16</td>\n",
       "      <td>B002-00005-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>피부타입:모든피부용 향계열:과일향 주요제품특징:향 주요제품특징:촉촉함 수분공급 용기...</td>\n",
       "      <td>{'피부타입': '모든피부용', '향계열': '과일향', '주요제품특징': '촉촉함...</td>\n",
       "      <td>모든피부용 과일향 촉촉함 펌프형 500ml 1개 500ml</td>\n",
       "      <td>피부 용 과일 향 펌프 개</td>\n",
       "      <td>피부 과일 펌프</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>17</td>\n",
       "      <td>B002-00005-00002</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>향계열:과일향 주요제품특징:향 용기형태:펌프형 :1개 500ml</td>\n",
       "      <td>{'향계열': '과일향', '주요제품특징': '향', '펌프형': '1개 500ml'}</td>\n",
       "      <td>과일향 향 1개 500ml</td>\n",
       "      <td>과일 향 향 개</td>\n",
       "      <td>과일</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>19</td>\n",
       "      <td>B002-00005-00004</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>형태:펌프형 용량:575ml :1개 형태:펌프형 용량:520ml :1개 형태:튜브형...</td>\n",
       "      <td>{'형태': '튜브형', '575ml': '1개', '520ml': '1개', '6...</td>\n",
       "      <td>튜브형 1개 1개 1개 575ml</td>\n",
       "      <td>튜브 개 개 개</td>\n",
       "      <td>튜브</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15877</th>\n",
       "      <td>15877</td>\n",
       "      <td>B002-03798-00049</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>재질:실리콘 재질:기타</td>\n",
       "      <td>{'재질': '기타'}</td>\n",
       "      <td>기타</td>\n",
       "      <td>기타</td>\n",
       "      <td>기타</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15882</th>\n",
       "      <td>15882</td>\n",
       "      <td>B002-03798-00054</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>형태:빨대형 용량:300ml 특징:양손잡이 특징:보온보냉 특징:샘방지 흘림방지 재질...</td>\n",
       "      <td>{'형태': '빨대형', '용량': '300ml', '특징': '양손잡이', '흘림...</td>\n",
       "      <td>빨대형 300ml 양손잡이 PE 스테인리스스틸</td>\n",
       "      <td>빨대 양손잡이 스테인리스 스틸</td>\n",
       "      <td>빨대 양손잡이 스테인리스 스틸</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15883</th>\n",
       "      <td>15883</td>\n",
       "      <td>B002-03798-00055</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>형태:머그형 용량:240ml 특징:양손잡이 특징:미끄럼방지 특징:비스페놀A BPA ...</td>\n",
       "      <td>{'형태': '머그형', '용량': '240ml', '특징': '미끄럼방지', 'B...</td>\n",
       "      <td>머그형 240ml 미끄럼방지 ABS 스테인리스스틸</td>\n",
       "      <td>머그 미끄럼 방지 스테인리스 스틸</td>\n",
       "      <td>머그 미끄럼 방지 스테인리스 스틸</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15887</th>\n",
       "      <td>15887</td>\n",
       "      <td>B002-03799-00004</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG508S3</td>\n",
       "      <td>{'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...</td>\n",
       "      <td>이유식보관용기 전자레인지사용 실리콘 3개세트 LLG508S3</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 개 세트</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 세트</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15888</th>\n",
       "      <td>15888</td>\n",
       "      <td>B002-03799-00005</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG509S3</td>\n",
       "      <td>{'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...</td>\n",
       "      <td>이유식보관용기 전자레인지사용 실리콘 3개세트 LLG509S3</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 개 세트</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 세트</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10481 rows × 478 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          ID                제품             대분류             중분류  \\\n",
       "0          0  B002-00001-00001  B002-C001-0002  B002-C002-0007   \n",
       "12        12  B002-00003-00009  B002-C001-0001  B002-C002-0001   \n",
       "16        16  B002-00005-00001  B002-C001-0002  B002-C002-0006   \n",
       "17        17  B002-00005-00002  B002-C001-0002  B002-C002-0006   \n",
       "19        19  B002-00005-00004  B002-C001-0002  B002-C002-0006   \n",
       "...      ...               ...             ...             ...   \n",
       "15877  15877  B002-03798-00049  B002-C001-0003  B002-C002-0008   \n",
       "15882  15882  B002-03798-00054  B002-C001-0003  B002-C002-0008   \n",
       "15883  15883  B002-03798-00055  B002-C001-0003  B002-C002-0008   \n",
       "15887  15887  B002-03799-00004  B002-C001-0003  B002-C002-0008   \n",
       "15888  15888  B002-03799-00005  B002-C001-0003  B002-C002-0008   \n",
       "\n",
       "                  소분류         브랜드  2022-01-01  2022-01-02  2022-01-03  \\\n",
       "0      B002-C003-0038  B002-00001           0           0           0   \n",
       "12     B002-C003-0003  B002-00003           0           0           0   \n",
       "16     B002-C003-0032  B002-00005           0           0           0   \n",
       "17     B002-C003-0032  B002-00005           0           0           0   \n",
       "19     B002-C003-0032  B002-00005           0           0           0   \n",
       "...               ...         ...         ...         ...         ...   \n",
       "15877  B002-C003-0044  B002-03798           0           0           0   \n",
       "15882  B002-C003-0044  B002-03798           0           0           0   \n",
       "15883  B002-C003-0044  B002-03798           0           0           0   \n",
       "15887  B002-C003-0044  B002-03799           0           0           0   \n",
       "15888  B002-C003-0044  B002-03799           0           0           0   \n",
       "\n",
       "       2022-01-04  ...                                       cleaned_제품특성  \\\n",
       "0               0  ...  헤어타입:모든 모발용 제품형태:스프레이형 주요제품특징:머릿결개선 주요제품특징:흡수력...   \n",
       "12              0  ...  생균:100억 CFU 1일 총 섭취량:1캡슐 제품용량:1개월분 제품타입:캡슐 섭취횟...   \n",
       "16              0  ...  피부타입:모든피부용 향계열:과일향 주요제품특징:향 주요제품특징:촉촉함 수분공급 용기...   \n",
       "17              0  ...                향계열:과일향 주요제품특징:향 용기형태:펌프형 :1개 500ml   \n",
       "19              0  ...  형태:펌프형 용량:575ml :1개 형태:펌프형 용량:520ml :1개 형태:튜브형...   \n",
       "...           ...  ...                                                ...   \n",
       "15877           0  ...                                       재질:실리콘 재질:기타   \n",
       "15882           0  ...  형태:빨대형 용량:300ml 특징:양손잡이 특징:보온보냉 특징:샘방지 흘림방지 재질...   \n",
       "15883           0  ...  형태:머그형 용량:240ml 특징:양손잡이 특징:미끄럼방지 특징:비스페놀A BPA ...   \n",
       "15887           0  ...         종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG508S3   \n",
       "15888           0  ...         종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG509S3   \n",
       "\n",
       "                                             parsed_제품특성  \\\n",
       "0      {'헤어타입': '모든', '모발용 제품형태': '스프레이형', '주요제품특징': ...   \n",
       "12     {'생균': '100억', 'CFU 1일 총 섭취량': '1캡슐', '제품용량': ...   \n",
       "16     {'피부타입': '모든피부용', '향계열': '과일향', '주요제품특징': '촉촉함...   \n",
       "17      {'향계열': '과일향', '주요제품특징': '향', '펌프형': '1개 500ml'}   \n",
       "19     {'형태': '튜브형', '575ml': '1개', '520ml': '1개', '6...   \n",
       "...                                                  ...   \n",
       "15877                                       {'재질': '기타'}   \n",
       "15882  {'형태': '빨대형', '용량': '300ml', '특징': '양손잡이', '흘림...   \n",
       "15883  {'형태': '머그형', '용량': '240ml', '특징': '미끄럼방지', 'B...   \n",
       "15887  {'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...   \n",
       "15888  {'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...   \n",
       "\n",
       "                                         combined_제품특성  \\\n",
       "0             모든 스프레이형 흡수력 부드러운 윤기부여 영양공급 30ml 1개 50ml   \n",
       "12     100억 1캡슐 1개월분 캡슐 하루 물과 성인남녀 체지방 감소 480mg x 30캡슐   \n",
       "16                    모든피부용 과일향 촉촉함 펌프형 500ml 1개 500ml   \n",
       "17                                      과일향 향 1개 500ml   \n",
       "19                                  튜브형 1개 1개 1개 575ml   \n",
       "...                                                ...   \n",
       "15877                                               기타   \n",
       "15882                        빨대형 300ml 양손잡이 PE 스테인리스스틸   \n",
       "15883                      머그형 240ml 미끄럼방지 ABS 스테인리스스틸   \n",
       "15887                이유식보관용기 전자레인지사용 실리콘 3개세트 LLG508S3   \n",
       "15888                이유식보관용기 전자레인지사용 실리콘 3개세트 LLG509S3   \n",
       "\n",
       "                      tokenized_제품특성       tokenized_제품특성_cleaned  대분류:건강식품  \\\n",
       "0           모든 스프레이 흡수 윤기 부여 영양 공급 개       모든 스프레이 흡수 윤기 부여 영양 공급         0   \n",
       "12     캡슐 개월 캡슐 하루 물 성인 남녀 체지방 감소 캡슐  캡슐 개월 캡슐 하루 성인 남녀 체지방 감소 캡슐         1   \n",
       "16                    피부 용 과일 향 펌프 개                     피부 과일 펌프         0   \n",
       "17                          과일 향 향 개                           과일         0   \n",
       "19                          튜브 개 개 개                           튜브         0   \n",
       "...                              ...                          ...       ...   \n",
       "15877                             기타                           기타         0   \n",
       "15882               빨대 양손잡이 스테인리스 스틸             빨대 양손잡이 스테인리스 스틸         0   \n",
       "15883             머그 미끄럼 방지 스테인리스 스틸           머그 미끄럼 방지 스테인리스 스틸         0   \n",
       "15887    이유식 보관 용기 전자레인지 사용 실리콘 개 세트    이유식 보관 용기 전자레인지 사용 실리콘 세트         0   \n",
       "15888    이유식 보관 용기 전자레인지 사용 실리콘 개 세트    이유식 보관 용기 전자레인지 사용 실리콘 세트         0   \n",
       "\n",
       "       대분류:출산/유아동  대분류:유아 선크림  대분류:생활용품/뷰티  대분류:식품  \n",
       "0               0           0            1       0  \n",
       "12              0           0            0       0  \n",
       "16              0           0            1       0  \n",
       "17              0           0            1       0  \n",
       "19              0           0            1       0  \n",
       "...           ...         ...          ...     ...  \n",
       "15877           1           0            0       0  \n",
       "15882           1           0            0       0  \n",
       "15883           1           0            0       0  \n",
       "15887           1           0            0       0  \n",
       "15888           1           0            0       0  \n",
       "\n",
       "[10481 rows x 478 columns]"
      ]
     },
     "execution_count": 109,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merged['대분류:식품'] = merged['대분류'].apply(lambda x: 1 if x == 'B002-C001-0005' else 0)\n",
    "merged"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 110,
   "id": "7600b1ea",
   "metadata": {},
   "outputs": [],
   "source": [
    "major_category = {'B002-C001-0001': '건강식품', \n",
    "                  'B002-C001-0002':'생활용품/뷰티', \n",
    "                  'B002-C001-0003':'출산/유아동', \n",
    "                  'B002-C001-0004':\"유아 선크림\", \n",
    "                  'B002-C001-0005':'식품'}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 111,
   "id": "cc6a628d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'B002-C001-0001': '건강식품',\n",
       " 'B002-C001-0002': '생활용품/뷰티',\n",
       " 'B002-C001-0003': '출산/유아동',\n",
       " 'B002-C001-0004': '유아 선크림',\n",
       " 'B002-C001-0005': '식품'}"
      ]
     },
     "execution_count": 111,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "major_category"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 112,
   "id": "c66d6509",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>제품</th>\n",
       "      <th>대분류</th>\n",
       "      <th>중분류</th>\n",
       "      <th>소분류</th>\n",
       "      <th>브랜드</th>\n",
       "      <th>2022-01-01</th>\n",
       "      <th>2022-01-02</th>\n",
       "      <th>2022-01-03</th>\n",
       "      <th>2022-01-04</th>\n",
       "      <th>...</th>\n",
       "      <th>cleaned_제품특성</th>\n",
       "      <th>parsed_제품특성</th>\n",
       "      <th>combined_제품특성</th>\n",
       "      <th>tokenized_제품특성</th>\n",
       "      <th>tokenized_제품특성_cleaned</th>\n",
       "      <th>대분류:건강식품</th>\n",
       "      <th>대분류:출산/유아동</th>\n",
       "      <th>대분류:유아 선크림</th>\n",
       "      <th>대분류:생활용품/뷰티</th>\n",
       "      <th>대분류:식품</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>B002-00001-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0007</td>\n",
       "      <td>B002-C003-0038</td>\n",
       "      <td>B002-00001</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>헤어타입:모든 모발용 제품형태:스프레이형 주요제품특징:머릿결개선 주요제품특징:흡수력...</td>\n",
       "      <td>{'헤어타입': '모든', '모발용 제품형태': '스프레이형', '주요제품특징': ...</td>\n",
       "      <td>모든 스프레이형 흡수력 부드러운 윤기부여 영양공급 30ml 1개 50ml</td>\n",
       "      <td>모든 스프레이 흡수 윤기 부여 영양 공급 개</td>\n",
       "      <td>모든 스프레이 흡수 윤기 부여 영양 공급</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>12</td>\n",
       "      <td>B002-00003-00009</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-00003</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>생균:100억 CFU 1일 총 섭취량:1캡슐 제품용량:1개월분 제품타입:캡슐 섭취횟...</td>\n",
       "      <td>{'생균': '100억', 'CFU 1일 총 섭취량': '1캡슐', '제품용량': ...</td>\n",
       "      <td>100억 1캡슐 1개월분 캡슐 하루 물과 성인남녀 체지방 감소 480mg x 30캡슐</td>\n",
       "      <td>캡슐 개월 캡슐 하루 물 성인 남녀 체지방 감소 캡슐</td>\n",
       "      <td>캡슐 개월 캡슐 하루 성인 남녀 체지방 감소 캡슐</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>16</td>\n",
       "      <td>B002-00005-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>피부타입:모든피부용 향계열:과일향 주요제품특징:향 주요제품특징:촉촉함 수분공급 용기...</td>\n",
       "      <td>{'피부타입': '모든피부용', '향계열': '과일향', '주요제품특징': '촉촉함...</td>\n",
       "      <td>모든피부용 과일향 촉촉함 펌프형 500ml 1개 500ml</td>\n",
       "      <td>피부 용 과일 향 펌프 개</td>\n",
       "      <td>피부 과일 펌프</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>17</td>\n",
       "      <td>B002-00005-00002</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>향계열:과일향 주요제품특징:향 용기형태:펌프형 :1개 500ml</td>\n",
       "      <td>{'향계열': '과일향', '주요제품특징': '향', '펌프형': '1개 500ml'}</td>\n",
       "      <td>과일향 향 1개 500ml</td>\n",
       "      <td>과일 향 향 개</td>\n",
       "      <td>과일</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>19</td>\n",
       "      <td>B002-00005-00004</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>형태:펌프형 용량:575ml :1개 형태:펌프형 용량:520ml :1개 형태:튜브형...</td>\n",
       "      <td>{'형태': '튜브형', '575ml': '1개', '520ml': '1개', '6...</td>\n",
       "      <td>튜브형 1개 1개 1개 575ml</td>\n",
       "      <td>튜브 개 개 개</td>\n",
       "      <td>튜브</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15877</th>\n",
       "      <td>15877</td>\n",
       "      <td>B002-03798-00049</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>재질:실리콘 재질:기타</td>\n",
       "      <td>{'재질': '기타'}</td>\n",
       "      <td>기타</td>\n",
       "      <td>기타</td>\n",
       "      <td>기타</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15882</th>\n",
       "      <td>15882</td>\n",
       "      <td>B002-03798-00054</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>형태:빨대형 용량:300ml 특징:양손잡이 특징:보온보냉 특징:샘방지 흘림방지 재질...</td>\n",
       "      <td>{'형태': '빨대형', '용량': '300ml', '특징': '양손잡이', '흘림...</td>\n",
       "      <td>빨대형 300ml 양손잡이 PE 스테인리스스틸</td>\n",
       "      <td>빨대 양손잡이 스테인리스 스틸</td>\n",
       "      <td>빨대 양손잡이 스테인리스 스틸</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15883</th>\n",
       "      <td>15883</td>\n",
       "      <td>B002-03798-00055</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>형태:머그형 용량:240ml 특징:양손잡이 특징:미끄럼방지 특징:비스페놀A BPA ...</td>\n",
       "      <td>{'형태': '머그형', '용량': '240ml', '특징': '미끄럼방지', 'B...</td>\n",
       "      <td>머그형 240ml 미끄럼방지 ABS 스테인리스스틸</td>\n",
       "      <td>머그 미끄럼 방지 스테인리스 스틸</td>\n",
       "      <td>머그 미끄럼 방지 스테인리스 스틸</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15887</th>\n",
       "      <td>15887</td>\n",
       "      <td>B002-03799-00004</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG508S3</td>\n",
       "      <td>{'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...</td>\n",
       "      <td>이유식보관용기 전자레인지사용 실리콘 3개세트 LLG508S3</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 개 세트</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 세트</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15888</th>\n",
       "      <td>15888</td>\n",
       "      <td>B002-03799-00005</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG509S3</td>\n",
       "      <td>{'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...</td>\n",
       "      <td>이유식보관용기 전자레인지사용 실리콘 3개세트 LLG509S3</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 개 세트</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 세트</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10481 rows × 478 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          ID                제품             대분류             중분류  \\\n",
       "0          0  B002-00001-00001  B002-C001-0002  B002-C002-0007   \n",
       "12        12  B002-00003-00009  B002-C001-0001  B002-C002-0001   \n",
       "16        16  B002-00005-00001  B002-C001-0002  B002-C002-0006   \n",
       "17        17  B002-00005-00002  B002-C001-0002  B002-C002-0006   \n",
       "19        19  B002-00005-00004  B002-C001-0002  B002-C002-0006   \n",
       "...      ...               ...             ...             ...   \n",
       "15877  15877  B002-03798-00049  B002-C001-0003  B002-C002-0008   \n",
       "15882  15882  B002-03798-00054  B002-C001-0003  B002-C002-0008   \n",
       "15883  15883  B002-03798-00055  B002-C001-0003  B002-C002-0008   \n",
       "15887  15887  B002-03799-00004  B002-C001-0003  B002-C002-0008   \n",
       "15888  15888  B002-03799-00005  B002-C001-0003  B002-C002-0008   \n",
       "\n",
       "                  소분류         브랜드  2022-01-01  2022-01-02  2022-01-03  \\\n",
       "0      B002-C003-0038  B002-00001           0           0           0   \n",
       "12     B002-C003-0003  B002-00003           0           0           0   \n",
       "16     B002-C003-0032  B002-00005           0           0           0   \n",
       "17     B002-C003-0032  B002-00005           0           0           0   \n",
       "19     B002-C003-0032  B002-00005           0           0           0   \n",
       "...               ...         ...         ...         ...         ...   \n",
       "15877  B002-C003-0044  B002-03798           0           0           0   \n",
       "15882  B002-C003-0044  B002-03798           0           0           0   \n",
       "15883  B002-C003-0044  B002-03798           0           0           0   \n",
       "15887  B002-C003-0044  B002-03799           0           0           0   \n",
       "15888  B002-C003-0044  B002-03799           0           0           0   \n",
       "\n",
       "       2022-01-04  ...                                       cleaned_제품특성  \\\n",
       "0               0  ...  헤어타입:모든 모발용 제품형태:스프레이형 주요제품특징:머릿결개선 주요제품특징:흡수력...   \n",
       "12              0  ...  생균:100억 CFU 1일 총 섭취량:1캡슐 제품용량:1개월분 제품타입:캡슐 섭취횟...   \n",
       "16              0  ...  피부타입:모든피부용 향계열:과일향 주요제품특징:향 주요제품특징:촉촉함 수분공급 용기...   \n",
       "17              0  ...                향계열:과일향 주요제품특징:향 용기형태:펌프형 :1개 500ml   \n",
       "19              0  ...  형태:펌프형 용량:575ml :1개 형태:펌프형 용량:520ml :1개 형태:튜브형...   \n",
       "...           ...  ...                                                ...   \n",
       "15877           0  ...                                       재질:실리콘 재질:기타   \n",
       "15882           0  ...  형태:빨대형 용량:300ml 특징:양손잡이 특징:보온보냉 특징:샘방지 흘림방지 재질...   \n",
       "15883           0  ...  형태:머그형 용량:240ml 특징:양손잡이 특징:미끄럼방지 특징:비스페놀A BPA ...   \n",
       "15887           0  ...         종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG508S3   \n",
       "15888           0  ...         종류:이유식보관용기 특징:전자레인지사용 재질:실리콘 3개세트 LLG509S3   \n",
       "\n",
       "                                             parsed_제품특성  \\\n",
       "0      {'헤어타입': '모든', '모발용 제품형태': '스프레이형', '주요제품특징': ...   \n",
       "12     {'생균': '100억', 'CFU 1일 총 섭취량': '1캡슐', '제품용량': ...   \n",
       "16     {'피부타입': '모든피부용', '향계열': '과일향', '주요제품특징': '촉촉함...   \n",
       "17      {'향계열': '과일향', '주요제품특징': '향', '펌프형': '1개 500ml'}   \n",
       "19     {'형태': '튜브형', '575ml': '1개', '520ml': '1개', '6...   \n",
       "...                                                  ...   \n",
       "15877                                       {'재질': '기타'}   \n",
       "15882  {'형태': '빨대형', '용량': '300ml', '특징': '양손잡이', '흘림...   \n",
       "15883  {'형태': '머그형', '용량': '240ml', '특징': '미끄럼방지', 'B...   \n",
       "15887  {'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...   \n",
       "15888  {'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...   \n",
       "\n",
       "                                         combined_제품특성  \\\n",
       "0             모든 스프레이형 흡수력 부드러운 윤기부여 영양공급 30ml 1개 50ml   \n",
       "12     100억 1캡슐 1개월분 캡슐 하루 물과 성인남녀 체지방 감소 480mg x 30캡슐   \n",
       "16                    모든피부용 과일향 촉촉함 펌프형 500ml 1개 500ml   \n",
       "17                                      과일향 향 1개 500ml   \n",
       "19                                  튜브형 1개 1개 1개 575ml   \n",
       "...                                                ...   \n",
       "15877                                               기타   \n",
       "15882                        빨대형 300ml 양손잡이 PE 스테인리스스틸   \n",
       "15883                      머그형 240ml 미끄럼방지 ABS 스테인리스스틸   \n",
       "15887                이유식보관용기 전자레인지사용 실리콘 3개세트 LLG508S3   \n",
       "15888                이유식보관용기 전자레인지사용 실리콘 3개세트 LLG509S3   \n",
       "\n",
       "                      tokenized_제품특성       tokenized_제품특성_cleaned  대분류:건강식품  \\\n",
       "0           모든 스프레이 흡수 윤기 부여 영양 공급 개       모든 스프레이 흡수 윤기 부여 영양 공급         0   \n",
       "12     캡슐 개월 캡슐 하루 물 성인 남녀 체지방 감소 캡슐  캡슐 개월 캡슐 하루 성인 남녀 체지방 감소 캡슐         1   \n",
       "16                    피부 용 과일 향 펌프 개                     피부 과일 펌프         0   \n",
       "17                          과일 향 향 개                           과일         0   \n",
       "19                          튜브 개 개 개                           튜브         0   \n",
       "...                              ...                          ...       ...   \n",
       "15877                             기타                           기타         0   \n",
       "15882               빨대 양손잡이 스테인리스 스틸             빨대 양손잡이 스테인리스 스틸         0   \n",
       "15883             머그 미끄럼 방지 스테인리스 스틸           머그 미끄럼 방지 스테인리스 스틸         0   \n",
       "15887    이유식 보관 용기 전자레인지 사용 실리콘 개 세트    이유식 보관 용기 전자레인지 사용 실리콘 세트         0   \n",
       "15888    이유식 보관 용기 전자레인지 사용 실리콘 개 세트    이유식 보관 용기 전자레인지 사용 실리콘 세트         0   \n",
       "\n",
       "       대분류:출산/유아동  대분류:유아 선크림  대분류:생활용품/뷰티  대분류:식품  \n",
       "0               0           0            1       0  \n",
       "12              0           0            0       0  \n",
       "16              0           0            1       0  \n",
       "17              0           0            1       0  \n",
       "19              0           0            1       0  \n",
       "...           ...         ...          ...     ...  \n",
       "15877           1           0            0       0  \n",
       "15882           1           0            0       0  \n",
       "15883           1           0            0       0  \n",
       "15887           1           0            0       0  \n",
       "15888           1           0            0       0  \n",
       "\n",
       "[10481 rows x 478 columns]"
      ]
     },
     "execution_count": 112,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merged"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 119,
   "id": "cbac7885",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['B002-C002-0001' 'B002-C002-0009']\n"
     ]
    }
   ],
   "source": [
    "filtered_data = merged[merged['대분류'] == 'B002-C001-0001']\n",
    "unique_subcategories = filtered_data['중분류'].unique()\n",
    "print(unique_subcategories)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 123,
   "id": "6b8224e6",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[('성인', 2703), ('하루', 2545), ('남녀', 2497), ('캡슐', 1854), ('개월', 1693), ('건강', 808), ('단백질', 789), ('비타민', 745), ('바로', 722), ('식품', 534), ('영양', 470), ('분말', 470), ('보충', 468), ('분리', 372), ('해당', 369), ('유아', 348), ('유청', 339), ('동물성', 321), ('기능', 314), ('셀레늄', 249), ('스푼', 229), ('일반', 224), ('관절', 210), ('개입', 205), ('농축액', 203), ('체지방', 193), ('개인', 182), ('아연', 181), ('개선', 179), ('혈행', 178)]\n"
     ]
    }
   ],
   "source": [
    "filtered_data = merged[merged['중분류'] =='B002-C002-0001'].copy()\n",
    "filtered_data['tokenized_제품특성_cleaned'] = filtered_data['tokenized_제품특성_cleaned'].apply(lambda x: x.split() if isinstance(x, str) else [])\n",
    "# Now sum up all the token lists into a single list\n",
    "all_tokens = sum(filtered_data['tokenized_제품특성_cleaned'], [])\n",
    "\n",
    "# Proceed with counting the tokens\n",
    "from collections import Counter\n",
    "token_counts = Counter(all_tokens)\n",
    "\n",
    "# Identify the most common tokens\n",
    "most_common_tokens = token_counts.most_common(30)  # adjust the number as needed\n",
    "\n",
    "print(most_common_tokens)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 124,
   "id": "9de0f907",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[('자극', 313), ('피부', 281), ('유아', 279), ('공급', 270), ('펌프', 226), ('튜브', 210), ('세트', 194), ('단계', 184), ('강화', 172), ('수분', 165), ('장벽', 147), ('바디', 137), ('일반', 129), ('상형', 127), ('영양', 106), ('개월', 104), ('겸용', 92), ('세탁', 83), ('드럼', 80), ('스틱', 77), ('분말', 75), ('칫솔', 71), ('분유', 68), ('선크림', 61), ('페이스', 61), ('워시', 60), ('성장', 55), ('무향', 54), ('기타', 51), ('어린이', 47)]\n"
     ]
    }
   ],
   "source": [
    "filtered_data = merged[merged['중분류'] =='B002-C002-0009'].copy()\n",
    "filtered_data['tokenized_제품특성_cleaned'] = filtered_data['tokenized_제품특성_cleaned'].apply(lambda x: x.split() if isinstance(x, str) else [])\n",
    "# Now sum up all the token lists into a single list\n",
    "all_tokens = sum(filtered_data['tokenized_제품특성_cleaned'], [])\n",
    "\n",
    "# Proceed with counting the tokens\n",
    "from collections import Counter\n",
    "token_counts = Counter(all_tokens)\n",
    "\n",
    "# Identify the most common tokens\n",
    "most_common_tokens = token_counts.most_common(30)  # adjust the number as needed\n",
    "\n",
    "print(most_common_tokens)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 126,
   "id": "6f0466de",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>제품</th>\n",
       "      <th>대분류</th>\n",
       "      <th>중분류</th>\n",
       "      <th>소분류</th>\n",
       "      <th>브랜드</th>\n",
       "      <th>2022-01-01</th>\n",
       "      <th>2022-01-02</th>\n",
       "      <th>2022-01-03</th>\n",
       "      <th>2022-01-04</th>\n",
       "      <th>...</th>\n",
       "      <th>cleaned_제품특성</th>\n",
       "      <th>parsed_제품특성</th>\n",
       "      <th>combined_제품특성</th>\n",
       "      <th>tokenized_제품특성</th>\n",
       "      <th>tokenized_제품특성_cleaned</th>\n",
       "      <th>대분류:건강식품</th>\n",
       "      <th>대분류:출산/유아동</th>\n",
       "      <th>대분류:유아 선크림</th>\n",
       "      <th>대분류:생활용품/뷰티</th>\n",
       "      <th>대분류:식품</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>156</th>\n",
       "      <td>156</td>\n",
       "      <td>B002-00067-00014</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0009</td>\n",
       "      <td>B002-C003-0045</td>\n",
       "      <td>B002-00067</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>포장형태:펌프형 특징:수분공급 특징:영양공급 무첨가:무색소 무첨가:무알코올 무첨가:...</td>\n",
       "      <td>{'포장형태': '펌프형', '특징': '영양공급', '무첨가': '무벤조페논', ...</td>\n",
       "      <td>펌프형 영양공급 무벤조페논 1개 700ml</td>\n",
       "      <td>펌프 영양 공급 무벤조페논 개</td>\n",
       "      <td>펌프 영양 공급 무벤조페논</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>157</th>\n",
       "      <td>157</td>\n",
       "      <td>B002-00067-00015</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0009</td>\n",
       "      <td>B002-C003-0045</td>\n",
       "      <td>B002-00067</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>포장형태:튜브형 특징:피부진정 특징:수분공급 특징:피부장벽강화 무첨가:무색소 무첨가...</td>\n",
       "      <td>{'포장형태': '튜브형', '특징': '피부장벽강화', '무첨가': '무벤조페논 ...</td>\n",
       "      <td>튜브형 피부장벽강화 무벤조페논 200ml 1개 2종세트</td>\n",
       "      <td>튜브 피부 장벽 강화 무벤조페논 개 종 세트</td>\n",
       "      <td>튜브 피부 장벽 강화 무벤조페논 세트</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>158</th>\n",
       "      <td>158</td>\n",
       "      <td>B002-00067-00016</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0009</td>\n",
       "      <td>B002-C003-0046</td>\n",
       "      <td>B002-00067</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>제품종류:유아바디워시 포장형태:펌프형 특징:수분공급 특징:영양공급 무첨가:무색소 무...</td>\n",
       "      <td>{'제품종류': '유아바디워시', '포장형태': '펌프형', '특징': '영양공급'...</td>\n",
       "      <td>유아바디워시 펌프형 영양공급 무벤조페논 1개 300ml 1개 1개 300ml 1개 1개</td>\n",
       "      <td>유아 바디 워시 펌프 영양 공급 무벤조페논 개 개 개 개 개</td>\n",
       "      <td>유아 바디 워시 펌프 영양 공급 무벤조페논</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>160</th>\n",
       "      <td>160</td>\n",
       "      <td>B002-00067-00018</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0009</td>\n",
       "      <td>B002-C003-0046</td>\n",
       "      <td>B002-00067</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>제품종류:유아샴푸 포장형태:펌프형 특징:피부진정 특징:수분공급 특징:영양공급 무첨가...</td>\n",
       "      <td>{'제품종류': '유아샴푸', '포장형태': '펌프형', '특징': '영양공급', ...</td>\n",
       "      <td>유아샴푸 펌프형 영양공급 저자극 1개 1개 1개 1개 1000ml 300ml 1개</td>\n",
       "      <td>유아 샴푸 펌프 영양 공급 자극 개 개 개 개 개</td>\n",
       "      <td>유아 샴푸 펌프 영양 공급 자극</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>171</th>\n",
       "      <td>171</td>\n",
       "      <td>B002-00067-00029</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0009</td>\n",
       "      <td>B002-C003-0046</td>\n",
       "      <td>B002-00067</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>제품종류:유아바디워시 특징:피부진정 특징:수분공급 특징:영양공급 무첨가:무색소 무첨...</td>\n",
       "      <td>{'제품종류': '유아바디워시', '특징': '영양공급', '무첨가': '무파라벤'...</td>\n",
       "      <td>유아바디워시 영양공급 무파라벤 1개 300ml</td>\n",
       "      <td>유아 바디 워시 영양 공급 무 파라 개</td>\n",
       "      <td>유아 바디 워시 영양 공급 파라</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15611</th>\n",
       "      <td>15611</td>\n",
       "      <td>B002-03740-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0009</td>\n",
       "      <td>B002-C003-0049</td>\n",
       "      <td>B002-03740</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>무첨가:무계면활성제 무첨가:무불소 무첨가:무색소 무첨가:무파라벤 무첨가:무CMIT ...</td>\n",
       "      <td>{'무첨가': '무CMIT', 'MIT 무첨가': '무트리클로산', '효과': '구...</td>\n",
       "      <td>무CMIT 무트리클로산 구취제거 기타 튜브형 기타 1개 60g</td>\n",
       "      <td>무 무 트리클로산 구취 제거 기타 튜브 기타 개</td>\n",
       "      <td>트리클로산 구취 제거 기타 튜브 기타</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15633</th>\n",
       "      <td>15633</td>\n",
       "      <td>B002-03744-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0009</td>\n",
       "      <td>B002-C003-0049</td>\n",
       "      <td>B002-03744</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>종류:어린이칫솔 특징:흡착형 재질:플라스틱 최소연령:5세 사용연령:5세이상 :1개 ...</td>\n",
       "      <td>{'종류': '어린이칫솔', '특징': '흡착형', '재질': '플라스틱', '최소...</td>\n",
       "      <td>어린이칫솔 흡착형 플라스틱 5세 1개 부드러운모 1개</td>\n",
       "      <td>어린이 칫솔 흡착 플라스틱 세 개 모 개</td>\n",
       "      <td>어린이 칫솔 흡착 플라스틱</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15702</th>\n",
       "      <td>15702</td>\n",
       "      <td>B002-03768-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0009</td>\n",
       "      <td>B002-C003-0048</td>\n",
       "      <td>B002-03768</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>형태:액상형 구성:리필 용량:1300ml 용도:드럼세탁겸용 무첨가:항균효과 무첨가:...</td>\n",
       "      <td>{'형태': '액상형', '구성': '리필', '용량': '1300ml', '용도'...</td>\n",
       "      <td>액상형 리필 1300ml 드럼세탁겸용 항균효과 1개 1개 1 3L</td>\n",
       "      <td>액 상형 리필 드럼 세탁 겸용 항균 효과 개 개</td>\n",
       "      <td>상형 리필 드럼 세탁 겸용 항균 효과</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15703</th>\n",
       "      <td>15703</td>\n",
       "      <td>B002-03768-00002</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0009</td>\n",
       "      <td>B002-C003-0048</td>\n",
       "      <td>B002-03768</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>형태:액상형 구성:본품 용량:2000ml 용도:드럼세탁겸용 무첨가:항균효과 :1개 ...</td>\n",
       "      <td>{'형태': '액상형', '구성': '본품', '용량': '2000ml', '용도'...</td>\n",
       "      <td>액상형 본품 2000ml 드럼세탁겸용 1개 무CMIT 무파라벤 1개 2L</td>\n",
       "      <td>액 상형 품 드럼 세탁 겸용 개 무 무 파라 개</td>\n",
       "      <td>상형 드럼 세탁 겸용 파라</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15855</th>\n",
       "      <td>15855</td>\n",
       "      <td>B002-03798-00026</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0009</td>\n",
       "      <td>B002-C003-0049</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>종류:유아칫솔 단계별:2단계 칫솔모타입:부드러운모 특징:목찔림방지 재질:실리콘 최소...</td>\n",
       "      <td>{'종류': '손가락칫솔', '단계별': '2단계', '칫솔모타입': '부드러운모'...</td>\n",
       "      <td>손가락칫솔 2단계 부드러운모 목찔림방지 실리콘 1개 1개 2단계</td>\n",
       "      <td>손가락 칫솔 단계 모 목 방지 실리콘 개 개 단계</td>\n",
       "      <td>손가락 칫솔 단계 방지 실리콘 단계</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>804 rows × 478 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          ID                제품             대분류             중분류  \\\n",
       "156      156  B002-00067-00014  B002-C001-0002  B002-C002-0009   \n",
       "157      157  B002-00067-00015  B002-C001-0002  B002-C002-0009   \n",
       "158      158  B002-00067-00016  B002-C001-0002  B002-C002-0009   \n",
       "160      160  B002-00067-00018  B002-C001-0002  B002-C002-0009   \n",
       "171      171  B002-00067-00029  B002-C001-0002  B002-C002-0009   \n",
       "...      ...               ...             ...             ...   \n",
       "15611  15611  B002-03740-00001  B002-C001-0002  B002-C002-0009   \n",
       "15633  15633  B002-03744-00001  B002-C001-0002  B002-C002-0009   \n",
       "15702  15702  B002-03768-00001  B002-C001-0002  B002-C002-0009   \n",
       "15703  15703  B002-03768-00002  B002-C001-0002  B002-C002-0009   \n",
       "15855  15855  B002-03798-00026  B002-C001-0002  B002-C002-0009   \n",
       "\n",
       "                  소분류         브랜드  2022-01-01  2022-01-02  2022-01-03  \\\n",
       "156    B002-C003-0045  B002-00067           4           0           1   \n",
       "157    B002-C003-0045  B002-00067           0           0           0   \n",
       "158    B002-C003-0046  B002-00067           0           0           0   \n",
       "160    B002-C003-0046  B002-00067           0           0           0   \n",
       "171    B002-C003-0046  B002-00067           0           0           0   \n",
       "...               ...         ...         ...         ...         ...   \n",
       "15611  B002-C003-0049  B002-03740           1           1           1   \n",
       "15633  B002-C003-0049  B002-03744           0           0           0   \n",
       "15702  B002-C003-0048  B002-03768           0           1           0   \n",
       "15703  B002-C003-0048  B002-03768           0           0           0   \n",
       "15855  B002-C003-0049  B002-03798           0           0           0   \n",
       "\n",
       "       2022-01-04  ...                                       cleaned_제품특성  \\\n",
       "156             1  ...  포장형태:펌프형 특징:수분공급 특징:영양공급 무첨가:무색소 무첨가:무알코올 무첨가:...   \n",
       "157             0  ...  포장형태:튜브형 특징:피부진정 특징:수분공급 특징:피부장벽강화 무첨가:무색소 무첨가...   \n",
       "158             0  ...  제품종류:유아바디워시 포장형태:펌프형 특징:수분공급 특징:영양공급 무첨가:무색소 무...   \n",
       "160             0  ...  제품종류:유아샴푸 포장형태:펌프형 특징:피부진정 특징:수분공급 특징:영양공급 무첨가...   \n",
       "171             0  ...  제품종류:유아바디워시 특징:피부진정 특징:수분공급 특징:영양공급 무첨가:무색소 무첨...   \n",
       "...           ...  ...                                                ...   \n",
       "15611           0  ...  무첨가:무계면활성제 무첨가:무불소 무첨가:무색소 무첨가:무파라벤 무첨가:무CMIT ...   \n",
       "15633           0  ...  종류:어린이칫솔 특징:흡착형 재질:플라스틱 최소연령:5세 사용연령:5세이상 :1개 ...   \n",
       "15702           1  ...  형태:액상형 구성:리필 용량:1300ml 용도:드럼세탁겸용 무첨가:항균효과 무첨가:...   \n",
       "15703           0  ...  형태:액상형 구성:본품 용량:2000ml 용도:드럼세탁겸용 무첨가:항균효과 :1개 ...   \n",
       "15855           1  ...  종류:유아칫솔 단계별:2단계 칫솔모타입:부드러운모 특징:목찔림방지 재질:실리콘 최소...   \n",
       "\n",
       "                                             parsed_제품특성  \\\n",
       "156    {'포장형태': '펌프형', '특징': '영양공급', '무첨가': '무벤조페논', ...   \n",
       "157    {'포장형태': '튜브형', '특징': '피부장벽강화', '무첨가': '무벤조페논 ...   \n",
       "158    {'제품종류': '유아바디워시', '포장형태': '펌프형', '특징': '영양공급'...   \n",
       "160    {'제품종류': '유아샴푸', '포장형태': '펌프형', '특징': '영양공급', ...   \n",
       "171    {'제품종류': '유아바디워시', '특징': '영양공급', '무첨가': '무파라벤'...   \n",
       "...                                                  ...   \n",
       "15611  {'무첨가': '무CMIT', 'MIT 무첨가': '무트리클로산', '효과': '구...   \n",
       "15633  {'종류': '어린이칫솔', '특징': '흡착형', '재질': '플라스틱', '최소...   \n",
       "15702  {'형태': '액상형', '구성': '리필', '용량': '1300ml', '용도'...   \n",
       "15703  {'형태': '액상형', '구성': '본품', '용량': '2000ml', '용도'...   \n",
       "15855  {'종류': '손가락칫솔', '단계별': '2단계', '칫솔모타입': '부드러운모'...   \n",
       "\n",
       "                                          combined_제품특성  \\\n",
       "156                             펌프형 영양공급 무벤조페논 1개 700ml   \n",
       "157                      튜브형 피부장벽강화 무벤조페논 200ml 1개 2종세트   \n",
       "158    유아바디워시 펌프형 영양공급 무벤조페논 1개 300ml 1개 1개 300ml 1개 1개   \n",
       "160       유아샴푸 펌프형 영양공급 저자극 1개 1개 1개 1개 1000ml 300ml 1개   \n",
       "171                           유아바디워시 영양공급 무파라벤 1개 300ml   \n",
       "...                                                 ...   \n",
       "15611                무CMIT 무트리클로산 구취제거 기타 튜브형 기타 1개 60g   \n",
       "15633                     어린이칫솔 흡착형 플라스틱 5세 1개 부드러운모 1개   \n",
       "15702              액상형 리필 1300ml 드럼세탁겸용 항균효과 1개 1개 1 3L   \n",
       "15703          액상형 본품 2000ml 드럼세탁겸용 1개 무CMIT 무파라벤 1개 2L   \n",
       "15855               손가락칫솔 2단계 부드러운모 목찔림방지 실리콘 1개 1개 2단계   \n",
       "\n",
       "                          tokenized_제품특성   tokenized_제품특성_cleaned  대분류:건강식품  \\\n",
       "156                     펌프 영양 공급 무벤조페논 개           펌프 영양 공급 무벤조페논         0   \n",
       "157             튜브 피부 장벽 강화 무벤조페논 개 종 세트     튜브 피부 장벽 강화 무벤조페논 세트         0   \n",
       "158    유아 바디 워시 펌프 영양 공급 무벤조페논 개 개 개 개 개  유아 바디 워시 펌프 영양 공급 무벤조페논         0   \n",
       "160          유아 샴푸 펌프 영양 공급 자극 개 개 개 개 개        유아 샴푸 펌프 영양 공급 자극         0   \n",
       "171                유아 바디 워시 영양 공급 무 파라 개        유아 바디 워시 영양 공급 파라         0   \n",
       "...                                  ...                      ...       ...   \n",
       "15611         무 무 트리클로산 구취 제거 기타 튜브 기타 개     트리클로산 구취 제거 기타 튜브 기타         0   \n",
       "15633             어린이 칫솔 흡착 플라스틱 세 개 모 개           어린이 칫솔 흡착 플라스틱         0   \n",
       "15702         액 상형 리필 드럼 세탁 겸용 항균 효과 개 개     상형 리필 드럼 세탁 겸용 항균 효과         0   \n",
       "15703         액 상형 품 드럼 세탁 겸용 개 무 무 파라 개           상형 드럼 세탁 겸용 파라         0   \n",
       "15855        손가락 칫솔 단계 모 목 방지 실리콘 개 개 단계      손가락 칫솔 단계 방지 실리콘 단계         0   \n",
       "\n",
       "       대분류:출산/유아동  대분류:유아 선크림  대분류:생활용품/뷰티  대분류:식품  \n",
       "156             0           0            1       0  \n",
       "157             0           0            1       0  \n",
       "158             0           0            1       0  \n",
       "160             0           0            1       0  \n",
       "171             0           0            1       0  \n",
       "...           ...         ...          ...     ...  \n",
       "15611           0           0            1       0  \n",
       "15633           0           0            1       0  \n",
       "15702           0           0            1       0  \n",
       "15703           0           0            1       0  \n",
       "15855           0           0            1       0  \n",
       "\n",
       "[804 rows x 478 columns]"
      ]
     },
     "execution_count": 126,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "filtered_data = merged[merged['중분류'] =='B002-C002-0009']\n",
    "filtered_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 127,
   "id": "b9846573",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Karl\\AppData\\Local\\Temp\\ipykernel_29388\\3612525696.py:1: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  merged['중분류:성인'] = merged['중분류'].apply(lambda x: 1 if x == 'B002-C002-0001' else 0)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>제품</th>\n",
       "      <th>대분류</th>\n",
       "      <th>중분류</th>\n",
       "      <th>소분류</th>\n",
       "      <th>브랜드</th>\n",
       "      <th>2022-01-01</th>\n",
       "      <th>2022-01-02</th>\n",
       "      <th>2022-01-03</th>\n",
       "      <th>2022-01-04</th>\n",
       "      <th>...</th>\n",
       "      <th>parsed_제품특성</th>\n",
       "      <th>combined_제품특성</th>\n",
       "      <th>tokenized_제품특성</th>\n",
       "      <th>tokenized_제품특성_cleaned</th>\n",
       "      <th>대분류:건강식품</th>\n",
       "      <th>대분류:출산/유아동</th>\n",
       "      <th>대분류:유아 선크림</th>\n",
       "      <th>대분류:생활용품/뷰티</th>\n",
       "      <th>대분류:식품</th>\n",
       "      <th>중분류:성인</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>B002-00001-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0007</td>\n",
       "      <td>B002-C003-0038</td>\n",
       "      <td>B002-00001</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>{'헤어타입': '모든', '모발용 제품형태': '스프레이형', '주요제품특징': ...</td>\n",
       "      <td>모든 스프레이형 흡수력 부드러운 윤기부여 영양공급 30ml 1개 50ml</td>\n",
       "      <td>모든 스프레이 흡수 윤기 부여 영양 공급 개</td>\n",
       "      <td>모든 스프레이 흡수 윤기 부여 영양 공급</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>12</td>\n",
       "      <td>B002-00003-00009</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-00003</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>{'생균': '100억', 'CFU 1일 총 섭취량': '1캡슐', '제품용량': ...</td>\n",
       "      <td>100억 1캡슐 1개월분 캡슐 하루 물과 성인남녀 체지방 감소 480mg x 30캡슐</td>\n",
       "      <td>캡슐 개월 캡슐 하루 물 성인 남녀 체지방 감소 캡슐</td>\n",
       "      <td>캡슐 개월 캡슐 하루 성인 남녀 체지방 감소 캡슐</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>16</td>\n",
       "      <td>B002-00005-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>{'피부타입': '모든피부용', '향계열': '과일향', '주요제품특징': '촉촉함...</td>\n",
       "      <td>모든피부용 과일향 촉촉함 펌프형 500ml 1개 500ml</td>\n",
       "      <td>피부 용 과일 향 펌프 개</td>\n",
       "      <td>피부 과일 펌프</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>17</td>\n",
       "      <td>B002-00005-00002</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>{'향계열': '과일향', '주요제품특징': '향', '펌프형': '1개 500ml'}</td>\n",
       "      <td>과일향 향 1개 500ml</td>\n",
       "      <td>과일 향 향 개</td>\n",
       "      <td>과일</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>19</td>\n",
       "      <td>B002-00005-00004</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>{'형태': '튜브형', '575ml': '1개', '520ml': '1개', '6...</td>\n",
       "      <td>튜브형 1개 1개 1개 575ml</td>\n",
       "      <td>튜브 개 개 개</td>\n",
       "      <td>튜브</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15877</th>\n",
       "      <td>15877</td>\n",
       "      <td>B002-03798-00049</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>{'재질': '기타'}</td>\n",
       "      <td>기타</td>\n",
       "      <td>기타</td>\n",
       "      <td>기타</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15882</th>\n",
       "      <td>15882</td>\n",
       "      <td>B002-03798-00054</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>{'형태': '빨대형', '용량': '300ml', '특징': '양손잡이', '흘림...</td>\n",
       "      <td>빨대형 300ml 양손잡이 PE 스테인리스스틸</td>\n",
       "      <td>빨대 양손잡이 스테인리스 스틸</td>\n",
       "      <td>빨대 양손잡이 스테인리스 스틸</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15883</th>\n",
       "      <td>15883</td>\n",
       "      <td>B002-03798-00055</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>{'형태': '머그형', '용량': '240ml', '특징': '미끄럼방지', 'B...</td>\n",
       "      <td>머그형 240ml 미끄럼방지 ABS 스테인리스스틸</td>\n",
       "      <td>머그 미끄럼 방지 스테인리스 스틸</td>\n",
       "      <td>머그 미끄럼 방지 스테인리스 스틸</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15887</th>\n",
       "      <td>15887</td>\n",
       "      <td>B002-03799-00004</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>{'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...</td>\n",
       "      <td>이유식보관용기 전자레인지사용 실리콘 3개세트 LLG508S3</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 개 세트</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 세트</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15888</th>\n",
       "      <td>15888</td>\n",
       "      <td>B002-03799-00005</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>{'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...</td>\n",
       "      <td>이유식보관용기 전자레인지사용 실리콘 3개세트 LLG509S3</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 개 세트</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 세트</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10481 rows × 479 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          ID                제품             대분류             중분류  \\\n",
       "0          0  B002-00001-00001  B002-C001-0002  B002-C002-0007   \n",
       "12        12  B002-00003-00009  B002-C001-0001  B002-C002-0001   \n",
       "16        16  B002-00005-00001  B002-C001-0002  B002-C002-0006   \n",
       "17        17  B002-00005-00002  B002-C001-0002  B002-C002-0006   \n",
       "19        19  B002-00005-00004  B002-C001-0002  B002-C002-0006   \n",
       "...      ...               ...             ...             ...   \n",
       "15877  15877  B002-03798-00049  B002-C001-0003  B002-C002-0008   \n",
       "15882  15882  B002-03798-00054  B002-C001-0003  B002-C002-0008   \n",
       "15883  15883  B002-03798-00055  B002-C001-0003  B002-C002-0008   \n",
       "15887  15887  B002-03799-00004  B002-C001-0003  B002-C002-0008   \n",
       "15888  15888  B002-03799-00005  B002-C001-0003  B002-C002-0008   \n",
       "\n",
       "                  소분류         브랜드  2022-01-01  2022-01-02  2022-01-03  \\\n",
       "0      B002-C003-0038  B002-00001           0           0           0   \n",
       "12     B002-C003-0003  B002-00003           0           0           0   \n",
       "16     B002-C003-0032  B002-00005           0           0           0   \n",
       "17     B002-C003-0032  B002-00005           0           0           0   \n",
       "19     B002-C003-0032  B002-00005           0           0           0   \n",
       "...               ...         ...         ...         ...         ...   \n",
       "15877  B002-C003-0044  B002-03798           0           0           0   \n",
       "15882  B002-C003-0044  B002-03798           0           0           0   \n",
       "15883  B002-C003-0044  B002-03798           0           0           0   \n",
       "15887  B002-C003-0044  B002-03799           0           0           0   \n",
       "15888  B002-C003-0044  B002-03799           0           0           0   \n",
       "\n",
       "       2022-01-04  ...                                        parsed_제품특성  \\\n",
       "0               0  ...  {'헤어타입': '모든', '모발용 제품형태': '스프레이형', '주요제품특징': ...   \n",
       "12              0  ...  {'생균': '100억', 'CFU 1일 총 섭취량': '1캡슐', '제품용량': ...   \n",
       "16              0  ...  {'피부타입': '모든피부용', '향계열': '과일향', '주요제품특징': '촉촉함...   \n",
       "17              0  ...   {'향계열': '과일향', '주요제품특징': '향', '펌프형': '1개 500ml'}   \n",
       "19              0  ...  {'형태': '튜브형', '575ml': '1개', '520ml': '1개', '6...   \n",
       "...           ...  ...                                                ...   \n",
       "15877           0  ...                                       {'재질': '기타'}   \n",
       "15882           0  ...  {'형태': '빨대형', '용량': '300ml', '특징': '양손잡이', '흘림...   \n",
       "15883           0  ...  {'형태': '머그형', '용량': '240ml', '특징': '미끄럼방지', 'B...   \n",
       "15887           0  ...  {'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...   \n",
       "15888           0  ...  {'종류': '이유식보관용기', '특징': '전자레인지사용', '재질': '실리콘 ...   \n",
       "\n",
       "                                         combined_제품특성  \\\n",
       "0             모든 스프레이형 흡수력 부드러운 윤기부여 영양공급 30ml 1개 50ml   \n",
       "12     100억 1캡슐 1개월분 캡슐 하루 물과 성인남녀 체지방 감소 480mg x 30캡슐   \n",
       "16                    모든피부용 과일향 촉촉함 펌프형 500ml 1개 500ml   \n",
       "17                                      과일향 향 1개 500ml   \n",
       "19                                  튜브형 1개 1개 1개 575ml   \n",
       "...                                                ...   \n",
       "15877                                               기타   \n",
       "15882                        빨대형 300ml 양손잡이 PE 스테인리스스틸   \n",
       "15883                      머그형 240ml 미끄럼방지 ABS 스테인리스스틸   \n",
       "15887                이유식보관용기 전자레인지사용 실리콘 3개세트 LLG508S3   \n",
       "15888                이유식보관용기 전자레인지사용 실리콘 3개세트 LLG509S3   \n",
       "\n",
       "                      tokenized_제품특성       tokenized_제품특성_cleaned  대분류:건강식품  \\\n",
       "0           모든 스프레이 흡수 윤기 부여 영양 공급 개       모든 스프레이 흡수 윤기 부여 영양 공급         0   \n",
       "12     캡슐 개월 캡슐 하루 물 성인 남녀 체지방 감소 캡슐  캡슐 개월 캡슐 하루 성인 남녀 체지방 감소 캡슐         1   \n",
       "16                    피부 용 과일 향 펌프 개                     피부 과일 펌프         0   \n",
       "17                          과일 향 향 개                           과일         0   \n",
       "19                          튜브 개 개 개                           튜브         0   \n",
       "...                              ...                          ...       ...   \n",
       "15877                             기타                           기타         0   \n",
       "15882               빨대 양손잡이 스테인리스 스틸             빨대 양손잡이 스테인리스 스틸         0   \n",
       "15883             머그 미끄럼 방지 스테인리스 스틸           머그 미끄럼 방지 스테인리스 스틸         0   \n",
       "15887    이유식 보관 용기 전자레인지 사용 실리콘 개 세트    이유식 보관 용기 전자레인지 사용 실리콘 세트         0   \n",
       "15888    이유식 보관 용기 전자레인지 사용 실리콘 개 세트    이유식 보관 용기 전자레인지 사용 실리콘 세트         0   \n",
       "\n",
       "       대분류:출산/유아동  대분류:유아 선크림  대분류:생활용품/뷰티  대분류:식품  중분류:성인  \n",
       "0               0           0            1       0       0  \n",
       "12              0           0            0       0       1  \n",
       "16              0           0            1       0       0  \n",
       "17              0           0            1       0       0  \n",
       "19              0           0            1       0       0  \n",
       "...           ...         ...          ...     ...     ...  \n",
       "15877           1           0            0       0       0  \n",
       "15882           1           0            0       0       0  \n",
       "15883           1           0            0       0       0  \n",
       "15887           1           0            0       0       0  \n",
       "15888           1           0            0       0       0  \n",
       "\n",
       "[10481 rows x 479 columns]"
      ]
     },
     "execution_count": 127,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merged['중분류:성인'] = merged['중분류'].apply(lambda x: 1 if x == 'B002-C002-0001' else 0)\n",
    "merged"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 128,
   "id": "0ccce56a",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Karl\\AppData\\Local\\Temp\\ipykernel_29388\\4205055236.py:1: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  merged['중분류:영유아'] = merged['중분류'].apply(lambda x: 1 if x == 'B002-C002-0009' else 0)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>제품</th>\n",
       "      <th>대분류</th>\n",
       "      <th>중분류</th>\n",
       "      <th>소분류</th>\n",
       "      <th>브랜드</th>\n",
       "      <th>2022-01-01</th>\n",
       "      <th>2022-01-02</th>\n",
       "      <th>2022-01-03</th>\n",
       "      <th>2022-01-04</th>\n",
       "      <th>...</th>\n",
       "      <th>combined_제품특성</th>\n",
       "      <th>tokenized_제품특성</th>\n",
       "      <th>tokenized_제품특성_cleaned</th>\n",
       "      <th>대분류:건강식품</th>\n",
       "      <th>대분류:출산/유아동</th>\n",
       "      <th>대분류:유아 선크림</th>\n",
       "      <th>대분류:생활용품/뷰티</th>\n",
       "      <th>대분류:식품</th>\n",
       "      <th>중분류:성인</th>\n",
       "      <th>중분류:영유아</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>B002-00001-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0007</td>\n",
       "      <td>B002-C003-0038</td>\n",
       "      <td>B002-00001</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>모든 스프레이형 흡수력 부드러운 윤기부여 영양공급 30ml 1개 50ml</td>\n",
       "      <td>모든 스프레이 흡수 윤기 부여 영양 공급 개</td>\n",
       "      <td>모든 스프레이 흡수 윤기 부여 영양 공급</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>12</td>\n",
       "      <td>B002-00003-00009</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-00003</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>100억 1캡슐 1개월분 캡슐 하루 물과 성인남녀 체지방 감소 480mg x 30캡슐</td>\n",
       "      <td>캡슐 개월 캡슐 하루 물 성인 남녀 체지방 감소 캡슐</td>\n",
       "      <td>캡슐 개월 캡슐 하루 성인 남녀 체지방 감소 캡슐</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>16</td>\n",
       "      <td>B002-00005-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>모든피부용 과일향 촉촉함 펌프형 500ml 1개 500ml</td>\n",
       "      <td>피부 용 과일 향 펌프 개</td>\n",
       "      <td>피부 과일 펌프</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>17</td>\n",
       "      <td>B002-00005-00002</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>과일향 향 1개 500ml</td>\n",
       "      <td>과일 향 향 개</td>\n",
       "      <td>과일</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>19</td>\n",
       "      <td>B002-00005-00004</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>튜브형 1개 1개 1개 575ml</td>\n",
       "      <td>튜브 개 개 개</td>\n",
       "      <td>튜브</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15877</th>\n",
       "      <td>15877</td>\n",
       "      <td>B002-03798-00049</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>기타</td>\n",
       "      <td>기타</td>\n",
       "      <td>기타</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15882</th>\n",
       "      <td>15882</td>\n",
       "      <td>B002-03798-00054</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>빨대형 300ml 양손잡이 PE 스테인리스스틸</td>\n",
       "      <td>빨대 양손잡이 스테인리스 스틸</td>\n",
       "      <td>빨대 양손잡이 스테인리스 스틸</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15883</th>\n",
       "      <td>15883</td>\n",
       "      <td>B002-03798-00055</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>머그형 240ml 미끄럼방지 ABS 스테인리스스틸</td>\n",
       "      <td>머그 미끄럼 방지 스테인리스 스틸</td>\n",
       "      <td>머그 미끄럼 방지 스테인리스 스틸</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15887</th>\n",
       "      <td>15887</td>\n",
       "      <td>B002-03799-00004</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>이유식보관용기 전자레인지사용 실리콘 3개세트 LLG508S3</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 개 세트</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 세트</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15888</th>\n",
       "      <td>15888</td>\n",
       "      <td>B002-03799-00005</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>이유식보관용기 전자레인지사용 실리콘 3개세트 LLG509S3</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 개 세트</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 세트</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10481 rows × 480 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          ID                제품             대분류             중분류  \\\n",
       "0          0  B002-00001-00001  B002-C001-0002  B002-C002-0007   \n",
       "12        12  B002-00003-00009  B002-C001-0001  B002-C002-0001   \n",
       "16        16  B002-00005-00001  B002-C001-0002  B002-C002-0006   \n",
       "17        17  B002-00005-00002  B002-C001-0002  B002-C002-0006   \n",
       "19        19  B002-00005-00004  B002-C001-0002  B002-C002-0006   \n",
       "...      ...               ...             ...             ...   \n",
       "15877  15877  B002-03798-00049  B002-C001-0003  B002-C002-0008   \n",
       "15882  15882  B002-03798-00054  B002-C001-0003  B002-C002-0008   \n",
       "15883  15883  B002-03798-00055  B002-C001-0003  B002-C002-0008   \n",
       "15887  15887  B002-03799-00004  B002-C001-0003  B002-C002-0008   \n",
       "15888  15888  B002-03799-00005  B002-C001-0003  B002-C002-0008   \n",
       "\n",
       "                  소분류         브랜드  2022-01-01  2022-01-02  2022-01-03  \\\n",
       "0      B002-C003-0038  B002-00001           0           0           0   \n",
       "12     B002-C003-0003  B002-00003           0           0           0   \n",
       "16     B002-C003-0032  B002-00005           0           0           0   \n",
       "17     B002-C003-0032  B002-00005           0           0           0   \n",
       "19     B002-C003-0032  B002-00005           0           0           0   \n",
       "...               ...         ...         ...         ...         ...   \n",
       "15877  B002-C003-0044  B002-03798           0           0           0   \n",
       "15882  B002-C003-0044  B002-03798           0           0           0   \n",
       "15883  B002-C003-0044  B002-03798           0           0           0   \n",
       "15887  B002-C003-0044  B002-03799           0           0           0   \n",
       "15888  B002-C003-0044  B002-03799           0           0           0   \n",
       "\n",
       "       2022-01-04  ...                                    combined_제품특성  \\\n",
       "0               0  ...         모든 스프레이형 흡수력 부드러운 윤기부여 영양공급 30ml 1개 50ml   \n",
       "12              0  ...  100억 1캡슐 1개월분 캡슐 하루 물과 성인남녀 체지방 감소 480mg x 30캡슐   \n",
       "16              0  ...                 모든피부용 과일향 촉촉함 펌프형 500ml 1개 500ml   \n",
       "17              0  ...                                   과일향 향 1개 500ml   \n",
       "19              0  ...                               튜브형 1개 1개 1개 575ml   \n",
       "...           ...  ...                                              ...   \n",
       "15877           0  ...                                               기타   \n",
       "15882           0  ...                        빨대형 300ml 양손잡이 PE 스테인리스스틸   \n",
       "15883           0  ...                      머그형 240ml 미끄럼방지 ABS 스테인리스스틸   \n",
       "15887           0  ...                이유식보관용기 전자레인지사용 실리콘 3개세트 LLG508S3   \n",
       "15888           0  ...                이유식보관용기 전자레인지사용 실리콘 3개세트 LLG509S3   \n",
       "\n",
       "                      tokenized_제품특성       tokenized_제품특성_cleaned  대분류:건강식품  \\\n",
       "0           모든 스프레이 흡수 윤기 부여 영양 공급 개       모든 스프레이 흡수 윤기 부여 영양 공급         0   \n",
       "12     캡슐 개월 캡슐 하루 물 성인 남녀 체지방 감소 캡슐  캡슐 개월 캡슐 하루 성인 남녀 체지방 감소 캡슐         1   \n",
       "16                    피부 용 과일 향 펌프 개                     피부 과일 펌프         0   \n",
       "17                          과일 향 향 개                           과일         0   \n",
       "19                          튜브 개 개 개                           튜브         0   \n",
       "...                              ...                          ...       ...   \n",
       "15877                             기타                           기타         0   \n",
       "15882               빨대 양손잡이 스테인리스 스틸             빨대 양손잡이 스테인리스 스틸         0   \n",
       "15883             머그 미끄럼 방지 스테인리스 스틸           머그 미끄럼 방지 스테인리스 스틸         0   \n",
       "15887    이유식 보관 용기 전자레인지 사용 실리콘 개 세트    이유식 보관 용기 전자레인지 사용 실리콘 세트         0   \n",
       "15888    이유식 보관 용기 전자레인지 사용 실리콘 개 세트    이유식 보관 용기 전자레인지 사용 실리콘 세트         0   \n",
       "\n",
       "       대분류:출산/유아동  대분류:유아 선크림  대분류:생활용품/뷰티  대분류:식품  중분류:성인  중분류:영유아  \n",
       "0               0           0            1       0       0        0  \n",
       "12              0           0            0       0       1        0  \n",
       "16              0           0            1       0       0        0  \n",
       "17              0           0            1       0       0        0  \n",
       "19              0           0            1       0       0        0  \n",
       "...           ...         ...          ...     ...     ...      ...  \n",
       "15877           1           0            0       0       0        0  \n",
       "15882           1           0            0       0       0        0  \n",
       "15883           1           0            0       0       0        0  \n",
       "15887           1           0            0       0       0        0  \n",
       "15888           1           0            0       0       0        0  \n",
       "\n",
       "[10481 rows x 480 columns]"
      ]
     },
     "execution_count": 128,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merged['중분류:영유아'] = merged['중분류'].apply(lambda x: 1 if x == 'B002-C002-0009' else 0)\n",
    "merged"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 129,
   "id": "5844a37c",
   "metadata": {},
   "outputs": [],
   "source": [
    "sub_category = {'B002-C002-0001':'중분류:성인', 'B002-C002-0009':'중분류:영유아'}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 146,
   "id": "4f16f3e7",
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['B002-C002-0007' 'B002-C002-0006' 'B002-C002-0004' 'B002-C002-0005'\n",
      " 'B002-C002-0002' 'B002-C002-0003' 'B002-C002-0009']\n"
     ]
    }
   ],
   "source": [
    "filtered_data = merged[merged['대분류'] == 'B002-C001-0002']\n",
    "unique_subcategories = filtered_data['중분류'].unique()\n",
    "print(unique_subcategories)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "21b5cf82",
   "metadata": {},
   "source": [
    "## 중분류 분석"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 147,
   "id": "0adaa2b1",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[('일회용', 39), ('회용', 27), ('봉지', 26), ('용기', 25), ('걸이', 12), ('액체', 11), ('개입', 9), ('피부', 9), ('부직포', 8), ('원형', 8), ('리필', 8), ('일반', 8), ('재사용', 7), ('스틱', 7), ('체형', 7), ('폴리프로필렌', 5), ('파라', 5), ('스테인리스', 4), ('스틸', 4), ('기타', 4), ('세트', 4), ('튜브', 4), ('크림', 4), ('펌프', 4), ('스프레이', 3), ('클립', 3), ('실리카겔', 3), ('염화칼슘', 3), ('비치', 3), ('램프', 3)]\n"
     ]
    }
   ],
   "source": [
    "filtered_data = merged[merged['중분류'] =='B002-C002-0002'].copy()\n",
    "filtered_data['tokenized_제품특성_cleaned'] = filtered_data['tokenized_제품특성_cleaned'].apply(lambda x: x.split() if isinstance(x, str) else [])\n",
    "# Now sum up all the token lists into a single list\n",
    "all_tokens = sum(filtered_data['tokenized_제품특성_cleaned'], [])\n",
    "\n",
    "# Proceed with counting the tokens\n",
    "from collections import Counter\n",
    "token_counts = Counter(all_tokens)\n",
    "\n",
    "# Identify the most common tokens\n",
    "most_common_tokens = token_counts.most_common(30)  # adjust the number as needed\n",
    "\n",
    "print(most_common_tokens)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 150,
   "id": "b984ec56",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>제품</th>\n",
       "      <th>대분류</th>\n",
       "      <th>중분류</th>\n",
       "      <th>소분류</th>\n",
       "      <th>브랜드</th>\n",
       "      <th>2022-01-01</th>\n",
       "      <th>2022-01-02</th>\n",
       "      <th>2022-01-03</th>\n",
       "      <th>2022-01-04</th>\n",
       "      <th>...</th>\n",
       "      <th>combined_제품특성</th>\n",
       "      <th>tokenized_제품특성</th>\n",
       "      <th>tokenized_제품특성_cleaned</th>\n",
       "      <th>대분류:건강식품</th>\n",
       "      <th>대분류:출산/유아동</th>\n",
       "      <th>대분류:유아 선크림</th>\n",
       "      <th>대분류:생활용품/뷰티</th>\n",
       "      <th>대분류:식품</th>\n",
       "      <th>중분류:성인</th>\n",
       "      <th>중분류:영유아</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>8638</th>\n",
       "      <td>8638</td>\n",
       "      <td>B002-02058-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0008</td>\n",
       "      <td>B002-02058</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>본품 가루형 1종 1000ml 1개 구연산 1개 1개 500ml 1개 1개</td>\n",
       "      <td>품 가루 종 개 구연산 개 개 개 개</td>\n",
       "      <td>[가루, 구연산]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9076</th>\n",
       "      <td>9076</td>\n",
       "      <td>B002-02142-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0008</td>\n",
       "      <td>B002-02142</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>11</td>\n",
       "      <td>...</td>\n",
       "      <td>모든피부용 우디향 향 튜브형 50ml 1개 97 에이프릴코튼 150ml 영양공급 흡...</td>\n",
       "      <td>피부 용 우디 향 향 튜브 개 에이프릴 코튼 영양 공급 흡수 튜브 개 흡수 개 영양...</td>\n",
       "      <td>[피부, 우디, 튜브, 에이프릴, 코튼, 영양, 공급, 흡수, 튜브, 흡수, 영양,...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9078</th>\n",
       "      <td>9078</td>\n",
       "      <td>B002-02142-00003</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0008</td>\n",
       "      <td>B002-02142</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>본품 1개 모든피부용 기타향 촉촉함 튜브형 50ml 1개 발림성 발림성 뚜껑형 1개...</td>\n",
       "      <td>품 개 피부 용 기타 향 튜브 개 발림 발림 뚜껑 개 개 에이프릴 코튼 핸드 크림 ...</td>\n",
       "      <td>[피부, 기타, 튜브, 발림, 발림, 뚜껑, 에이프릴, 코튼, 핸드, 크림, 크림,...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9131</th>\n",
       "      <td>9131</td>\n",
       "      <td>B002-02163-00004</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0007</td>\n",
       "      <td>B002-02163</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>좀벌레퇴치 10개</td>\n",
       "      <td>좀벌레 퇴치 개</td>\n",
       "      <td>[좀벌레, 퇴치]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9140</th>\n",
       "      <td>9140</td>\n",
       "      <td>B002-02163-00017</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0007</td>\n",
       "      <td>B002-02163</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>좀벌레퇴치 3개</td>\n",
       "      <td>좀벌레 퇴치 개</td>\n",
       "      <td>[좀벌레, 퇴치]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9189</th>\n",
       "      <td>9189</td>\n",
       "      <td>B002-02175-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0010</td>\n",
       "      <td>B002-02175</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>35cm 35x45cm 500매</td>\n",
       "      <td>매</td>\n",
       "      <td>[]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9218</th>\n",
       "      <td>9218</td>\n",
       "      <td>B002-02192-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0007</td>\n",
       "      <td>B002-02192</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>정 4정 단백질 230x120캅셀mg 캡슐 가공소금 정 본품 정 면역력 정 200g</td>\n",
       "      <td>정 정 단백질 캅셀 캡슐 가공 소금 정 품 정 면역 정</td>\n",
       "      <td>[단백질, 캅셀, 캡슐, 가공, 소금, 면역]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9283</th>\n",
       "      <td>9283</td>\n",
       "      <td>B002-02209-00027</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0011</td>\n",
       "      <td>B002-02209</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>용기형 일회용 1개 300g</td>\n",
       "      <td>용기 일회용 개</td>\n",
       "      <td>[용기, 일회용]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9293</th>\n",
       "      <td>9293</td>\n",
       "      <td>B002-02209-00040</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0011</td>\n",
       "      <td>B002-02209</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>용기형 일회용 1개 300g</td>\n",
       "      <td>용기 일회용 개</td>\n",
       "      <td>[용기, 일회용]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9372</th>\n",
       "      <td>9372</td>\n",
       "      <td>B002-02221-00002</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0009</td>\n",
       "      <td>B002-02221</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>다회용 2개 다회용 다회용 1단</td>\n",
       "      <td>회용 개 회용 회용 단</td>\n",
       "      <td>[회용, 회용, 회용]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9660</th>\n",
       "      <td>9660</td>\n",
       "      <td>B002-02262-00013</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0011</td>\n",
       "      <td>B002-02262</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>용기형 일회용 1개 280g</td>\n",
       "      <td>용기 일회용 개</td>\n",
       "      <td>[용기, 일회용]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9662</th>\n",
       "      <td>9662</td>\n",
       "      <td>B002-02262-00016</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0011</td>\n",
       "      <td>B002-02262</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>용기형 일회용 1개 280g</td>\n",
       "      <td>용기 일회용 개</td>\n",
       "      <td>[용기, 일회용]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9878</th>\n",
       "      <td>9878</td>\n",
       "      <td>B002-02301-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0006</td>\n",
       "      <td>B002-02301</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>종이형 1개</td>\n",
       "      <td>종이 개</td>\n",
       "      <td>[종이]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10257</th>\n",
       "      <td>10257</td>\n",
       "      <td>B002-02380-00005</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0010</td>\n",
       "      <td>B002-02380</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>3개 30x35cm 20매</td>\n",
       "      <td>개 매</td>\n",
       "      <td>[]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10589</th>\n",
       "      <td>10589</td>\n",
       "      <td>B002-02455-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0008</td>\n",
       "      <td>B002-02455</td>\n",
       "      <td>12</td>\n",
       "      <td>13</td>\n",
       "      <td>13</td>\n",
       "      <td>13</td>\n",
       "      <td>...</td>\n",
       "      <td>리필 1 일반 무미세플라스틱 무CMIT 1개 일반 1개 일반 1개 무파라벤 1개 1...</td>\n",
       "      <td>리필 일반 무미 플라스틱 무 개 일반 개 일반 개 무 파라 개 개 개 개 품</td>\n",
       "      <td>[리필, 일반, 무미, 플라스틱, 일반, 일반, 파라]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10590</th>\n",
       "      <td>10590</td>\n",
       "      <td>B002-02455-00002</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0008</td>\n",
       "      <td>B002-02455</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>리필 1 일반 무미세플라스틱 무파라벤 무파라벤 1개 일반 1개 1개 일반 1개 1개...</td>\n",
       "      <td>리필 일반 무미 플라스틱 무 파라 무 파라 개 일반 개 개 일반 개 개 개 개 품</td>\n",
       "      <td>[리필, 일반, 무미, 플라스틱, 파라, 파라, 일반, 일반]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10629</th>\n",
       "      <td>10629</td>\n",
       "      <td>B002-02455-00047</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0008</td>\n",
       "      <td>B002-02455</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>리필 1 3L 320ml X 8개 일반 무미세플라스틱 무파라벤 무파라벤 1개 1개 ...</td>\n",
       "      <td>리필 개 일반 무미 플라스틱 무 파라 무 파라 개 개 개 개</td>\n",
       "      <td>[리필, 일반, 무미, 플라스틱, 파라, 파라]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10643</th>\n",
       "      <td>10643</td>\n",
       "      <td>B002-02455-00068</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0008</td>\n",
       "      <td>B002-02455</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>본품 꽃향 1개 20매</td>\n",
       "      <td>품 꽃향 개 매</td>\n",
       "      <td>[꽃향]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10670</th>\n",
       "      <td>10670</td>\n",
       "      <td>B002-02455-00108</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0008</td>\n",
       "      <td>B002-02455</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>모든피부용 과일향 촉촉함 3500ml 1개 모든피부용 모든피부용 모든피부용 본품 캡...</td>\n",
       "      <td>피부 용 과일 향 개 피부 용 피부 용 피부 용 품 캡 항균 리필 펌프 품</td>\n",
       "      <td>[피부, 과일, 피부, 피부, 피부, 항균, 리필, 펌프]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10676</th>\n",
       "      <td>10676</td>\n",
       "      <td>B002-02455-00120</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0008</td>\n",
       "      <td>B002-02455</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>페이스용 모든피부용 촉촉함 촉촉함 튜브형 500ml 1개 300ml 향 로션형 1개...</td>\n",
       "      <td>페이스 용 피부 용 튜브 개 향 로션 개 종 세트 기획 세트 매 무 알코올 팩 품 ...</td>\n",
       "      <td>[페이스, 피부, 튜브, 로션, 세트, 기획, 세트, 알코올, 세트, 트러스, 펌프...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10678</th>\n",
       "      <td>10678</td>\n",
       "      <td>B002-02456-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0006</td>\n",
       "      <td>B002-02456</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>석고형 고체형 1개</td>\n",
       "      <td>석고 체형 개</td>\n",
       "      <td>[석고, 체형]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10775</th>\n",
       "      <td>10775</td>\n",
       "      <td>B002-02475-00002</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0011</td>\n",
       "      <td>B002-02475</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>봉지형 재사용 1개 520mlx24</td>\n",
       "      <td>봉지 재사용 개</td>\n",
       "      <td>[봉지, 재사용]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10789</th>\n",
       "      <td>10789</td>\n",
       "      <td>B002-02476-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0007</td>\n",
       "      <td>B002-02476</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>실내 램프 250ml</td>\n",
       "      <td>실내 램프</td>\n",
       "      <td>[실내, 램프]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10982</th>\n",
       "      <td>10982</td>\n",
       "      <td>B002-02517-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0006</td>\n",
       "      <td>B002-02517</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>고체형 1개</td>\n",
       "      <td>체형 개</td>\n",
       "      <td>[체형]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11096</th>\n",
       "      <td>11096</td>\n",
       "      <td>B002-02551-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0011</td>\n",
       "      <td>B002-02551</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>봉지형 25kg</td>\n",
       "      <td>봉지</td>\n",
       "      <td>[봉지]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11345</th>\n",
       "      <td>11345</td>\n",
       "      <td>B002-02629-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0010</td>\n",
       "      <td>B002-02629</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>중 20매</td>\n",
       "      <td>중 매</td>\n",
       "      <td>[]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11346</th>\n",
       "      <td>11346</td>\n",
       "      <td>B002-02629-00002</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0010</td>\n",
       "      <td>B002-02629</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1개 21 5x17cm 12매</td>\n",
       "      <td>개 매</td>\n",
       "      <td>[]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11347</th>\n",
       "      <td>11347</td>\n",
       "      <td>B002-02629-00003</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0010</td>\n",
       "      <td>B002-02629</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>2개 25매</td>\n",
       "      <td>개 매</td>\n",
       "      <td>[]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11348</th>\n",
       "      <td>11348</td>\n",
       "      <td>B002-02629-00004</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0010</td>\n",
       "      <td>B002-02629</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1개 30cmx30cm 8매</td>\n",
       "      <td>개 매</td>\n",
       "      <td>[]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11569</th>\n",
       "      <td>11569</td>\n",
       "      <td>B002-02709-00002</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0010</td>\n",
       "      <td>B002-02709</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1개 30x35cm 20매</td>\n",
       "      <td>개 매</td>\n",
       "      <td>[]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12037</th>\n",
       "      <td>12037</td>\n",
       "      <td>B002-02850-00004</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0007</td>\n",
       "      <td>B002-02850</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1개 290ml</td>\n",
       "      <td>개</td>\n",
       "      <td>[]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12154</th>\n",
       "      <td>12154</td>\n",
       "      <td>B002-02882-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0007</td>\n",
       "      <td>B002-02882</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>휴대용 램프 2B</td>\n",
       "      <td>휴대 용 램프</td>\n",
       "      <td>[휴대, 램프]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12169</th>\n",
       "      <td>12169</td>\n",
       "      <td>B002-02888-00004</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0011</td>\n",
       "      <td>B002-02888</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>걸이형 5개 250g 5개 일회용</td>\n",
       "      <td>걸이 개 개 일회용</td>\n",
       "      <td>[걸이, 일회용]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12769</th>\n",
       "      <td>12769</td>\n",
       "      <td>B002-03013-00006</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0011</td>\n",
       "      <td>B002-03013</td>\n",
       "      <td>3</td>\n",
       "      <td>9</td>\n",
       "      <td>6</td>\n",
       "      <td>9</td>\n",
       "      <td>...</td>\n",
       "      <td>용기형 재사용 3개 300g</td>\n",
       "      <td>용기 재사용 개</td>\n",
       "      <td>[용기, 재사용]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12774</th>\n",
       "      <td>12774</td>\n",
       "      <td>B002-03013-00012</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0011</td>\n",
       "      <td>B002-03013</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>용기형 재사용 3개 25g x 5개 60g x 5개</td>\n",
       "      <td>용기 재사용 개 개 개</td>\n",
       "      <td>[용기, 재사용]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13336</th>\n",
       "      <td>13336</td>\n",
       "      <td>B002-03176-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0006</td>\n",
       "      <td>B002-03176</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>고체형 1개 비치형</td>\n",
       "      <td>체형 개 비치</td>\n",
       "      <td>[체형, 비치]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13337</th>\n",
       "      <td>13337</td>\n",
       "      <td>B002-03176-00002</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0006</td>\n",
       "      <td>B002-03176</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>고체형 1개 비치형 42g</td>\n",
       "      <td>체형 개 비치</td>\n",
       "      <td>[체형, 비치]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13448</th>\n",
       "      <td>13448</td>\n",
       "      <td>B002-03206-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0011</td>\n",
       "      <td>B002-03206</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>용기형 8개 525ml</td>\n",
       "      <td>용기 개</td>\n",
       "      <td>[용기]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13449</th>\n",
       "      <td>13449</td>\n",
       "      <td>B002-03206-00009</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0011</td>\n",
       "      <td>B002-03206</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>봉지형 재사용 1개 실리카겔 10g</td>\n",
       "      <td>봉지 재사용 개 실리카겔</td>\n",
       "      <td>[봉지, 재사용, 실리카겔]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13497</th>\n",
       "      <td>13497</td>\n",
       "      <td>B002-03223-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0009</td>\n",
       "      <td>B002-03223</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>다회용 1종 본품 기타 다회용 일회용 삼베 3개입 x 3팩</td>\n",
       "      <td>회용 종 품 기타 회용 일회용 삼베 개입 팩</td>\n",
       "      <td>[회용, 기타, 회용, 일회용, 삼베, 개입]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14035</th>\n",
       "      <td>14035</td>\n",
       "      <td>B002-03326-00006</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0011</td>\n",
       "      <td>B002-03326</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>용기형 일회용 1개 24P</td>\n",
       "      <td>용기 일회용 개</td>\n",
       "      <td>[용기, 일회용]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14036</th>\n",
       "      <td>14036</td>\n",
       "      <td>B002-03326-00007</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0011</td>\n",
       "      <td>B002-03326</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>용기형 일회용 1개 염화칼슘</td>\n",
       "      <td>용기 일회용 개 염화칼슘</td>\n",
       "      <td>[용기, 일회용, 염화칼슘]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14149</th>\n",
       "      <td>14149</td>\n",
       "      <td>B002-03345-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0009</td>\n",
       "      <td>B002-03345</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>다회용 10개 2개입x5 셀룰로오스</td>\n",
       "      <td>회용 개 개입 셀룰로오스</td>\n",
       "      <td>[회용, 개입, 셀룰로오스]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14150</th>\n",
       "      <td>14150</td>\n",
       "      <td>B002-03345-00002</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0009</td>\n",
       "      <td>B002-03345</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>다회용 셀룰로오스</td>\n",
       "      <td>회용 셀룰로오스</td>\n",
       "      <td>[회용, 셀룰로오스]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14155</th>\n",
       "      <td>14155</td>\n",
       "      <td>B002-03345-00007</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0009</td>\n",
       "      <td>B002-03345</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>다회용 8개 2ea 4 친환경 거품이잘나는 코코넛껍질 양면 스펀지 셀룰로오스</td>\n",
       "      <td>회용 개 친환경 거품 코코넛 껍질 양면 스펀지 셀룰로오스</td>\n",
       "      <td>[회용, 친환경, 거품, 코코넛, 껍질, 양면, 스펀지, 셀룰로오스]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14747</th>\n",
       "      <td>14747</td>\n",
       "      <td>B002-03493-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0008</td>\n",
       "      <td>B002-03493</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>모든피부용 촉촉함 2개 2개 흡수력 오 플로럴 여성용 우디 펌프형 500ml</td>\n",
       "      <td>피부 용 개 개 흡수 오 로럴 성용 우디 펌프</td>\n",
       "      <td>[피부, 흡수, 로럴, 성용, 우디, 펌프]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15154</th>\n",
       "      <td>15154</td>\n",
       "      <td>B002-03620-00004</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0006</td>\n",
       "      <td>B002-03620</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>액체형 3개 2 2ml</td>\n",
       "      <td>액체 개</td>\n",
       "      <td>[액체]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15542</th>\n",
       "      <td>15542</td>\n",
       "      <td>B002-03725-00010</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0009</td>\n",
       "      <td>B002-03725</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>다회용 3개 스테인리스스틸</td>\n",
       "      <td>회용 개 스테인리스 스틸</td>\n",
       "      <td>[회용, 스테인리스, 스틸]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15608</th>\n",
       "      <td>15608</td>\n",
       "      <td>B002-03737-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0009</td>\n",
       "      <td>B002-03737</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "      <td>...</td>\n",
       "      <td>일회용 1EA 100매 3개월패키지 일회용 폴리프로필렌 일회용</td>\n",
       "      <td>일회용 매 개월 패키지 일회용 폴리프로필렌 일회용</td>\n",
       "      <td>[일회용, 개월, 패키지, 일회용, 폴리프로필렌, 일회용]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15696</th>\n",
       "      <td>15696</td>\n",
       "      <td>B002-03764-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0002</td>\n",
       "      <td>B002-C003-0007</td>\n",
       "      <td>B002-03764</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>페이스용 모든피부용 50 PA 커버력 자외선차단 15ml 본품 리필 500ml</td>\n",
       "      <td>페이스 용 피부 용 커버 자외선 차단 품 리필</td>\n",
       "      <td>[페이스, 피부, 커버, 자외선, 차단, 리필]</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>50 rows × 480 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          ID                제품             대분류             중분류  \\\n",
       "8638    8638  B002-02058-00001  B002-C001-0002  B002-C002-0002   \n",
       "9076    9076  B002-02142-00001  B002-C001-0002  B002-C002-0002   \n",
       "9078    9078  B002-02142-00003  B002-C001-0002  B002-C002-0002   \n",
       "9131    9131  B002-02163-00004  B002-C001-0002  B002-C002-0002   \n",
       "9140    9140  B002-02163-00017  B002-C001-0002  B002-C002-0002   \n",
       "9189    9189  B002-02175-00001  B002-C001-0002  B002-C002-0002   \n",
       "9218    9218  B002-02192-00001  B002-C001-0002  B002-C002-0002   \n",
       "9283    9283  B002-02209-00027  B002-C001-0002  B002-C002-0002   \n",
       "9293    9293  B002-02209-00040  B002-C001-0002  B002-C002-0002   \n",
       "9372    9372  B002-02221-00002  B002-C001-0002  B002-C002-0002   \n",
       "9660    9660  B002-02262-00013  B002-C001-0002  B002-C002-0002   \n",
       "9662    9662  B002-02262-00016  B002-C001-0002  B002-C002-0002   \n",
       "9878    9878  B002-02301-00001  B002-C001-0002  B002-C002-0002   \n",
       "10257  10257  B002-02380-00005  B002-C001-0002  B002-C002-0002   \n",
       "10589  10589  B002-02455-00001  B002-C001-0002  B002-C002-0002   \n",
       "10590  10590  B002-02455-00002  B002-C001-0002  B002-C002-0002   \n",
       "10629  10629  B002-02455-00047  B002-C001-0002  B002-C002-0002   \n",
       "10643  10643  B002-02455-00068  B002-C001-0002  B002-C002-0002   \n",
       "10670  10670  B002-02455-00108  B002-C001-0002  B002-C002-0002   \n",
       "10676  10676  B002-02455-00120  B002-C001-0002  B002-C002-0002   \n",
       "10678  10678  B002-02456-00001  B002-C001-0002  B002-C002-0002   \n",
       "10775  10775  B002-02475-00002  B002-C001-0002  B002-C002-0002   \n",
       "10789  10789  B002-02476-00001  B002-C001-0002  B002-C002-0002   \n",
       "10982  10982  B002-02517-00001  B002-C001-0002  B002-C002-0002   \n",
       "11096  11096  B002-02551-00001  B002-C001-0002  B002-C002-0002   \n",
       "11345  11345  B002-02629-00001  B002-C001-0002  B002-C002-0002   \n",
       "11346  11346  B002-02629-00002  B002-C001-0002  B002-C002-0002   \n",
       "11347  11347  B002-02629-00003  B002-C001-0002  B002-C002-0002   \n",
       "11348  11348  B002-02629-00004  B002-C001-0002  B002-C002-0002   \n",
       "11569  11569  B002-02709-00002  B002-C001-0002  B002-C002-0002   \n",
       "12037  12037  B002-02850-00004  B002-C001-0002  B002-C002-0002   \n",
       "12154  12154  B002-02882-00001  B002-C001-0002  B002-C002-0002   \n",
       "12169  12169  B002-02888-00004  B002-C001-0002  B002-C002-0002   \n",
       "12769  12769  B002-03013-00006  B002-C001-0002  B002-C002-0002   \n",
       "12774  12774  B002-03013-00012  B002-C001-0002  B002-C002-0002   \n",
       "13336  13336  B002-03176-00001  B002-C001-0002  B002-C002-0002   \n",
       "13337  13337  B002-03176-00002  B002-C001-0002  B002-C002-0002   \n",
       "13448  13448  B002-03206-00001  B002-C001-0002  B002-C002-0002   \n",
       "13449  13449  B002-03206-00009  B002-C001-0002  B002-C002-0002   \n",
       "13497  13497  B002-03223-00001  B002-C001-0002  B002-C002-0002   \n",
       "14035  14035  B002-03326-00006  B002-C001-0002  B002-C002-0002   \n",
       "14036  14036  B002-03326-00007  B002-C001-0002  B002-C002-0002   \n",
       "14149  14149  B002-03345-00001  B002-C001-0002  B002-C002-0002   \n",
       "14150  14150  B002-03345-00002  B002-C001-0002  B002-C002-0002   \n",
       "14155  14155  B002-03345-00007  B002-C001-0002  B002-C002-0002   \n",
       "14747  14747  B002-03493-00001  B002-C001-0002  B002-C002-0002   \n",
       "15154  15154  B002-03620-00004  B002-C001-0002  B002-C002-0002   \n",
       "15542  15542  B002-03725-00010  B002-C001-0002  B002-C002-0002   \n",
       "15608  15608  B002-03737-00001  B002-C001-0002  B002-C002-0002   \n",
       "15696  15696  B002-03764-00001  B002-C001-0002  B002-C002-0002   \n",
       "\n",
       "                  소분류         브랜드  2022-01-01  2022-01-02  2022-01-03  \\\n",
       "8638   B002-C003-0008  B002-02058           0           0           0   \n",
       "9076   B002-C003-0008  B002-02142          10          10          10   \n",
       "9078   B002-C003-0008  B002-02142           3           2           1   \n",
       "9131   B002-C003-0007  B002-02163           0           0           0   \n",
       "9140   B002-C003-0007  B002-02163           0           0           0   \n",
       "9189   B002-C003-0010  B002-02175           0           0           0   \n",
       "9218   B002-C003-0007  B002-02192           0           0           0   \n",
       "9283   B002-C003-0011  B002-02209           0           0           0   \n",
       "9293   B002-C003-0011  B002-02209           0           0           0   \n",
       "9372   B002-C003-0009  B002-02221           0           0           0   \n",
       "9660   B002-C003-0011  B002-02262           0           0           0   \n",
       "9662   B002-C003-0011  B002-02262           0           0           0   \n",
       "9878   B002-C003-0006  B002-02301           0           0           0   \n",
       "10257  B002-C003-0010  B002-02380           0           0           0   \n",
       "10589  B002-C003-0008  B002-02455          12          13          13   \n",
       "10590  B002-C003-0008  B002-02455           0           0           0   \n",
       "10629  B002-C003-0008  B002-02455           4           4           2   \n",
       "10643  B002-C003-0008  B002-02455           0           0           0   \n",
       "10670  B002-C003-0008  B002-02455           0           0           0   \n",
       "10676  B002-C003-0008  B002-02455           0           0           0   \n",
       "10678  B002-C003-0006  B002-02456           0           0           0   \n",
       "10775  B002-C003-0011  B002-02475           0           0           0   \n",
       "10789  B002-C003-0007  B002-02476           0           0           0   \n",
       "10982  B002-C003-0006  B002-02517           0           0           0   \n",
       "11096  B002-C003-0011  B002-02551           0           0           0   \n",
       "11345  B002-C003-0010  B002-02629           0           0           0   \n",
       "11346  B002-C003-0010  B002-02629           0           0           0   \n",
       "11347  B002-C003-0010  B002-02629           0           0           0   \n",
       "11348  B002-C003-0010  B002-02629           0           0           0   \n",
       "11569  B002-C003-0010  B002-02709           0           0           0   \n",
       "12037  B002-C003-0007  B002-02850           0           0           0   \n",
       "12154  B002-C003-0007  B002-02882           0           0           0   \n",
       "12169  B002-C003-0011  B002-02888           0           0           0   \n",
       "12769  B002-C003-0011  B002-03013           3           9           6   \n",
       "12774  B002-C003-0011  B002-03013           2           0           2   \n",
       "13336  B002-C003-0006  B002-03176           0           0           0   \n",
       "13337  B002-C003-0006  B002-03176           0           0           0   \n",
       "13448  B002-C003-0011  B002-03206           0           0           0   \n",
       "13449  B002-C003-0011  B002-03206           0           0           0   \n",
       "13497  B002-C003-0009  B002-03223           0           0           0   \n",
       "14035  B002-C003-0011  B002-03326           0           0           0   \n",
       "14036  B002-C003-0011  B002-03326           0           0           0   \n",
       "14149  B002-C003-0009  B002-03345           0           0           0   \n",
       "14150  B002-C003-0009  B002-03345           0           0           0   \n",
       "14155  B002-C003-0009  B002-03345           0           0           0   \n",
       "14747  B002-C003-0008  B002-03493           0           0           0   \n",
       "15154  B002-C003-0006  B002-03620           0           0           0   \n",
       "15542  B002-C003-0009  B002-03725           0           0           0   \n",
       "15608  B002-C003-0009  B002-03737           4           4           2   \n",
       "15696  B002-C003-0007  B002-03764           0           0           0   \n",
       "\n",
       "       2022-01-04  ...                                      combined_제품특성  \\\n",
       "8638            0  ...          본품 가루형 1종 1000ml 1개 구연산 1개 1개 500ml 1개 1개   \n",
       "9076           11  ...  모든피부용 우디향 향 튜브형 50ml 1개 97 에이프릴코튼 150ml 영양공급 흡...   \n",
       "9078            1  ...  본품 1개 모든피부용 기타향 촉촉함 튜브형 50ml 1개 발림성 발림성 뚜껑형 1개...   \n",
       "9131            0  ...                                          좀벌레퇴치 10개   \n",
       "9140            0  ...                                           좀벌레퇴치 3개   \n",
       "9189            0  ...                                  35cm 35x45cm 500매   \n",
       "9218            0  ...     정 4정 단백질 230x120캅셀mg 캡슐 가공소금 정 본품 정 면역력 정 200g   \n",
       "9283            0  ...                                    용기형 일회용 1개 300g   \n",
       "9293            0  ...                                    용기형 일회용 1개 300g   \n",
       "9372            0  ...                                  다회용 2개 다회용 다회용 1단   \n",
       "9660            0  ...                                    용기형 일회용 1개 280g   \n",
       "9662            0  ...                                    용기형 일회용 1개 280g   \n",
       "9878            0  ...                                             종이형 1개   \n",
       "10257           0  ...                                     3개 30x35cm 20매   \n",
       "10589          13  ...  리필 1 일반 무미세플라스틱 무CMIT 1개 일반 1개 일반 1개 무파라벤 1개 1...   \n",
       "10590           0  ...  리필 1 일반 무미세플라스틱 무파라벤 무파라벤 1개 일반 1개 1개 일반 1개 1개...   \n",
       "10629           1  ...  리필 1 3L 320ml X 8개 일반 무미세플라스틱 무파라벤 무파라벤 1개 1개 ...   \n",
       "10643           0  ...                                       본품 꽃향 1개 20매   \n",
       "10670           0  ...  모든피부용 과일향 촉촉함 3500ml 1개 모든피부용 모든피부용 모든피부용 본품 캡...   \n",
       "10676           0  ...  페이스용 모든피부용 촉촉함 촉촉함 튜브형 500ml 1개 300ml 향 로션형 1개...   \n",
       "10678           0  ...                                         석고형 고체형 1개   \n",
       "10775           0  ...                                봉지형 재사용 1개 520mlx24   \n",
       "10789           0  ...                                        실내 램프 250ml   \n",
       "10982           0  ...                                             고체형 1개   \n",
       "11096           0  ...                                           봉지형 25kg   \n",
       "11345           0  ...                                              중 20매   \n",
       "11346           0  ...                                   1개 21 5x17cm 12매   \n",
       "11347           0  ...                                             2개 25매   \n",
       "11348           0  ...                                    1개 30cmx30cm 8매   \n",
       "11569           0  ...                                     1개 30x35cm 20매   \n",
       "12037           0  ...                                           1개 290ml   \n",
       "12154           0  ...                                          휴대용 램프 2B   \n",
       "12169           0  ...                                 걸이형 5개 250g 5개 일회용   \n",
       "12769           9  ...                                    용기형 재사용 3개 300g   \n",
       "12774           0  ...                       용기형 재사용 3개 25g x 5개 60g x 5개   \n",
       "13336           0  ...                                         고체형 1개 비치형   \n",
       "13337           0  ...                                     고체형 1개 비치형 42g   \n",
       "13448           0  ...                                       용기형 8개 525ml   \n",
       "13449           0  ...                                봉지형 재사용 1개 실리카겔 10g   \n",
       "13497           0  ...                   다회용 1종 본품 기타 다회용 일회용 삼베 3개입 x 3팩   \n",
       "14035           0  ...                                     용기형 일회용 1개 24P   \n",
       "14036           0  ...                                    용기형 일회용 1개 염화칼슘   \n",
       "14149           0  ...                                다회용 10개 2개입x5 셀룰로오스   \n",
       "14150           0  ...                                          다회용 셀룰로오스   \n",
       "14155           0  ...         다회용 8개 2ea 4 친환경 거품이잘나는 코코넛껍질 양면 스펀지 셀룰로오스   \n",
       "14747           0  ...         모든피부용 촉촉함 2개 2개 흡수력 오 플로럴 여성용 우디 펌프형 500ml   \n",
       "15154           0  ...                                       액체형 3개 2 2ml   \n",
       "15542           0  ...                                     다회용 3개 스테인리스스틸   \n",
       "15608           4  ...                 일회용 1EA 100매 3개월패키지 일회용 폴리프로필렌 일회용   \n",
       "15696           0  ...        페이스용 모든피부용 50 PA 커버력 자외선차단 15ml 본품 리필 500ml   \n",
       "\n",
       "                                          tokenized_제품특성  \\\n",
       "8638                                품 가루 종 개 구연산 개 개 개 개   \n",
       "9076   피부 용 우디 향 향 튜브 개 에이프릴 코튼 영양 공급 흡수 튜브 개 흡수 개 영양...   \n",
       "9078   품 개 피부 용 기타 향 튜브 개 발림 발림 뚜껑 개 개 에이프릴 코튼 핸드 크림 ...   \n",
       "9131                                            좀벌레 퇴치 개   \n",
       "9140                                            좀벌레 퇴치 개   \n",
       "9189                                                   매   \n",
       "9218                      정 정 단백질 캅셀 캡슐 가공 소금 정 품 정 면역 정   \n",
       "9283                                            용기 일회용 개   \n",
       "9293                                            용기 일회용 개   \n",
       "9372                                        회용 개 회용 회용 단   \n",
       "9660                                            용기 일회용 개   \n",
       "9662                                            용기 일회용 개   \n",
       "9878                                                종이 개   \n",
       "10257                                                개 매   \n",
       "10589         리필 일반 무미 플라스틱 무 개 일반 개 일반 개 무 파라 개 개 개 개 품   \n",
       "10590      리필 일반 무미 플라스틱 무 파라 무 파라 개 일반 개 개 일반 개 개 개 개 품   \n",
       "10629                  리필 개 일반 무미 플라스틱 무 파라 무 파라 개 개 개 개   \n",
       "10643                                           품 꽃향 개 매   \n",
       "10670          피부 용 과일 향 개 피부 용 피부 용 피부 용 품 캡 항균 리필 펌프 품   \n",
       "10676  페이스 용 피부 용 튜브 개 향 로션 개 종 세트 기획 세트 매 무 알코올 팩 품 ...   \n",
       "10678                                            석고 체형 개   \n",
       "10775                                           봉지 재사용 개   \n",
       "10789                                              실내 램프   \n",
       "10982                                               체형 개   \n",
       "11096                                                 봉지   \n",
       "11345                                                중 매   \n",
       "11346                                                개 매   \n",
       "11347                                                개 매   \n",
       "11348                                                개 매   \n",
       "11569                                                개 매   \n",
       "12037                                                  개   \n",
       "12154                                            휴대 용 램프   \n",
       "12169                                         걸이 개 개 일회용   \n",
       "12769                                           용기 재사용 개   \n",
       "12774                                       용기 재사용 개 개 개   \n",
       "13336                                            체형 개 비치   \n",
       "13337                                            체형 개 비치   \n",
       "13448                                               용기 개   \n",
       "13449                                      봉지 재사용 개 실리카겔   \n",
       "13497                           회용 종 품 기타 회용 일회용 삼베 개입 팩   \n",
       "14035                                           용기 일회용 개   \n",
       "14036                                      용기 일회용 개 염화칼슘   \n",
       "14149                                      회용 개 개입 셀룰로오스   \n",
       "14150                                           회용 셀룰로오스   \n",
       "14155                    회용 개 친환경 거품 코코넛 껍질 양면 스펀지 셀룰로오스   \n",
       "14747                          피부 용 개 개 흡수 오 로럴 성용 우디 펌프   \n",
       "15154                                               액체 개   \n",
       "15542                                      회용 개 스테인리스 스틸   \n",
       "15608                        일회용 매 개월 패키지 일회용 폴리프로필렌 일회용   \n",
       "15696                          페이스 용 피부 용 커버 자외선 차단 품 리필   \n",
       "\n",
       "                                  tokenized_제품특성_cleaned  대분류:건강식품  \\\n",
       "8638                                           [가루, 구연산]         0   \n",
       "9076   [피부, 우디, 튜브, 에이프릴, 코튼, 영양, 공급, 흡수, 튜브, 흡수, 영양,...         0   \n",
       "9078   [피부, 기타, 튜브, 발림, 발림, 뚜껑, 에이프릴, 코튼, 핸드, 크림, 크림,...         0   \n",
       "9131                                           [좀벌레, 퇴치]         0   \n",
       "9140                                           [좀벌레, 퇴치]         0   \n",
       "9189                                                  []         0   \n",
       "9218                           [단백질, 캅셀, 캡슐, 가공, 소금, 면역]         0   \n",
       "9283                                           [용기, 일회용]         0   \n",
       "9293                                           [용기, 일회용]         0   \n",
       "9372                                        [회용, 회용, 회용]         0   \n",
       "9660                                           [용기, 일회용]         0   \n",
       "9662                                           [용기, 일회용]         0   \n",
       "9878                                                [종이]         0   \n",
       "10257                                                 []         0   \n",
       "10589                     [리필, 일반, 무미, 플라스틱, 일반, 일반, 파라]         0   \n",
       "10590                 [리필, 일반, 무미, 플라스틱, 파라, 파라, 일반, 일반]         0   \n",
       "10629                         [리필, 일반, 무미, 플라스틱, 파라, 파라]         0   \n",
       "10643                                               [꽃향]         0   \n",
       "10670                   [피부, 과일, 피부, 피부, 피부, 항균, 리필, 펌프]         0   \n",
       "10676  [페이스, 피부, 튜브, 로션, 세트, 기획, 세트, 알코올, 세트, 트러스, 펌프...         0   \n",
       "10678                                           [석고, 체형]         0   \n",
       "10775                                          [봉지, 재사용]         0   \n",
       "10789                                           [실내, 램프]         0   \n",
       "10982                                               [체형]         0   \n",
       "11096                                               [봉지]         0   \n",
       "11345                                                 []         0   \n",
       "11346                                                 []         0   \n",
       "11347                                                 []         0   \n",
       "11348                                                 []         0   \n",
       "11569                                                 []         0   \n",
       "12037                                                 []         0   \n",
       "12154                                           [휴대, 램프]         0   \n",
       "12169                                          [걸이, 일회용]         0   \n",
       "12769                                          [용기, 재사용]         0   \n",
       "12774                                          [용기, 재사용]         0   \n",
       "13336                                           [체형, 비치]         0   \n",
       "13337                                           [체형, 비치]         0   \n",
       "13448                                               [용기]         0   \n",
       "13449                                    [봉지, 재사용, 실리카겔]         0   \n",
       "13497                          [회용, 기타, 회용, 일회용, 삼베, 개입]         0   \n",
       "14035                                          [용기, 일회용]         0   \n",
       "14036                                    [용기, 일회용, 염화칼슘]         0   \n",
       "14149                                    [회용, 개입, 셀룰로오스]         0   \n",
       "14150                                        [회용, 셀룰로오스]         0   \n",
       "14155             [회용, 친환경, 거품, 코코넛, 껍질, 양면, 스펀지, 셀룰로오스]         0   \n",
       "14747                           [피부, 흡수, 로럴, 성용, 우디, 펌프]         0   \n",
       "15154                                               [액체]         0   \n",
       "15542                                    [회용, 스테인리스, 스틸]         0   \n",
       "15608                   [일회용, 개월, 패키지, 일회용, 폴리프로필렌, 일회용]         0   \n",
       "15696                         [페이스, 피부, 커버, 자외선, 차단, 리필]         0   \n",
       "\n",
       "       대분류:출산/유아동  대분류:유아 선크림  대분류:생활용품/뷰티  대분류:식품  중분류:성인  중분류:영유아  \n",
       "8638            0           0            1       0       0        0  \n",
       "9076            0           0            1       0       0        0  \n",
       "9078            0           0            1       0       0        0  \n",
       "9131            0           0            1       0       0        0  \n",
       "9140            0           0            1       0       0        0  \n",
       "9189            0           0            1       0       0        0  \n",
       "9218            0           0            1       0       0        0  \n",
       "9283            0           0            1       0       0        0  \n",
       "9293            0           0            1       0       0        0  \n",
       "9372            0           0            1       0       0        0  \n",
       "9660            0           0            1       0       0        0  \n",
       "9662            0           0            1       0       0        0  \n",
       "9878            0           0            1       0       0        0  \n",
       "10257           0           0            1       0       0        0  \n",
       "10589           0           0            1       0       0        0  \n",
       "10590           0           0            1       0       0        0  \n",
       "10629           0           0            1       0       0        0  \n",
       "10643           0           0            1       0       0        0  \n",
       "10670           0           0            1       0       0        0  \n",
       "10676           0           0            1       0       0        0  \n",
       "10678           0           0            1       0       0        0  \n",
       "10775           0           0            1       0       0        0  \n",
       "10789           0           0            1       0       0        0  \n",
       "10982           0           0            1       0       0        0  \n",
       "11096           0           0            1       0       0        0  \n",
       "11345           0           0            1       0       0        0  \n",
       "11346           0           0            1       0       0        0  \n",
       "11347           0           0            1       0       0        0  \n",
       "11348           0           0            1       0       0        0  \n",
       "11569           0           0            1       0       0        0  \n",
       "12037           0           0            1       0       0        0  \n",
       "12154           0           0            1       0       0        0  \n",
       "12169           0           0            1       0       0        0  \n",
       "12769           0           0            1       0       0        0  \n",
       "12774           0           0            1       0       0        0  \n",
       "13336           0           0            1       0       0        0  \n",
       "13337           0           0            1       0       0        0  \n",
       "13448           0           0            1       0       0        0  \n",
       "13449           0           0            1       0       0        0  \n",
       "13497           0           0            1       0       0        0  \n",
       "14035           0           0            1       0       0        0  \n",
       "14036           0           0            1       0       0        0  \n",
       "14149           0           0            1       0       0        0  \n",
       "14150           0           0            1       0       0        0  \n",
       "14155           0           0            1       0       0        0  \n",
       "14747           0           0            1       0       0        0  \n",
       "15154           0           0            1       0       0        0  \n",
       "15542           0           0            1       0       0        0  \n",
       "15608           0           0            1       0       0        0  \n",
       "15696           0           0            1       0       0        0  \n",
       "\n",
       "[50 rows x 480 columns]"
      ]
     },
     "execution_count": 150,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "filtered_data.tail(50)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 151,
   "id": "95b8f17e",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Karl\\AppData\\Local\\Temp\\ipykernel_29388\\4117483951.py:1: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  merged['중분류:용기/봉지'] = merged['중분류'].apply(lambda x: 1 if x == 'B002-C002-0002' else 0)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>제품</th>\n",
       "      <th>대분류</th>\n",
       "      <th>중분류</th>\n",
       "      <th>소분류</th>\n",
       "      <th>브랜드</th>\n",
       "      <th>2022-01-01</th>\n",
       "      <th>2022-01-02</th>\n",
       "      <th>2022-01-03</th>\n",
       "      <th>2022-01-04</th>\n",
       "      <th>...</th>\n",
       "      <th>tokenized_제품특성</th>\n",
       "      <th>tokenized_제품특성_cleaned</th>\n",
       "      <th>대분류:건강식품</th>\n",
       "      <th>대분류:출산/유아동</th>\n",
       "      <th>대분류:유아 선크림</th>\n",
       "      <th>대분류:생활용품/뷰티</th>\n",
       "      <th>대분류:식품</th>\n",
       "      <th>중분류:성인</th>\n",
       "      <th>중분류:영유아</th>\n",
       "      <th>중분류:용기/봉지</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>B002-00001-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0007</td>\n",
       "      <td>B002-C003-0038</td>\n",
       "      <td>B002-00001</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>모든 스프레이 흡수 윤기 부여 영양 공급 개</td>\n",
       "      <td>모든 스프레이 흡수 윤기 부여 영양 공급</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>12</td>\n",
       "      <td>B002-00003-00009</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-00003</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>캡슐 개월 캡슐 하루 물 성인 남녀 체지방 감소 캡슐</td>\n",
       "      <td>캡슐 개월 캡슐 하루 성인 남녀 체지방 감소 캡슐</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>16</td>\n",
       "      <td>B002-00005-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>피부 용 과일 향 펌프 개</td>\n",
       "      <td>피부 과일 펌프</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>17</td>\n",
       "      <td>B002-00005-00002</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>과일 향 향 개</td>\n",
       "      <td>과일</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>19</td>\n",
       "      <td>B002-00005-00004</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>튜브 개 개 개</td>\n",
       "      <td>튜브</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15877</th>\n",
       "      <td>15877</td>\n",
       "      <td>B002-03798-00049</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>기타</td>\n",
       "      <td>기타</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15882</th>\n",
       "      <td>15882</td>\n",
       "      <td>B002-03798-00054</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>빨대 양손잡이 스테인리스 스틸</td>\n",
       "      <td>빨대 양손잡이 스테인리스 스틸</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15883</th>\n",
       "      <td>15883</td>\n",
       "      <td>B002-03798-00055</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>머그 미끄럼 방지 스테인리스 스틸</td>\n",
       "      <td>머그 미끄럼 방지 스테인리스 스틸</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15887</th>\n",
       "      <td>15887</td>\n",
       "      <td>B002-03799-00004</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 개 세트</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 세트</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15888</th>\n",
       "      <td>15888</td>\n",
       "      <td>B002-03799-00005</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 개 세트</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 세트</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10481 rows × 481 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          ID                제품             대분류             중분류  \\\n",
       "0          0  B002-00001-00001  B002-C001-0002  B002-C002-0007   \n",
       "12        12  B002-00003-00009  B002-C001-0001  B002-C002-0001   \n",
       "16        16  B002-00005-00001  B002-C001-0002  B002-C002-0006   \n",
       "17        17  B002-00005-00002  B002-C001-0002  B002-C002-0006   \n",
       "19        19  B002-00005-00004  B002-C001-0002  B002-C002-0006   \n",
       "...      ...               ...             ...             ...   \n",
       "15877  15877  B002-03798-00049  B002-C001-0003  B002-C002-0008   \n",
       "15882  15882  B002-03798-00054  B002-C001-0003  B002-C002-0008   \n",
       "15883  15883  B002-03798-00055  B002-C001-0003  B002-C002-0008   \n",
       "15887  15887  B002-03799-00004  B002-C001-0003  B002-C002-0008   \n",
       "15888  15888  B002-03799-00005  B002-C001-0003  B002-C002-0008   \n",
       "\n",
       "                  소분류         브랜드  2022-01-01  2022-01-02  2022-01-03  \\\n",
       "0      B002-C003-0038  B002-00001           0           0           0   \n",
       "12     B002-C003-0003  B002-00003           0           0           0   \n",
       "16     B002-C003-0032  B002-00005           0           0           0   \n",
       "17     B002-C003-0032  B002-00005           0           0           0   \n",
       "19     B002-C003-0032  B002-00005           0           0           0   \n",
       "...               ...         ...         ...         ...         ...   \n",
       "15877  B002-C003-0044  B002-03798           0           0           0   \n",
       "15882  B002-C003-0044  B002-03798           0           0           0   \n",
       "15883  B002-C003-0044  B002-03798           0           0           0   \n",
       "15887  B002-C003-0044  B002-03799           0           0           0   \n",
       "15888  B002-C003-0044  B002-03799           0           0           0   \n",
       "\n",
       "       2022-01-04  ...                 tokenized_제품특성  \\\n",
       "0               0  ...       모든 스프레이 흡수 윤기 부여 영양 공급 개   \n",
       "12              0  ...  캡슐 개월 캡슐 하루 물 성인 남녀 체지방 감소 캡슐   \n",
       "16              0  ...                 피부 용 과일 향 펌프 개   \n",
       "17              0  ...                       과일 향 향 개   \n",
       "19              0  ...                       튜브 개 개 개   \n",
       "...           ...  ...                            ...   \n",
       "15877           0  ...                             기타   \n",
       "15882           0  ...               빨대 양손잡이 스테인리스 스틸   \n",
       "15883           0  ...             머그 미끄럼 방지 스테인리스 스틸   \n",
       "15887           0  ...    이유식 보관 용기 전자레인지 사용 실리콘 개 세트   \n",
       "15888           0  ...    이유식 보관 용기 전자레인지 사용 실리콘 개 세트   \n",
       "\n",
       "            tokenized_제품특성_cleaned  대분류:건강식품  대분류:출산/유아동  대분류:유아 선크림  \\\n",
       "0           모든 스프레이 흡수 윤기 부여 영양 공급         0           0           0   \n",
       "12     캡슐 개월 캡슐 하루 성인 남녀 체지방 감소 캡슐         1           0           0   \n",
       "16                        피부 과일 펌프         0           0           0   \n",
       "17                              과일         0           0           0   \n",
       "19                              튜브         0           0           0   \n",
       "...                            ...       ...         ...         ...   \n",
       "15877                           기타         0           1           0   \n",
       "15882             빨대 양손잡이 스테인리스 스틸         0           1           0   \n",
       "15883           머그 미끄럼 방지 스테인리스 스틸         0           1           0   \n",
       "15887    이유식 보관 용기 전자레인지 사용 실리콘 세트         0           1           0   \n",
       "15888    이유식 보관 용기 전자레인지 사용 실리콘 세트         0           1           0   \n",
       "\n",
       "       대분류:생활용품/뷰티  대분류:식품  중분류:성인  중분류:영유아  중분류:용기/봉지  \n",
       "0                1       0       0        0          0  \n",
       "12               0       0       1        0          0  \n",
       "16               1       0       0        0          0  \n",
       "17               1       0       0        0          0  \n",
       "19               1       0       0        0          0  \n",
       "...            ...     ...     ...      ...        ...  \n",
       "15877            0       0       0        0          0  \n",
       "15882            0       0       0        0          0  \n",
       "15883            0       0       0        0          0  \n",
       "15887            0       0       0        0          0  \n",
       "15888            0       0       0        0          0  \n",
       "\n",
       "[10481 rows x 481 columns]"
      ]
     },
     "execution_count": 151,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merged['중분류:용기/봉지'] = merged['중분류'].apply(lambda x: 1 if x == 'B002-C002-0002' else 0)\n",
    "merged"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 152,
   "id": "0289349a",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[('상형', 595), ('일반', 341), ('리필', 247), ('조리기구', 121), ('가루', 102), ('탁용', 74), ('개입', 71), ('파라', 70), ('캡슐', 66), ('야채', 58), ('무미', 57), ('플라스틱', 57), ('백제', 55), ('농축', 54), ('효과', 52), ('드럼', 52), ('향균', 51), ('스프레이', 48), ('정제', 47), ('무형', 46), ('광증', 46), ('무방', 34), ('부제', 34), ('시트', 31), ('일반세', 31), ('용량', 29), ('레몬', 27), ('인산염', 23), ('자몽', 22), ('중성세제', 21)]\n"
     ]
    }
   ],
   "source": [
    "filtered_data = merged[merged['중분류'] =='B002-C002-0003'].copy()\n",
    "filtered_data['tokenized_제품특성_cleaned'] = filtered_data['tokenized_제품특성_cleaned'].apply(lambda x: x.split() if isinstance(x, str) else [])\n",
    "# Now sum up all the token lists into a single list\n",
    "all_tokens = sum(filtered_data['tokenized_제품특성_cleaned'], [])\n",
    "\n",
    "# Proceed with counting the tokens\n",
    "from collections import Counter\n",
    "token_counts = Counter(all_tokens)\n",
    "\n",
    "# Identify the most common tokens\n",
    "most_common_tokens = token_counts.most_common(30)  # adjust the number as needed\n",
    "\n",
    "print(most_common_tokens)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 157,
   "id": "f32c5f78",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Karl\\AppData\\Local\\Temp\\ipykernel_29388\\627535329.py:1: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  merged['중분류:주방/세탁용품'] = merged['중분류'].apply(lambda x: 1 if x == 'B002-C002-0003' else 0)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>제품</th>\n",
       "      <th>대분류</th>\n",
       "      <th>중분류</th>\n",
       "      <th>소분류</th>\n",
       "      <th>브랜드</th>\n",
       "      <th>2022-01-01</th>\n",
       "      <th>2022-01-02</th>\n",
       "      <th>2022-01-03</th>\n",
       "      <th>2022-01-04</th>\n",
       "      <th>...</th>\n",
       "      <th>tokenized_제품특성_cleaned</th>\n",
       "      <th>대분류:건강식품</th>\n",
       "      <th>대분류:출산/유아동</th>\n",
       "      <th>대분류:유아 선크림</th>\n",
       "      <th>대분류:생활용품/뷰티</th>\n",
       "      <th>대분류:식품</th>\n",
       "      <th>중분류:성인</th>\n",
       "      <th>중분류:영유아</th>\n",
       "      <th>중분류:용기/봉지</th>\n",
       "      <th>중분류:주방/세탁용품</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>B002-00001-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0007</td>\n",
       "      <td>B002-C003-0038</td>\n",
       "      <td>B002-00001</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>모든 스프레이 흡수 윤기 부여 영양 공급</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>12</td>\n",
       "      <td>B002-00003-00009</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-00003</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>캡슐 개월 캡슐 하루 성인 남녀 체지방 감소 캡슐</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>16</td>\n",
       "      <td>B002-00005-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>피부 과일 펌프</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>17</td>\n",
       "      <td>B002-00005-00002</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>과일</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>19</td>\n",
       "      <td>B002-00005-00004</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>튜브</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15877</th>\n",
       "      <td>15877</td>\n",
       "      <td>B002-03798-00049</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>기타</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15882</th>\n",
       "      <td>15882</td>\n",
       "      <td>B002-03798-00054</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>빨대 양손잡이 스테인리스 스틸</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15883</th>\n",
       "      <td>15883</td>\n",
       "      <td>B002-03798-00055</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>머그 미끄럼 방지 스테인리스 스틸</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15887</th>\n",
       "      <td>15887</td>\n",
       "      <td>B002-03799-00004</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 세트</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15888</th>\n",
       "      <td>15888</td>\n",
       "      <td>B002-03799-00005</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>이유식 보관 용기 전자레인지 사용 실리콘 세트</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10481 rows × 482 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          ID                제품             대분류             중분류  \\\n",
       "0          0  B002-00001-00001  B002-C001-0002  B002-C002-0007   \n",
       "12        12  B002-00003-00009  B002-C001-0001  B002-C002-0001   \n",
       "16        16  B002-00005-00001  B002-C001-0002  B002-C002-0006   \n",
       "17        17  B002-00005-00002  B002-C001-0002  B002-C002-0006   \n",
       "19        19  B002-00005-00004  B002-C001-0002  B002-C002-0006   \n",
       "...      ...               ...             ...             ...   \n",
       "15877  15877  B002-03798-00049  B002-C001-0003  B002-C002-0008   \n",
       "15882  15882  B002-03798-00054  B002-C001-0003  B002-C002-0008   \n",
       "15883  15883  B002-03798-00055  B002-C001-0003  B002-C002-0008   \n",
       "15887  15887  B002-03799-00004  B002-C001-0003  B002-C002-0008   \n",
       "15888  15888  B002-03799-00005  B002-C001-0003  B002-C002-0008   \n",
       "\n",
       "                  소분류         브랜드  2022-01-01  2022-01-02  2022-01-03  \\\n",
       "0      B002-C003-0038  B002-00001           0           0           0   \n",
       "12     B002-C003-0003  B002-00003           0           0           0   \n",
       "16     B002-C003-0032  B002-00005           0           0           0   \n",
       "17     B002-C003-0032  B002-00005           0           0           0   \n",
       "19     B002-C003-0032  B002-00005           0           0           0   \n",
       "...               ...         ...         ...         ...         ...   \n",
       "15877  B002-C003-0044  B002-03798           0           0           0   \n",
       "15882  B002-C003-0044  B002-03798           0           0           0   \n",
       "15883  B002-C003-0044  B002-03798           0           0           0   \n",
       "15887  B002-C003-0044  B002-03799           0           0           0   \n",
       "15888  B002-C003-0044  B002-03799           0           0           0   \n",
       "\n",
       "       2022-01-04  ...       tokenized_제품특성_cleaned  대분류:건강식품  대분류:출산/유아동  \\\n",
       "0               0  ...       모든 스프레이 흡수 윤기 부여 영양 공급         0           0   \n",
       "12              0  ...  캡슐 개월 캡슐 하루 성인 남녀 체지방 감소 캡슐         1           0   \n",
       "16              0  ...                     피부 과일 펌프         0           0   \n",
       "17              0  ...                           과일         0           0   \n",
       "19              0  ...                           튜브         0           0   \n",
       "...           ...  ...                          ...       ...         ...   \n",
       "15877           0  ...                           기타         0           1   \n",
       "15882           0  ...             빨대 양손잡이 스테인리스 스틸         0           1   \n",
       "15883           0  ...           머그 미끄럼 방지 스테인리스 스틸         0           1   \n",
       "15887           0  ...    이유식 보관 용기 전자레인지 사용 실리콘 세트         0           1   \n",
       "15888           0  ...    이유식 보관 용기 전자레인지 사용 실리콘 세트         0           1   \n",
       "\n",
       "       대분류:유아 선크림  대분류:생활용품/뷰티  대분류:식품  중분류:성인  중분류:영유아  중분류:용기/봉지  \\\n",
       "0               0            1       0       0        0          0   \n",
       "12              0            0       0       1        0          0   \n",
       "16              0            1       0       0        0          0   \n",
       "17              0            1       0       0        0          0   \n",
       "19              0            1       0       0        0          0   \n",
       "...           ...          ...     ...     ...      ...        ...   \n",
       "15877           0            0       0       0        0          0   \n",
       "15882           0            0       0       0        0          0   \n",
       "15883           0            0       0       0        0          0   \n",
       "15887           0            0       0       0        0          0   \n",
       "15888           0            0       0       0        0          0   \n",
       "\n",
       "       중분류:주방/세탁용품  \n",
       "0                0  \n",
       "12               0  \n",
       "16               0  \n",
       "17               0  \n",
       "19               0  \n",
       "...            ...  \n",
       "15877            0  \n",
       "15882            0  \n",
       "15883            0  \n",
       "15887            0  \n",
       "15888            0  \n",
       "\n",
       "[10481 rows x 482 columns]"
      ]
     },
     "execution_count": 157,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merged['중분류:주방/세탁용품'] = merged['중분류'].apply(lambda x: 1 if x == 'B002-C002-0003' else 0)\n",
    "merged"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 136,
   "id": "8eb34117",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[('일반', 640), ('칫솔', 202), ('플라스틱', 195), ('예방', 180), ('미세', 180), ('제거', 144), ('기타', 140), ('음파', 103), ('충전', 87), ('화이트', 87), ('질환', 86), ('단계', 86), ('방수', 82), ('치실', 76), ('프라그', 72), ('인용', 71), ('용기', 69), ('일반세', 65), ('생활', 61), ('무향', 57), ('구강', 54), ('청결', 53), ('잇몸', 52), ('블루투스', 52), ('치주염', 47), ('센서', 47), ('미백', 44), ('세균', 40), ('충치', 38), ('사용', 38)]\n"
     ]
    }
   ],
   "source": [
    "filtered_data = merged[merged['중분류'] =='B002-C002-0004'].copy()\n",
    "filtered_data['tokenized_제품특성_cleaned'] = filtered_data['tokenized_제품특성_cleaned'].apply(lambda x: x.split() if isinstance(x, str) else [])\n",
    "# Now sum up all the token lists into a single list\n",
    "all_tokens = sum(filtered_data['tokenized_제품특성_cleaned'], [])\n",
    "\n",
    "# Proceed with counting the tokens\n",
    "from collections import Counter\n",
    "token_counts = Counter(all_tokens)\n",
    "\n",
    "# Identify the most common tokens\n",
    "most_common_tokens = token_counts.most_common(30)  # adjust the number as needed\n",
    "\n",
    "print(most_common_tokens)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 158,
   "id": "5c39a6e3",
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Karl\\AppData\\Local\\Temp\\ipykernel_29388\\1176701208.py:1: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  merged['중분류:구강용품'] = merged['중분류'].apply(lambda x: 1 if x == 'B002-C002-0004' else 0)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>제품</th>\n",
       "      <th>대분류</th>\n",
       "      <th>중분류</th>\n",
       "      <th>소분류</th>\n",
       "      <th>브랜드</th>\n",
       "      <th>2022-01-01</th>\n",
       "      <th>2022-01-02</th>\n",
       "      <th>2022-01-03</th>\n",
       "      <th>2022-01-04</th>\n",
       "      <th>...</th>\n",
       "      <th>대분류:건강식품</th>\n",
       "      <th>대분류:출산/유아동</th>\n",
       "      <th>대분류:유아 선크림</th>\n",
       "      <th>대분류:생활용품/뷰티</th>\n",
       "      <th>대분류:식품</th>\n",
       "      <th>중분류:성인</th>\n",
       "      <th>중분류:영유아</th>\n",
       "      <th>중분류:용기/봉지</th>\n",
       "      <th>중분류:주방/세탁용품</th>\n",
       "      <th>중분류:구강용품</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>B002-00001-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0007</td>\n",
       "      <td>B002-C003-0038</td>\n",
       "      <td>B002-00001</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>12</td>\n",
       "      <td>B002-00003-00009</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-00003</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>16</td>\n",
       "      <td>B002-00005-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>17</td>\n",
       "      <td>B002-00005-00002</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>19</td>\n",
       "      <td>B002-00005-00004</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15877</th>\n",
       "      <td>15877</td>\n",
       "      <td>B002-03798-00049</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15882</th>\n",
       "      <td>15882</td>\n",
       "      <td>B002-03798-00054</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15883</th>\n",
       "      <td>15883</td>\n",
       "      <td>B002-03798-00055</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15887</th>\n",
       "      <td>15887</td>\n",
       "      <td>B002-03799-00004</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15888</th>\n",
       "      <td>15888</td>\n",
       "      <td>B002-03799-00005</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10481 rows × 483 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          ID                제품             대분류             중분류  \\\n",
       "0          0  B002-00001-00001  B002-C001-0002  B002-C002-0007   \n",
       "12        12  B002-00003-00009  B002-C001-0001  B002-C002-0001   \n",
       "16        16  B002-00005-00001  B002-C001-0002  B002-C002-0006   \n",
       "17        17  B002-00005-00002  B002-C001-0002  B002-C002-0006   \n",
       "19        19  B002-00005-00004  B002-C001-0002  B002-C002-0006   \n",
       "...      ...               ...             ...             ...   \n",
       "15877  15877  B002-03798-00049  B002-C001-0003  B002-C002-0008   \n",
       "15882  15882  B002-03798-00054  B002-C001-0003  B002-C002-0008   \n",
       "15883  15883  B002-03798-00055  B002-C001-0003  B002-C002-0008   \n",
       "15887  15887  B002-03799-00004  B002-C001-0003  B002-C002-0008   \n",
       "15888  15888  B002-03799-00005  B002-C001-0003  B002-C002-0008   \n",
       "\n",
       "                  소분류         브랜드  2022-01-01  2022-01-02  2022-01-03  \\\n",
       "0      B002-C003-0038  B002-00001           0           0           0   \n",
       "12     B002-C003-0003  B002-00003           0           0           0   \n",
       "16     B002-C003-0032  B002-00005           0           0           0   \n",
       "17     B002-C003-0032  B002-00005           0           0           0   \n",
       "19     B002-C003-0032  B002-00005           0           0           0   \n",
       "...               ...         ...         ...         ...         ...   \n",
       "15877  B002-C003-0044  B002-03798           0           0           0   \n",
       "15882  B002-C003-0044  B002-03798           0           0           0   \n",
       "15883  B002-C003-0044  B002-03798           0           0           0   \n",
       "15887  B002-C003-0044  B002-03799           0           0           0   \n",
       "15888  B002-C003-0044  B002-03799           0           0           0   \n",
       "\n",
       "       2022-01-04  ...  대분류:건강식품  대분류:출산/유아동  대분류:유아 선크림  대분류:생활용품/뷰티  대분류:식품  \\\n",
       "0               0  ...         0           0           0            1       0   \n",
       "12              0  ...         1           0           0            0       0   \n",
       "16              0  ...         0           0           0            1       0   \n",
       "17              0  ...         0           0           0            1       0   \n",
       "19              0  ...         0           0           0            1       0   \n",
       "...           ...  ...       ...         ...         ...          ...     ...   \n",
       "15877           0  ...         0           1           0            0       0   \n",
       "15882           0  ...         0           1           0            0       0   \n",
       "15883           0  ...         0           1           0            0       0   \n",
       "15887           0  ...         0           1           0            0       0   \n",
       "15888           0  ...         0           1           0            0       0   \n",
       "\n",
       "       중분류:성인  중분류:영유아  중분류:용기/봉지  중분류:주방/세탁용품  중분류:구강용품  \n",
       "0           0        0          0            0         0  \n",
       "12          1        0          0            0         0  \n",
       "16          0        0          0            0         0  \n",
       "17          0        0          0            0         0  \n",
       "19          0        0          0            0         0  \n",
       "...       ...      ...        ...          ...       ...  \n",
       "15877       0        0          0            0         0  \n",
       "15882       0        0          0            0         0  \n",
       "15883       0        0          0            0         0  \n",
       "15887       0        0          0            0         0  \n",
       "15888       0        0          0            0         0  \n",
       "\n",
       "[10481 rows x 483 columns]"
      ]
     },
     "execution_count": 158,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merged['중분류:구강용품'] = merged['중분류'].apply(lambda x: 1 if x == 'B002-C002-0004' else 0)\n",
    "merged"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 159,
   "id": "9a9c04fb",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[('엠보싱', 484), ('날개', 326), ('계정수', 273), ('보습', 188), ('효과', 188), ('공용', 179), ('남녀', 177), ('자극', 173), ('플레인', 172), ('두루', 166), ('마리', 166), ('인증', 164), ('단계', 153), ('방지', 152), ('팬티', 125), ('타월', 123), ('키친', 122), ('티슈', 105), ('일자', 94), ('무형', 89), ('휴대', 88), ('오줌', 76), ('무향', 72), ('기성', 71), ('밴드', 69), ('데코', 65), ('처리', 63), ('테이프', 63), ('펄프', 58), ('천연', 57)]\n"
     ]
    }
   ],
   "source": [
    "filtered_data = merged[merged['중분류'] =='B002-C002-0005'].copy()\n",
    "filtered_data['tokenized_제품특성_cleaned'] = filtered_data['tokenized_제품특성_cleaned'].apply(lambda x: x.split() if isinstance(x, str) else [])\n",
    "# Now sum up all the token lists into a single list\n",
    "all_tokens = sum(filtered_data['tokenized_제품특성_cleaned'], [])\n",
    "\n",
    "# Proceed with counting the tokens\n",
    "from collections import Counter\n",
    "token_counts = Counter(all_tokens)\n",
    "\n",
    "# Identify the most common tokens\n",
    "most_common_tokens = token_counts.most_common(30)  # adjust the number as needed\n",
    "\n",
    "print(most_common_tokens)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 164,
   "id": "3dba3dd7",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Karl\\AppData\\Local\\Temp\\ipykernel_29388\\3737559097.py:1: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  merged['중분류:휴지/티슈/생리대'] = merged['중분류'].apply(lambda x: 1 if x == 'B002-C002-0005' else 0)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>제품</th>\n",
       "      <th>대분류</th>\n",
       "      <th>중분류</th>\n",
       "      <th>소분류</th>\n",
       "      <th>브랜드</th>\n",
       "      <th>2022-01-01</th>\n",
       "      <th>2022-01-02</th>\n",
       "      <th>2022-01-03</th>\n",
       "      <th>2022-01-04</th>\n",
       "      <th>...</th>\n",
       "      <th>대분류:출산/유아동</th>\n",
       "      <th>대분류:유아 선크림</th>\n",
       "      <th>대분류:생활용품/뷰티</th>\n",
       "      <th>대분류:식품</th>\n",
       "      <th>중분류:성인</th>\n",
       "      <th>중분류:영유아</th>\n",
       "      <th>중분류:용기/봉지</th>\n",
       "      <th>중분류:주방/세탁용품</th>\n",
       "      <th>중분류:구강용품</th>\n",
       "      <th>중분류:휴지/티슈/생리대</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>B002-00001-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0007</td>\n",
       "      <td>B002-C003-0038</td>\n",
       "      <td>B002-00001</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>12</td>\n",
       "      <td>B002-00003-00009</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-00003</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>16</td>\n",
       "      <td>B002-00005-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>17</td>\n",
       "      <td>B002-00005-00002</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>19</td>\n",
       "      <td>B002-00005-00004</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15877</th>\n",
       "      <td>15877</td>\n",
       "      <td>B002-03798-00049</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15882</th>\n",
       "      <td>15882</td>\n",
       "      <td>B002-03798-00054</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15883</th>\n",
       "      <td>15883</td>\n",
       "      <td>B002-03798-00055</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15887</th>\n",
       "      <td>15887</td>\n",
       "      <td>B002-03799-00004</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15888</th>\n",
       "      <td>15888</td>\n",
       "      <td>B002-03799-00005</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10481 rows × 484 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          ID                제품             대분류             중분류  \\\n",
       "0          0  B002-00001-00001  B002-C001-0002  B002-C002-0007   \n",
       "12        12  B002-00003-00009  B002-C001-0001  B002-C002-0001   \n",
       "16        16  B002-00005-00001  B002-C001-0002  B002-C002-0006   \n",
       "17        17  B002-00005-00002  B002-C001-0002  B002-C002-0006   \n",
       "19        19  B002-00005-00004  B002-C001-0002  B002-C002-0006   \n",
       "...      ...               ...             ...             ...   \n",
       "15877  15877  B002-03798-00049  B002-C001-0003  B002-C002-0008   \n",
       "15882  15882  B002-03798-00054  B002-C001-0003  B002-C002-0008   \n",
       "15883  15883  B002-03798-00055  B002-C001-0003  B002-C002-0008   \n",
       "15887  15887  B002-03799-00004  B002-C001-0003  B002-C002-0008   \n",
       "15888  15888  B002-03799-00005  B002-C001-0003  B002-C002-0008   \n",
       "\n",
       "                  소분류         브랜드  2022-01-01  2022-01-02  2022-01-03  \\\n",
       "0      B002-C003-0038  B002-00001           0           0           0   \n",
       "12     B002-C003-0003  B002-00003           0           0           0   \n",
       "16     B002-C003-0032  B002-00005           0           0           0   \n",
       "17     B002-C003-0032  B002-00005           0           0           0   \n",
       "19     B002-C003-0032  B002-00005           0           0           0   \n",
       "...               ...         ...         ...         ...         ...   \n",
       "15877  B002-C003-0044  B002-03798           0           0           0   \n",
       "15882  B002-C003-0044  B002-03798           0           0           0   \n",
       "15883  B002-C003-0044  B002-03798           0           0           0   \n",
       "15887  B002-C003-0044  B002-03799           0           0           0   \n",
       "15888  B002-C003-0044  B002-03799           0           0           0   \n",
       "\n",
       "       2022-01-04  ...  대분류:출산/유아동  대분류:유아 선크림  대분류:생활용품/뷰티  대분류:식품  중분류:성인  \\\n",
       "0               0  ...           0           0            1       0       0   \n",
       "12              0  ...           0           0            0       0       1   \n",
       "16              0  ...           0           0            1       0       0   \n",
       "17              0  ...           0           0            1       0       0   \n",
       "19              0  ...           0           0            1       0       0   \n",
       "...           ...  ...         ...         ...          ...     ...     ...   \n",
       "15877           0  ...           1           0            0       0       0   \n",
       "15882           0  ...           1           0            0       0       0   \n",
       "15883           0  ...           1           0            0       0       0   \n",
       "15887           0  ...           1           0            0       0       0   \n",
       "15888           0  ...           1           0            0       0       0   \n",
       "\n",
       "       중분류:영유아  중분류:용기/봉지  중분류:주방/세탁용품  중분류:구강용품  중분류:휴지/티슈/생리대  \n",
       "0            0          0            0         0              0  \n",
       "12           0          0            0         0              0  \n",
       "16           0          0            0         0              0  \n",
       "17           0          0            0         0              0  \n",
       "19           0          0            0         0              0  \n",
       "...        ...        ...          ...       ...            ...  \n",
       "15877        0          0            0         0              0  \n",
       "15882        0          0            0         0              0  \n",
       "15883        0          0            0         0              0  \n",
       "15887        0          0            0         0              0  \n",
       "15888        0          0            0         0              0  \n",
       "\n",
       "[10481 rows x 484 columns]"
      ]
     },
     "execution_count": 164,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merged['중분류:휴지/티슈/생리대'] = merged['중분류'].apply(lambda x: 1 if x == 'B002-C002-0005' else 0)\n",
    "merged"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 165,
   "id": "8193fa1d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[('피부', 1054), ('펌프', 491), ('튜브', 405), ('흡수', 364), ('헤드', 306), ('공급', 299), ('기타', 294), ('영양', 289), ('기본', 264), ('구성', 264), ('자극', 206), ('뚜껑', 150), ('바디', 148), ('중날', 148), ('케어', 140), ('교체', 133), ('트리', 129), ('가능', 108), ('각질', 96), ('충전', 96), ('발림', 93), ('무향', 92), ('페이스', 89), ('방수', 83), ('면도', 80), ('탄력', 77), ('크림', 76), ('과일', 74), ('겸용', 73), ('정력', 67)]\n"
     ]
    }
   ],
   "source": [
    "filtered_data = merged[merged['중분류'] =='B002-C002-0006'].copy()\n",
    "filtered_data['tokenized_제품특성_cleaned'] = filtered_data['tokenized_제품특성_cleaned'].apply(lambda x: x.split() if isinstance(x, str) else [])\n",
    "# Now sum up all the token lists into a single list\n",
    "all_tokens = sum(filtered_data['tokenized_제품특성_cleaned'], [])\n",
    "\n",
    "# Proceed with counting the tokens\n",
    "from collections import Counter\n",
    "token_counts = Counter(all_tokens)\n",
    "\n",
    "# Identify the most common tokens\n",
    "most_common_tokens = token_counts.most_common(30)  # adjust the number as needed\n",
    "\n",
    "print(most_common_tokens)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 169,
   "id": "5de0f370",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Karl\\AppData\\Local\\Temp\\ipykernel_29388\\1302671805.py:1: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  merged['중분류:스킨케어/헤어케어'] = merged['중분류'].apply(lambda x: 1 if x == 'B002-C002-0006' else 0)\n",
      "C:\\Users\\Karl\\AppData\\Local\\Temp\\ipykernel_29388\\1302671805.py:3: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  merged.rename(columns={'중분류:스킨케어/헤어케어': '중분류:스킨케어'}, inplace=True)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>제품</th>\n",
       "      <th>대분류</th>\n",
       "      <th>중분류</th>\n",
       "      <th>소분류</th>\n",
       "      <th>브랜드</th>\n",
       "      <th>2022-01-01</th>\n",
       "      <th>2022-01-02</th>\n",
       "      <th>2022-01-03</th>\n",
       "      <th>2022-01-04</th>\n",
       "      <th>...</th>\n",
       "      <th>대분류:유아 선크림</th>\n",
       "      <th>대분류:생활용품/뷰티</th>\n",
       "      <th>대분류:식품</th>\n",
       "      <th>중분류:성인</th>\n",
       "      <th>중분류:영유아</th>\n",
       "      <th>중분류:용기/봉지</th>\n",
       "      <th>중분류:주방/세탁용품</th>\n",
       "      <th>중분류:구강용품</th>\n",
       "      <th>중분류:휴지/티슈/생리대</th>\n",
       "      <th>중분류:스킨케어</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>B002-00001-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0007</td>\n",
       "      <td>B002-C003-0038</td>\n",
       "      <td>B002-00001</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>12</td>\n",
       "      <td>B002-00003-00009</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-00003</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>16</td>\n",
       "      <td>B002-00005-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>17</td>\n",
       "      <td>B002-00005-00002</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>19</td>\n",
       "      <td>B002-00005-00004</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15877</th>\n",
       "      <td>15877</td>\n",
       "      <td>B002-03798-00049</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15882</th>\n",
       "      <td>15882</td>\n",
       "      <td>B002-03798-00054</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15883</th>\n",
       "      <td>15883</td>\n",
       "      <td>B002-03798-00055</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15887</th>\n",
       "      <td>15887</td>\n",
       "      <td>B002-03799-00004</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15888</th>\n",
       "      <td>15888</td>\n",
       "      <td>B002-03799-00005</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10481 rows × 485 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          ID                제품             대분류             중분류  \\\n",
       "0          0  B002-00001-00001  B002-C001-0002  B002-C002-0007   \n",
       "12        12  B002-00003-00009  B002-C001-0001  B002-C002-0001   \n",
       "16        16  B002-00005-00001  B002-C001-0002  B002-C002-0006   \n",
       "17        17  B002-00005-00002  B002-C001-0002  B002-C002-0006   \n",
       "19        19  B002-00005-00004  B002-C001-0002  B002-C002-0006   \n",
       "...      ...               ...             ...             ...   \n",
       "15877  15877  B002-03798-00049  B002-C001-0003  B002-C002-0008   \n",
       "15882  15882  B002-03798-00054  B002-C001-0003  B002-C002-0008   \n",
       "15883  15883  B002-03798-00055  B002-C001-0003  B002-C002-0008   \n",
       "15887  15887  B002-03799-00004  B002-C001-0003  B002-C002-0008   \n",
       "15888  15888  B002-03799-00005  B002-C001-0003  B002-C002-0008   \n",
       "\n",
       "                  소분류         브랜드  2022-01-01  2022-01-02  2022-01-03  \\\n",
       "0      B002-C003-0038  B002-00001           0           0           0   \n",
       "12     B002-C003-0003  B002-00003           0           0           0   \n",
       "16     B002-C003-0032  B002-00005           0           0           0   \n",
       "17     B002-C003-0032  B002-00005           0           0           0   \n",
       "19     B002-C003-0032  B002-00005           0           0           0   \n",
       "...               ...         ...         ...         ...         ...   \n",
       "15877  B002-C003-0044  B002-03798           0           0           0   \n",
       "15882  B002-C003-0044  B002-03798           0           0           0   \n",
       "15883  B002-C003-0044  B002-03798           0           0           0   \n",
       "15887  B002-C003-0044  B002-03799           0           0           0   \n",
       "15888  B002-C003-0044  B002-03799           0           0           0   \n",
       "\n",
       "       2022-01-04  ...  대분류:유아 선크림  대분류:생활용품/뷰티  대분류:식품  중분류:성인  중분류:영유아  \\\n",
       "0               0  ...           0            1       0       0        0   \n",
       "12              0  ...           0            0       0       1        0   \n",
       "16              0  ...           0            1       0       0        0   \n",
       "17              0  ...           0            1       0       0        0   \n",
       "19              0  ...           0            1       0       0        0   \n",
       "...           ...  ...         ...          ...     ...     ...      ...   \n",
       "15877           0  ...           0            0       0       0        0   \n",
       "15882           0  ...           0            0       0       0        0   \n",
       "15883           0  ...           0            0       0       0        0   \n",
       "15887           0  ...           0            0       0       0        0   \n",
       "15888           0  ...           0            0       0       0        0   \n",
       "\n",
       "       중분류:용기/봉지  중분류:주방/세탁용품  중분류:구강용품  중분류:휴지/티슈/생리대  중분류:스킨케어  \n",
       "0              0            0         0              0         0  \n",
       "12             0            0         0              0         0  \n",
       "16             0            0         0              0         1  \n",
       "17             0            0         0              0         1  \n",
       "19             0            0         0              0         1  \n",
       "...          ...          ...       ...            ...       ...  \n",
       "15877          0            0         0              0         0  \n",
       "15882          0            0         0              0         0  \n",
       "15883          0            0         0              0         0  \n",
       "15887          0            0         0              0         0  \n",
       "15888          0            0         0              0         0  \n",
       "\n",
       "[10481 rows x 485 columns]"
      ]
     },
     "execution_count": 169,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merged['중분류:스킨케어/헤어케어'] = merged['중분류'].apply(lambda x: 1 if x == 'B002-C002-0006' else 0)\n",
    "merged\n",
    "merged.rename(columns={'중분류:스킨케어/헤어케어': '중분류:스킨케어'}, inplace=True)\n",
    "merged"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 170,
   "id": "7e94a671",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[('모든', 1408), ('샴푸', 924), ('영양', 820), ('펌프', 725), ('윤기', 628), ('부여', 594), ('모발', 508), ('공급', 507), ('일반', 481), ('두피', 477), ('케어', 384), ('머릿결', 316), ('개선', 316), ('크림', 263), ('손상', 228), ('고정력', 188), ('자극', 186), ('스프레이', 179), ('탈모', 164), ('산성', 163), ('퀴드', 156), ('트리트먼트', 156), ('정력', 150), ('각질', 149), ('헤어', 122), ('흡수', 114), ('오일', 112), ('볼륨', 100), ('효과', 97), ('수분', 94)]\n"
     ]
    }
   ],
   "source": [
    "filtered_data = merged[merged['중분류'] =='B002-C002-0007'].copy()\n",
    "filtered_data['tokenized_제품특성_cleaned'] = filtered_data['tokenized_제품특성_cleaned'].apply(lambda x: x.split() if isinstance(x, str) else [])\n",
    "# Now sum up all the token lists into a single list\n",
    "all_tokens = sum(filtered_data['tokenized_제품특성_cleaned'], [])\n",
    "\n",
    "# Proceed with counting the tokens\n",
    "from collections import Counter\n",
    "token_counts = Counter(all_tokens)\n",
    "\n",
    "# Identify the most common tokens\n",
    "most_common_tokens = token_counts.most_common(30)  # adjust the number as needed\n",
    "\n",
    "print(most_common_tokens)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 171,
   "id": "eeff027f",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Karl\\AppData\\Local\\Temp\\ipykernel_29388\\3451976515.py:1: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  merged['중분류:헤어케어'] = merged['중분류'].apply(lambda x: 1 if x == 'B002-C002-0007' else 0)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>제품</th>\n",
       "      <th>대분류</th>\n",
       "      <th>중분류</th>\n",
       "      <th>소분류</th>\n",
       "      <th>브랜드</th>\n",
       "      <th>2022-01-01</th>\n",
       "      <th>2022-01-02</th>\n",
       "      <th>2022-01-03</th>\n",
       "      <th>2022-01-04</th>\n",
       "      <th>...</th>\n",
       "      <th>대분류:생활용품/뷰티</th>\n",
       "      <th>대분류:식품</th>\n",
       "      <th>중분류:성인</th>\n",
       "      <th>중분류:영유아</th>\n",
       "      <th>중분류:용기/봉지</th>\n",
       "      <th>중분류:주방/세탁용품</th>\n",
       "      <th>중분류:구강용품</th>\n",
       "      <th>중분류:휴지/티슈/생리대</th>\n",
       "      <th>중분류:스킨케어</th>\n",
       "      <th>중분류:헤어케어</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>B002-00001-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0007</td>\n",
       "      <td>B002-C003-0038</td>\n",
       "      <td>B002-00001</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>12</td>\n",
       "      <td>B002-00003-00009</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-00003</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>16</td>\n",
       "      <td>B002-00005-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>17</td>\n",
       "      <td>B002-00005-00002</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>19</td>\n",
       "      <td>B002-00005-00004</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15877</th>\n",
       "      <td>15877</td>\n",
       "      <td>B002-03798-00049</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15882</th>\n",
       "      <td>15882</td>\n",
       "      <td>B002-03798-00054</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15883</th>\n",
       "      <td>15883</td>\n",
       "      <td>B002-03798-00055</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15887</th>\n",
       "      <td>15887</td>\n",
       "      <td>B002-03799-00004</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15888</th>\n",
       "      <td>15888</td>\n",
       "      <td>B002-03799-00005</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10481 rows × 486 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          ID                제품             대분류             중분류  \\\n",
       "0          0  B002-00001-00001  B002-C001-0002  B002-C002-0007   \n",
       "12        12  B002-00003-00009  B002-C001-0001  B002-C002-0001   \n",
       "16        16  B002-00005-00001  B002-C001-0002  B002-C002-0006   \n",
       "17        17  B002-00005-00002  B002-C001-0002  B002-C002-0006   \n",
       "19        19  B002-00005-00004  B002-C001-0002  B002-C002-0006   \n",
       "...      ...               ...             ...             ...   \n",
       "15877  15877  B002-03798-00049  B002-C001-0003  B002-C002-0008   \n",
       "15882  15882  B002-03798-00054  B002-C001-0003  B002-C002-0008   \n",
       "15883  15883  B002-03798-00055  B002-C001-0003  B002-C002-0008   \n",
       "15887  15887  B002-03799-00004  B002-C001-0003  B002-C002-0008   \n",
       "15888  15888  B002-03799-00005  B002-C001-0003  B002-C002-0008   \n",
       "\n",
       "                  소분류         브랜드  2022-01-01  2022-01-02  2022-01-03  \\\n",
       "0      B002-C003-0038  B002-00001           0           0           0   \n",
       "12     B002-C003-0003  B002-00003           0           0           0   \n",
       "16     B002-C003-0032  B002-00005           0           0           0   \n",
       "17     B002-C003-0032  B002-00005           0           0           0   \n",
       "19     B002-C003-0032  B002-00005           0           0           0   \n",
       "...               ...         ...         ...         ...         ...   \n",
       "15877  B002-C003-0044  B002-03798           0           0           0   \n",
       "15882  B002-C003-0044  B002-03798           0           0           0   \n",
       "15883  B002-C003-0044  B002-03798           0           0           0   \n",
       "15887  B002-C003-0044  B002-03799           0           0           0   \n",
       "15888  B002-C003-0044  B002-03799           0           0           0   \n",
       "\n",
       "       2022-01-04  ...  대분류:생활용품/뷰티  대분류:식품  중분류:성인  중분류:영유아  중분류:용기/봉지  \\\n",
       "0               0  ...            1       0       0        0          0   \n",
       "12              0  ...            0       0       1        0          0   \n",
       "16              0  ...            1       0       0        0          0   \n",
       "17              0  ...            1       0       0        0          0   \n",
       "19              0  ...            1       0       0        0          0   \n",
       "...           ...  ...          ...     ...     ...      ...        ...   \n",
       "15877           0  ...            0       0       0        0          0   \n",
       "15882           0  ...            0       0       0        0          0   \n",
       "15883           0  ...            0       0       0        0          0   \n",
       "15887           0  ...            0       0       0        0          0   \n",
       "15888           0  ...            0       0       0        0          0   \n",
       "\n",
       "       중분류:주방/세탁용품  중분류:구강용품  중분류:휴지/티슈/생리대  중분류:스킨케어  중분류:헤어케어  \n",
       "0                0         0              0         0         1  \n",
       "12               0         0              0         0         0  \n",
       "16               0         0              0         1         0  \n",
       "17               0         0              0         1         0  \n",
       "19               0         0              0         1         0  \n",
       "...            ...       ...            ...       ...       ...  \n",
       "15877            0         0              0         0         0  \n",
       "15882            0         0              0         0         0  \n",
       "15883            0         0              0         0         0  \n",
       "15887            0         0              0         0         0  \n",
       "15888            0         0              0         0         0  \n",
       "\n",
       "[10481 rows x 486 columns]"
      ]
     },
     "execution_count": 171,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merged['중분류:헤어케어'] = merged['중분류'].apply(lambda x: 1 if x == 'B002-C002-0007' else 0)\n",
    "merged"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 172,
   "id": "46315eec",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['B002-C002-0008' 'B002-C002-0010']\n"
     ]
    }
   ],
   "source": [
    "filtered_data = merged[merged['대분류'] == 'B002-C001-0003']\n",
    "unique_subcategories = filtered_data['중분류'].unique()\n",
    "print(unique_subcategories)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 177,
   "id": "88ef13c7",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[('실리콘', 53), ('비스페놀', 45), ('방지', 45), ('젖병', 37), ('빨대', 30), ('소재', 26), ('신생아', 22), ('단계', 21), ('배앓이', 20), ('일반', 17), ('전자레인지', 17), ('상형', 15), ('세트', 15), ('자외선', 14), ('와이드', 13), ('베이비', 13), ('기능', 12), ('보관', 11), ('기타', 11), ('열탕', 10), ('유선형', 10), ('몸체', 10), ('개월', 10), ('이탄', 9), ('모유', 9), ('실감', 9), ('멸균', 9), ('스테인리스', 9), ('스틸', 9), ('가정', 8)]\n"
     ]
    }
   ],
   "source": [
    "filtered_data = merged[merged['중분류'] =='B002-C002-0008'].copy()\n",
    "filtered_data['tokenized_제품특성_cleaned'] = filtered_data['tokenized_제품특성_cleaned'].apply(lambda x: x.split() if isinstance(x, str) else [])\n",
    "# Now sum up all the token lists into a single list\n",
    "all_tokens = sum(filtered_data['tokenized_제품특성_cleaned'], [])\n",
    "\n",
    "# Proceed with counting the tokens\n",
    "from collections import Counter\n",
    "token_counts = Counter(all_tokens)\n",
    "\n",
    "# Identify the most common tokens\n",
    "most_common_tokens = token_counts.most_common(30)  # adjust the number as needed\n",
    "\n",
    "print(most_common_tokens)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 174,
   "id": "32a49a90",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Karl\\AppData\\Local\\Temp\\ipykernel_29388\\3244799351.py:1: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  merged['중분류:젖병/빨대'] = merged['중분류'].apply(lambda x: 1 if x == 'B002-C002-0008' else 0)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>제품</th>\n",
       "      <th>대분류</th>\n",
       "      <th>중분류</th>\n",
       "      <th>소분류</th>\n",
       "      <th>브랜드</th>\n",
       "      <th>2022-01-01</th>\n",
       "      <th>2022-01-02</th>\n",
       "      <th>2022-01-03</th>\n",
       "      <th>2022-01-04</th>\n",
       "      <th>...</th>\n",
       "      <th>대분류:식품</th>\n",
       "      <th>중분류:성인</th>\n",
       "      <th>중분류:영유아</th>\n",
       "      <th>중분류:용기/봉지</th>\n",
       "      <th>중분류:주방/세탁용품</th>\n",
       "      <th>중분류:구강용품</th>\n",
       "      <th>중분류:휴지/티슈/생리대</th>\n",
       "      <th>중분류:스킨케어</th>\n",
       "      <th>중분류:헤어케어</th>\n",
       "      <th>중분류:젖병/빨대</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>B002-00001-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0007</td>\n",
       "      <td>B002-C003-0038</td>\n",
       "      <td>B002-00001</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>12</td>\n",
       "      <td>B002-00003-00009</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-00003</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>16</td>\n",
       "      <td>B002-00005-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>17</td>\n",
       "      <td>B002-00005-00002</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>19</td>\n",
       "      <td>B002-00005-00004</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15877</th>\n",
       "      <td>15877</td>\n",
       "      <td>B002-03798-00049</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15882</th>\n",
       "      <td>15882</td>\n",
       "      <td>B002-03798-00054</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15883</th>\n",
       "      <td>15883</td>\n",
       "      <td>B002-03798-00055</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15887</th>\n",
       "      <td>15887</td>\n",
       "      <td>B002-03799-00004</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15888</th>\n",
       "      <td>15888</td>\n",
       "      <td>B002-03799-00005</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10481 rows × 487 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          ID                제품             대분류             중분류  \\\n",
       "0          0  B002-00001-00001  B002-C001-0002  B002-C002-0007   \n",
       "12        12  B002-00003-00009  B002-C001-0001  B002-C002-0001   \n",
       "16        16  B002-00005-00001  B002-C001-0002  B002-C002-0006   \n",
       "17        17  B002-00005-00002  B002-C001-0002  B002-C002-0006   \n",
       "19        19  B002-00005-00004  B002-C001-0002  B002-C002-0006   \n",
       "...      ...               ...             ...             ...   \n",
       "15877  15877  B002-03798-00049  B002-C001-0003  B002-C002-0008   \n",
       "15882  15882  B002-03798-00054  B002-C001-0003  B002-C002-0008   \n",
       "15883  15883  B002-03798-00055  B002-C001-0003  B002-C002-0008   \n",
       "15887  15887  B002-03799-00004  B002-C001-0003  B002-C002-0008   \n",
       "15888  15888  B002-03799-00005  B002-C001-0003  B002-C002-0008   \n",
       "\n",
       "                  소분류         브랜드  2022-01-01  2022-01-02  2022-01-03  \\\n",
       "0      B002-C003-0038  B002-00001           0           0           0   \n",
       "12     B002-C003-0003  B002-00003           0           0           0   \n",
       "16     B002-C003-0032  B002-00005           0           0           0   \n",
       "17     B002-C003-0032  B002-00005           0           0           0   \n",
       "19     B002-C003-0032  B002-00005           0           0           0   \n",
       "...               ...         ...         ...         ...         ...   \n",
       "15877  B002-C003-0044  B002-03798           0           0           0   \n",
       "15882  B002-C003-0044  B002-03798           0           0           0   \n",
       "15883  B002-C003-0044  B002-03798           0           0           0   \n",
       "15887  B002-C003-0044  B002-03799           0           0           0   \n",
       "15888  B002-C003-0044  B002-03799           0           0           0   \n",
       "\n",
       "       2022-01-04  ...  대분류:식품  중분류:성인  중분류:영유아  중분류:용기/봉지  중분류:주방/세탁용품  \\\n",
       "0               0  ...       0       0        0          0            0   \n",
       "12              0  ...       0       1        0          0            0   \n",
       "16              0  ...       0       0        0          0            0   \n",
       "17              0  ...       0       0        0          0            0   \n",
       "19              0  ...       0       0        0          0            0   \n",
       "...           ...  ...     ...     ...      ...        ...          ...   \n",
       "15877           0  ...       0       0        0          0            0   \n",
       "15882           0  ...       0       0        0          0            0   \n",
       "15883           0  ...       0       0        0          0            0   \n",
       "15887           0  ...       0       0        0          0            0   \n",
       "15888           0  ...       0       0        0          0            0   \n",
       "\n",
       "       중분류:구강용품  중분류:휴지/티슈/생리대  중분류:스킨케어  중분류:헤어케어  중분류:젖병/빨대  \n",
       "0             0              0         0         1          0  \n",
       "12            0              0         0         0          0  \n",
       "16            0              0         1         0          0  \n",
       "17            0              0         1         0          0  \n",
       "19            0              0         1         0          0  \n",
       "...         ...            ...       ...       ...        ...  \n",
       "15877         0              0         0         0          1  \n",
       "15882         0              0         0         0          1  \n",
       "15883         0              0         0         0          1  \n",
       "15887         0              0         0         0          1  \n",
       "15888         0              0         0         0          1  \n",
       "\n",
       "[10481 rows x 487 columns]"
      ]
     },
     "execution_count": 174,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merged['중분류:젖병/빨대'] = merged['중분류'].apply(lambda x: 1 if x == 'B002-C002-0008' else 0)\n",
    "merged"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 187,
   "id": "216f3068",
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[('피부', 11), ('공급', 8), ('콤팩트', 8), ('튜브', 6), ('자극', 6), ('용기', 6), ('수분', 5), ('장벽', 5), ('강화', 5), ('영양', 3), ('진정', 3), ('세트', 3), ('탈크', 2), ('오일', 2), ('프리', 2), ('보호', 2), ('기타', 2), ('무향', 2), ('파라', 1), ('가성', 1), ('쿠션', 1), ('무인', 1), ('향료', 1), ('분말', 1), ('바로', 1), ('과일', 1), ('항산화', 1), ('히알루론산', 1), ('사료', 1), ('스틱', 1)]\n"
     ]
    }
   ],
   "source": [
    "filtered_data = merged[merged['중분류'] =='B002-C002-0010'].copy()\n",
    "filtered_data['tokenized_제품특성_cleaned'] = filtered_data['tokenized_제품특성_cleaned'].apply(lambda x: x.split() if isinstance(x, str) else [])\n",
    "# Now sum up all the token lists into a single list\n",
    "all_tokens = sum(filtered_data['tokenized_제품특성_cleaned'], [])\n",
    "\n",
    "# Proceed with counting the tokens\n",
    "from collections import Counter\n",
    "token_counts = Counter(all_tokens)\n",
    "\n",
    "# Identify the most common tokens\n",
    "most_common_tokens = token_counts.most_common(30)  # adjust the number as needed\n",
    "\n",
    "print(most_common_tokens)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 193,
   "id": "d0e8fcdb",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Karl\\AppData\\Local\\Temp\\ipykernel_29388\\421656347.py:1: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  merged['중분류:기저귀/'] = merged['중분류'].apply(lambda x: 1 if x == 'B002-C002-0010' else 0)\n",
      "C:\\Users\\Karl\\AppData\\Local\\Temp\\ipykernel_29388\\421656347.py:3: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  merged.rename(columns={'중분류:기저귀/': '중분류:기저귀/크림'}, inplace=True)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>제품</th>\n",
       "      <th>대분류</th>\n",
       "      <th>중분류</th>\n",
       "      <th>소분류</th>\n",
       "      <th>브랜드</th>\n",
       "      <th>2022-01-01</th>\n",
       "      <th>2022-01-02</th>\n",
       "      <th>2022-01-03</th>\n",
       "      <th>2022-01-04</th>\n",
       "      <th>...</th>\n",
       "      <th>중분류:성인</th>\n",
       "      <th>중분류:영유아</th>\n",
       "      <th>중분류:용기/봉지</th>\n",
       "      <th>중분류:주방/세탁용품</th>\n",
       "      <th>중분류:구강용품</th>\n",
       "      <th>중분류:휴지/티슈/생리대</th>\n",
       "      <th>중분류:스킨케어</th>\n",
       "      <th>중분류:헤어케어</th>\n",
       "      <th>중분류:젖병/빨대</th>\n",
       "      <th>중분류:기저귀/크림</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>B002-00001-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0007</td>\n",
       "      <td>B002-C003-0038</td>\n",
       "      <td>B002-00001</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>12</td>\n",
       "      <td>B002-00003-00009</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-00003</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>16</td>\n",
       "      <td>B002-00005-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>17</td>\n",
       "      <td>B002-00005-00002</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>19</td>\n",
       "      <td>B002-00005-00004</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15877</th>\n",
       "      <td>15877</td>\n",
       "      <td>B002-03798-00049</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15882</th>\n",
       "      <td>15882</td>\n",
       "      <td>B002-03798-00054</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15883</th>\n",
       "      <td>15883</td>\n",
       "      <td>B002-03798-00055</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15887</th>\n",
       "      <td>15887</td>\n",
       "      <td>B002-03799-00004</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15888</th>\n",
       "      <td>15888</td>\n",
       "      <td>B002-03799-00005</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10481 rows × 488 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          ID                제품             대분류             중분류  \\\n",
       "0          0  B002-00001-00001  B002-C001-0002  B002-C002-0007   \n",
       "12        12  B002-00003-00009  B002-C001-0001  B002-C002-0001   \n",
       "16        16  B002-00005-00001  B002-C001-0002  B002-C002-0006   \n",
       "17        17  B002-00005-00002  B002-C001-0002  B002-C002-0006   \n",
       "19        19  B002-00005-00004  B002-C001-0002  B002-C002-0006   \n",
       "...      ...               ...             ...             ...   \n",
       "15877  15877  B002-03798-00049  B002-C001-0003  B002-C002-0008   \n",
       "15882  15882  B002-03798-00054  B002-C001-0003  B002-C002-0008   \n",
       "15883  15883  B002-03798-00055  B002-C001-0003  B002-C002-0008   \n",
       "15887  15887  B002-03799-00004  B002-C001-0003  B002-C002-0008   \n",
       "15888  15888  B002-03799-00005  B002-C001-0003  B002-C002-0008   \n",
       "\n",
       "                  소분류         브랜드  2022-01-01  2022-01-02  2022-01-03  \\\n",
       "0      B002-C003-0038  B002-00001           0           0           0   \n",
       "12     B002-C003-0003  B002-00003           0           0           0   \n",
       "16     B002-C003-0032  B002-00005           0           0           0   \n",
       "17     B002-C003-0032  B002-00005           0           0           0   \n",
       "19     B002-C003-0032  B002-00005           0           0           0   \n",
       "...               ...         ...         ...         ...         ...   \n",
       "15877  B002-C003-0044  B002-03798           0           0           0   \n",
       "15882  B002-C003-0044  B002-03798           0           0           0   \n",
       "15883  B002-C003-0044  B002-03798           0           0           0   \n",
       "15887  B002-C003-0044  B002-03799           0           0           0   \n",
       "15888  B002-C003-0044  B002-03799           0           0           0   \n",
       "\n",
       "       2022-01-04  ...  중분류:성인  중분류:영유아  중분류:용기/봉지  중분류:주방/세탁용품  중분류:구강용품  \\\n",
       "0               0  ...       0        0          0            0         0   \n",
       "12              0  ...       1        0          0            0         0   \n",
       "16              0  ...       0        0          0            0         0   \n",
       "17              0  ...       0        0          0            0         0   \n",
       "19              0  ...       0        0          0            0         0   \n",
       "...           ...  ...     ...      ...        ...          ...       ...   \n",
       "15877           0  ...       0        0          0            0         0   \n",
       "15882           0  ...       0        0          0            0         0   \n",
       "15883           0  ...       0        0          0            0         0   \n",
       "15887           0  ...       0        0          0            0         0   \n",
       "15888           0  ...       0        0          0            0         0   \n",
       "\n",
       "       중분류:휴지/티슈/생리대  중분류:스킨케어  중분류:헤어케어  중분류:젖병/빨대  중분류:기저귀/크림  \n",
       "0                  0         0         1          0           0  \n",
       "12                 0         0         0          0           0  \n",
       "16                 0         1         0          0           0  \n",
       "17                 0         1         0          0           0  \n",
       "19                 0         1         0          0           0  \n",
       "...              ...       ...       ...        ...         ...  \n",
       "15877              0         0         0          1           0  \n",
       "15882              0         0         0          1           0  \n",
       "15883              0         0         0          1           0  \n",
       "15887              0         0         0          1           0  \n",
       "15888              0         0         0          1           0  \n",
       "\n",
       "[10481 rows x 488 columns]"
      ]
     },
     "execution_count": 193,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merged['중분류:기저귀/'] = merged['중분류'].apply(lambda x: 1 if x == 'B002-C002-0010' else 0)\n",
    "merged\n",
    "merged.rename(columns={'중분류:기저귀/': '중분류:기저귀/크림'}, inplace=True)\n",
    "merged"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 188,
   "id": "4644398c",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[('기타', 290), ('아기', 174), ('개월', 144), ('파우치', 128), ('단계', 109), ('인증', 94), ('합성', 91), ('주스', 81), ('보관', 70), ('향료', 58), ('과자', 52), ('유기농', 49), ('성분', 48), ('유발', 47), ('쇠고기', 40), ('유기', 36), ('가공', 36), ('식품', 36), ('냉장', 35), ('대두', 35), ('실온', 29), ('반찬', 25), ('첨가', 24), ('티백', 20), ('우유', 19), ('진밥', 18), ('소스', 18), ('닭고기', 17), ('개입', 17), ('감미료', 16)]\n"
     ]
    }
   ],
   "source": [
    "filtered_data = merged[merged['중분류'] =='B002-C002-0011'].copy()\n",
    "filtered_data['tokenized_제품특성_cleaned'] = filtered_data['tokenized_제품특성_cleaned'].apply(lambda x: x.split() if isinstance(x, str) else [])\n",
    "# Now sum up all the token lists into a single list\n",
    "all_tokens = sum(filtered_data['tokenized_제품특성_cleaned'], [])\n",
    "\n",
    "# Proceed with counting the tokens\n",
    "from collections import Counter\n",
    "token_counts = Counter(all_tokens)\n",
    "\n",
    "# Identify the most common tokens\n",
    "most_common_tokens = token_counts.most_common(30)  # adjust the number as needed\n",
    "\n",
    "print(most_common_tokens)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 195,
   "id": "3c236182",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Karl\\AppData\\Local\\Temp\\ipykernel_29388\\306966645.py:1: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  merged['어린이음료'] = merged['중분류'].apply(lambda x: 1 if x == 'B002-C002-0011' else 0)\n",
      "C:\\Users\\Karl\\AppData\\Local\\Temp\\ipykernel_29388\\306966645.py:3: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  merged.rename(columns={'어린이음료': '중분류:어린이식품'}, inplace=True)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>제품</th>\n",
       "      <th>대분류</th>\n",
       "      <th>중분류</th>\n",
       "      <th>소분류</th>\n",
       "      <th>브랜드</th>\n",
       "      <th>2022-01-01</th>\n",
       "      <th>2022-01-02</th>\n",
       "      <th>2022-01-03</th>\n",
       "      <th>2022-01-04</th>\n",
       "      <th>...</th>\n",
       "      <th>중분류:영유아</th>\n",
       "      <th>중분류:용기/봉지</th>\n",
       "      <th>중분류:주방/세탁용품</th>\n",
       "      <th>중분류:구강용품</th>\n",
       "      <th>중분류:휴지/티슈/생리대</th>\n",
       "      <th>중분류:스킨케어</th>\n",
       "      <th>중분류:헤어케어</th>\n",
       "      <th>중분류:젖병/빨대</th>\n",
       "      <th>중분류:기저귀/크림</th>\n",
       "      <th>중분류:어린이식품</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>B002-00001-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0007</td>\n",
       "      <td>B002-C003-0038</td>\n",
       "      <td>B002-00001</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>12</td>\n",
       "      <td>B002-00003-00009</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-00003</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>16</td>\n",
       "      <td>B002-00005-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>17</td>\n",
       "      <td>B002-00005-00002</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>19</td>\n",
       "      <td>B002-00005-00004</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0006</td>\n",
       "      <td>B002-C003-0032</td>\n",
       "      <td>B002-00005</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15877</th>\n",
       "      <td>15877</td>\n",
       "      <td>B002-03798-00049</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15882</th>\n",
       "      <td>15882</td>\n",
       "      <td>B002-03798-00054</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15883</th>\n",
       "      <td>15883</td>\n",
       "      <td>B002-03798-00055</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03798</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15887</th>\n",
       "      <td>15887</td>\n",
       "      <td>B002-03799-00004</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15888</th>\n",
       "      <td>15888</td>\n",
       "      <td>B002-03799-00005</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10481 rows × 489 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          ID                제품             대분류             중분류  \\\n",
       "0          0  B002-00001-00001  B002-C001-0002  B002-C002-0007   \n",
       "12        12  B002-00003-00009  B002-C001-0001  B002-C002-0001   \n",
       "16        16  B002-00005-00001  B002-C001-0002  B002-C002-0006   \n",
       "17        17  B002-00005-00002  B002-C001-0002  B002-C002-0006   \n",
       "19        19  B002-00005-00004  B002-C001-0002  B002-C002-0006   \n",
       "...      ...               ...             ...             ...   \n",
       "15877  15877  B002-03798-00049  B002-C001-0003  B002-C002-0008   \n",
       "15882  15882  B002-03798-00054  B002-C001-0003  B002-C002-0008   \n",
       "15883  15883  B002-03798-00055  B002-C001-0003  B002-C002-0008   \n",
       "15887  15887  B002-03799-00004  B002-C001-0003  B002-C002-0008   \n",
       "15888  15888  B002-03799-00005  B002-C001-0003  B002-C002-0008   \n",
       "\n",
       "                  소분류         브랜드  2022-01-01  2022-01-02  2022-01-03  \\\n",
       "0      B002-C003-0038  B002-00001           0           0           0   \n",
       "12     B002-C003-0003  B002-00003           0           0           0   \n",
       "16     B002-C003-0032  B002-00005           0           0           0   \n",
       "17     B002-C003-0032  B002-00005           0           0           0   \n",
       "19     B002-C003-0032  B002-00005           0           0           0   \n",
       "...               ...         ...         ...         ...         ...   \n",
       "15877  B002-C003-0044  B002-03798           0           0           0   \n",
       "15882  B002-C003-0044  B002-03798           0           0           0   \n",
       "15883  B002-C003-0044  B002-03798           0           0           0   \n",
       "15887  B002-C003-0044  B002-03799           0           0           0   \n",
       "15888  B002-C003-0044  B002-03799           0           0           0   \n",
       "\n",
       "       2022-01-04  ...  중분류:영유아  중분류:용기/봉지  중분류:주방/세탁용품  중분류:구강용품  \\\n",
       "0               0  ...        0          0            0         0   \n",
       "12              0  ...        0          0            0         0   \n",
       "16              0  ...        0          0            0         0   \n",
       "17              0  ...        0          0            0         0   \n",
       "19              0  ...        0          0            0         0   \n",
       "...           ...  ...      ...        ...          ...       ...   \n",
       "15877           0  ...        0          0            0         0   \n",
       "15882           0  ...        0          0            0         0   \n",
       "15883           0  ...        0          0            0         0   \n",
       "15887           0  ...        0          0            0         0   \n",
       "15888           0  ...        0          0            0         0   \n",
       "\n",
       "       중분류:휴지/티슈/생리대  중분류:스킨케어  중분류:헤어케어  중분류:젖병/빨대  중분류:기저귀/크림  중분류:어린이식품  \n",
       "0                  0         0         1          0           0          0  \n",
       "12                 0         0         0          0           0          0  \n",
       "16                 0         1         0          0           0          0  \n",
       "17                 0         1         0          0           0          0  \n",
       "19                 0         1         0          0           0          0  \n",
       "...              ...       ...       ...        ...         ...        ...  \n",
       "15877              0         0         0          1           0          0  \n",
       "15882              0         0         0          1           0          0  \n",
       "15883              0         0         0          1           0          0  \n",
       "15887              0         0         0          1           0          0  \n",
       "15888              0         0         0          1           0          0  \n",
       "\n",
       "[10481 rows x 489 columns]"
      ]
     },
     "execution_count": 195,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merged['어린이음료'] = merged['중분류'].apply(lambda x: 1 if x == 'B002-C002-0011' else 0)\n",
    "merged\n",
    "merged.rename(columns={'어린이음료': '중분류:어린이식품'}, inplace=True)\n",
    "merged"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 198,
   "id": "5bf185cf",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'B002-C001-0001': '건강식품',\n",
       " 'B002-C001-0002': '생활용품/뷰티',\n",
       " 'B002-C001-0003': '출산/유아동',\n",
       " 'B002-C001-0004': '유아 선크림',\n",
       " 'B002-C001-0005': '식품'}"
      ]
     },
     "execution_count": 198,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "major_category"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 202,
   "id": "cc9ce11a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'B002-C002-0001': '성인',\n",
       " 'B002-C002-0002': '용기/봉지',\n",
       " 'B002-C002-0003': '주방/세탁용품',\n",
       " 'B002-C002-0004': '구강용품',\n",
       " 'B002-C002-0005': '휴지/티슈/생리대',\n",
       " 'B002-C002-0006': '스킨케어',\n",
       " 'B002-C002-0007': '헤어케어',\n",
       " 'B002-C002-0008': '젖병/빨대',\n",
       " 'B002-C002-0009': '영유아',\n",
       " 'B002-C002-0010': '기저귀/크림',\n",
       " 'B002-C002-0011': '어린이식품'}"
      ]
     },
     "execution_count": 202,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sub_category = {\n",
    "    'B002-C002-0001': '성인',\n",
    "    'B002-C002-0002': '용기/봉지',\n",
    "    'B002-C002-0003': '주방/세탁용품',\n",
    "    'B002-C002-0004': '구강용품',\n",
    "    'B002-C002-0005': '휴지/티슈/생리대',\n",
    "    'B002-C002-0006': '스킨케어',\n",
    "    'B002-C002-0007': '헤어케어',\n",
    "    'B002-C002-0008': '젖병/빨대',\n",
    "    'B002-C002-0009': '영유아',\n",
    "    'B002-C002-0010': '기저귀/크림',\n",
    "    'B002-C002-0011': '어린이식품'\n",
    "}\n",
    "sub_category"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1e2d59c7",
   "metadata": {},
   "source": [
    "## Exclusive Keywords"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 145,
   "id": "a90cc7f5",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "               중분류                                 Exclusive Keywords\n",
      "0   B002-C002-0001         [성인, 하루, 남녀, 캡슐, 개월, 건강, 단백질, 비타민, 바로, 식품]\n",
      "1   B002-C002-0002        [일회용, 회용, 봉지, 용기, 걸이, 액체, 부직포, 원형, 재사용, 체형]\n",
      "2   B002-C002-0003         [상형, 일반, 리필, 조리기구, 가루, 탁용, 개입, 파라, 야채, 무미]\n",
      "3   B002-C002-0004        [일반, 칫솔, 플라스틱, 예방, 미세, 제거, 음파, 충전, 화이트, 질환]\n",
      "4   B002-C002-0005        [엠보싱, 날개, 계정수, 보습, 효과, 공용, 자극, 플레인, 두루, 마리]\n",
      "5   B002-C002-0006           [피부, 펌프, 튜브, 흡수, 헤드, 공급, 기타, 영양, 기본, 구성]\n",
      "6   B002-C002-0007           [모든, 샴푸, 영양, 펌프, 윤기, 부여, 모발, 공급, 일반, 두피]\n",
      "7   B002-C002-0008  [실리콘, 비스페놀, 방지, 젖병, 빨대, 소재, 신생아, 배앓이, 전자레인지, 자외선]\n",
      "8   B002-C002-0009           [자극, 피부, 유아, 공급, 튜브, 세트, 단계, 강화, 수분, 장벽]\n",
      "9   B002-C002-0010                           [콤팩트, 탈크, 가성, 히알루론산, 사료]\n",
      "10  B002-C002-0011          [기타, 아기, 파우치, 단계, 인증, 합성, 주스, 보관, 향료, 과자]\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "from collections import defaultdict, Counter\n",
    "\n",
    "# Aggregate Tokens by '중분류'\n",
    "tokens_by_subcategory = defaultdict(list)\n",
    "for subcategory, group in merged.groupby('중분류'):\n",
    "    all_tokens = sum(group['tokenized_제품특성_cleaned'].apply(lambda x: x.split() if isinstance(x, str) else []), [])\n",
    "    tokens_by_subcategory[subcategory] = all_tokens\n",
    "\n",
    "# Calculate Token Frequencies\n",
    "token_frequencies_by_subcategory = {subcategory: Counter(tokens) for subcategory, tokens in tokens_by_subcategory.items()}\n",
    "\n",
    "# Identify Exclusive Keywords\n",
    "exclusive_keywords_data = []\n",
    "for subcategory, counter in token_frequencies_by_subcategory.items():\n",
    "    # Calculate the average frequency of each token in other subcategories\n",
    "    other_subcategories = set(token_frequencies_by_subcategory.keys()) - {subcategory}\n",
    "    average_frequencies = Counter()\n",
    "    for other_subcategory in other_subcategories:\n",
    "        average_frequencies += token_frequencies_by_subcategory[other_subcategory]\n",
    "    average_frequencies = {token: freq / len(other_subcategories) for token, freq in average_frequencies.items()}\n",
    "    \n",
    "    # Find tokens that are significantly more frequent in the current subcategory\n",
    "    exclusive_keywords = [(token, freq) for token, freq in counter.items() if freq > average_frequencies.get(token, 0) * 2]  # Threshold\n",
    "    exclusive_keywords = sorted(exclusive_keywords, key=lambda x: x[1], reverse=True)[:10]  # Top 10 keywords\n",
    "    exclusive_keywords_data.append({'중분류': subcategory, 'Exclusive Keywords': [kw[0] for kw in exclusive_keywords]})\n",
    "\n",
    "# Convert to DataFrame for readability\n",
    "exclusive_keywords_df = pd.DataFrame(exclusive_keywords_data)\n",
    "\n",
    "print(exclusive_keywords_df)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a8ffa8b3",
   "metadata": {},
   "source": [
    "## 소분류\n",
    "## 반복되는 workflow 함수 활용"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 203,
   "id": "90df6561",
   "metadata": {},
   "outputs": [],
   "source": [
    "def display_category_distribution(df, categories):\n",
    "    for category in categories:\n",
    "        group = df.groupby(category).size()\n",
    "        print(f\"Distribution for {category}:\")\n",
    "        print(group, \"\\n\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 204,
   "id": "f3731664",
   "metadata": {},
   "outputs": [],
   "source": [
    "def extract_keywords(df, category_col, category_value, num_keywords=30):\n",
    "    filtered_df = df[df[category_col] == category_value]\n",
    "    all_tokens = sum(filtered_df['tokenized_제품특성_cleaned'].apply(lambda x: x.split() if isinstance(x, str) else []), [])\n",
    "    return Counter(all_tokens).most_common(num_keywords)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 205,
   "id": "479b2e3e",
   "metadata": {},
   "outputs": [],
   "source": [
    "def extract_exclusive_keywords(df, category_col):\n",
    "    exclusive_keywords = {}\n",
    "    categories = df[category_col].unique()\n",
    "    \n",
    "    for category in categories:\n",
    "        other_categories = [c for c in categories if c != category]\n",
    "        category_tokens = sum(df[df[category_col] == category]['tokenized_제품특성_cleaned'], [])\n",
    "        other_tokens = sum(df[df[category_col].isin(other_categories)]['tokenized_제품특성_cleaned'], [])\n",
    "        \n",
    "        category_counts = Counter(category_tokens)\n",
    "        other_counts = Counter(other_tokens)\n",
    "        \n",
    "        exclusive = {token: count for token, count in category_counts.items() if count > other_counts[token] * 2}\n",
    "        exclusive_keywords[category] = sorted(exclusive, key=exclusive.get, reverse=True)[:10]\n",
    "    \n",
    "    return exclusive_keywords\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 206,
   "id": "063b6678",
   "metadata": {},
   "outputs": [],
   "source": [
    "def label_encode_categories(df, category_mapping):\n",
    "    for original_category, new_category in category_mapping.items():\n",
    "        column_name = f\"category_{new_category}\"\n",
    "        df[column_name] = (df['중분류'] == original_category).astype(int)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 207,
   "id": "f8a84b3e",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Distribution for 대분류:\n",
      "대분류\n",
      "B002-C001-0001    2642\n",
      "B002-C001-0002    7158\n",
      "B002-C001-0003     144\n",
      "B002-C001-0004      89\n",
      "B002-C001-0005     448\n",
      "dtype: int64 \n",
      "\n",
      "Distribution for 중분류:\n",
      "중분류\n",
      "B002-C002-0001    2563\n",
      "B002-C002-0002     170\n",
      "B002-C002-0003     987\n",
      "B002-C002-0004     735\n",
      "B002-C002-0005    1466\n",
      "B002-C002-0006    1232\n",
      "B002-C002-0007    1932\n",
      "B002-C002-0008     125\n",
      "B002-C002-0009     804\n",
      "B002-C002-0010      19\n",
      "B002-C002-0011     448\n",
      "dtype: int64 \n",
      "\n",
      "Distribution for 소분류:\n",
      "소분류\n",
      "B002-C003-0001     463\n",
      "B002-C003-0002     483\n",
      "B002-C003-0003    1096\n",
      "B002-C003-0004     289\n",
      "B002-C003-0005     232\n",
      "B002-C003-0006      30\n",
      "B002-C003-0007      11\n",
      "B002-C003-0008      16\n",
      "B002-C003-0009      33\n",
      "B002-C003-0010      27\n",
      "B002-C003-0011      53\n",
      "B002-C003-0012      45\n",
      "B002-C003-0013      56\n",
      "B002-C003-0014     154\n",
      "B002-C003-0015     348\n",
      "B002-C003-0016     227\n",
      "B002-C003-0017     120\n",
      "B002-C003-0018      37\n",
      "B002-C003-0019      63\n",
      "B002-C003-0020      74\n",
      "B002-C003-0021      94\n",
      "B002-C003-0022     250\n",
      "B002-C003-0023     254\n",
      "B002-C003-0024     185\n",
      "B002-C003-0025     583\n",
      "B002-C003-0026      93\n",
      "B002-C003-0027     291\n",
      "B002-C003-0028      90\n",
      "B002-C003-0029     108\n",
      "B002-C003-0030      79\n",
      "B002-C003-0031      41\n",
      "B002-C003-0032     191\n",
      "B002-C003-0033      81\n",
      "B002-C003-0034     840\n",
      "B002-C003-0035     530\n",
      "B002-C003-0036     280\n",
      "B002-C003-0037     149\n",
      "B002-C003-0038     351\n",
      "B002-C003-0039     281\n",
      "B002-C003-0040     341\n",
      "B002-C003-0041     116\n",
      "B002-C003-0042      22\n",
      "B002-C003-0043      48\n",
      "B002-C003-0044      55\n",
      "B002-C003-0045     229\n",
      "B002-C003-0046     174\n",
      "B002-C003-0047      89\n",
      "B002-C003-0048     116\n",
      "B002-C003-0049     117\n",
      "B002-C003-0050      19\n",
      "B002-C003-0051      79\n",
      "B002-C003-0052     284\n",
      "B002-C003-0053     164\n",
      "dtype: int64 \n",
      "\n"
     ]
    }
   ],
   "source": [
    "display_category_distribution(merged, ['대분류', '중분류', '소분류'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 210,
   "id": "fe2b471e",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Karl\\AppData\\Local\\Temp\\ipykernel_29388\\2694196707.py:2: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  merged['tokenized_제품특성_cleaned'] = merged['tokenized_제품특성_cleaned'].apply(lambda x: x.split() if isinstance(x, str) else x)\n"
     ]
    }
   ],
   "source": [
    "# Directly split the strings by spaces to create lists of tokens\n",
    "merged['tokenized_제품특성_cleaned'] = merged['tokenized_제품특성_cleaned'].apply(lambda x: x.split() if isinstance(x, str) else x)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 211,
   "id": "9b61bc03",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Exclusive keywords for B002-C003-0038: ['토닉', '스타', '일링', '열풍', '원적외선', '모듈', '레드', '네추럴', '피치', '건담']\n",
      "Exclusive keywords for B002-C003-0003: ['캡슐', '혈행', '마그네슘', '전립선', '유산균', '베타카로틴', '기억', '필름', '미국', '면질']\n",
      "Exclusive keywords for B002-C003-0032: ['손소독제', '손목', '아이보리', '미러볼', '오크', '린콜']\n",
      "Exclusive keywords for B002-C003-0034: ['흡수', '뚜껑', '발림', '탄력', '클렌', '머스크', '우디', '얼굴', '코튼', '중건']\n",
      "Exclusive keywords for B002-C003-0019: ['스트롱', '레쉬', '결제', '가스']\n",
      "Exclusive keywords for B002-C003-0001: ['체지방', '어류', '감소', '기준', '다이어트', '볶음밥', '달톤', '비포밀', '애프터', '백미']\n",
      "Exclusive keywords for B002-C003-0004: ['단백질', '분리', '유청', '웨이', '우유', '산양', '초코', '가수분해', '아미노산', '카제인']\n",
      "Exclusive keywords for B002-C003-0005: ['농축액', '면역', '추출', '홍삼', '앰플형', '캔디', '세용', '양갱', '로스팅', '도시락']\n",
      "Exclusive keywords for B002-C003-0036: ['사항', '산화제', '렌즈', '인식', '촬영', '전송', '자식', '틸트', '웨일', '딥블루']\n",
      "Exclusive keywords for B002-C003-0025: ['엠보싱', '계정수', '보습', '플레인', '휴대', '무자', '자연', '분해', '혼합', '물티슈']\n",
      "Exclusive keywords for B002-C003-0011: ['봉지', '재사용', '실리카겔', '염화칼슘', '연극', '습제']\n",
      "Exclusive keywords for B002-C003-0016: ['조리기구', '야채', '자몽', '식기', '허브', '베리', '주방', '타블렛', '포츠', '팰리세이드']\n",
      "Exclusive keywords for B002-C003-0010: []\n",
      "Exclusive keywords for B002-C003-0052: ['합성', '주스', '향료', '과자', '유기농', '유기', '가공', '첨가', '티백', '감미료']\n",
      "Exclusive keywords for B002-C003-0053: ['유발', '성분', '쇠고기', '냉장', '반찬', '닭고기', '진밥', '소스', '퓨레', '조개류']\n",
      "Exclusive keywords for B002-C003-0002: ['요오드', '크롬', '츄어블', '몰리브덴', '시니어', '컴플렉스', '스프', '우먼', '플래티넘', '아스코르빈산']\n",
      "Exclusive keywords for B002-C003-0022: ['질환', '구강', '청결', '치주염', '치석', '형성', '억제', '화학', '무사', '카린']\n",
      "Exclusive keywords for B002-C003-0015: ['탁용', '중성세제', '실내', '밀대', '체리', '블라썸', '반도체', '미드나잇', '매입']\n",
      "Exclusive keywords for B002-C003-0008: ['에이프릴', '페어', '마린', '초특']\n",
      "Exclusive keywords for B002-C003-0018: []\n",
      "Exclusive keywords for B002-C003-0035: ['샴푸', '두피', '산성', '탈모', '비듬', '퍼퓸', '청량감', '새치', '드라이', '보색']\n",
      "Exclusive keywords for B002-C003-0037: []\n",
      "Exclusive keywords for B002-C003-0045: ['손톱', '모공각화증', '이스', '안개']\n",
      "Exclusive keywords for B002-C003-0046: ['무설', '페이트', '탑투토', '티어', '클렌저']\n",
      "Exclusive keywords for B002-C003-0040: ['케라틴', '살롱', '아미', '시브', '스페셜', '아르', '인스턴트', '미라클']\n",
      "Exclusive keywords for B002-C003-0047: ['선크림', '무기', '보정', '워셔블', '팩트']\n",
      "Exclusive keywords for B002-C003-0014: []\n",
      "Exclusive keywords for B002-C003-0023: ['미세', '크로스', '세모', '초소', '친환경', '민물', '치석제거', '어금니', '세계', '배스']\n",
      "Exclusive keywords for B002-C003-0021: ['치실', '개별', '포장', '유향']\n",
      "Exclusive keywords for B002-C003-0020: ['음파', '화이트', '인용', '생활', '블루투스', '센서', '사용', '볼트', '시간', '양치']\n",
      "Exclusive keywords for B002-C003-0039: ['고정력', '왁스', '경보', '유광', '범용', '포커', '퍼펙팅', '포즈', '쥬카', '메이크']\n",
      "Exclusive keywords for B002-C003-0013: ['발포']\n",
      "Exclusive keywords for B002-C003-0017: ['버블']\n",
      "Exclusive keywords for B002-C003-0024: ['두루', '마리', '데코', '화장지', '픽셀', '자판', '점보롤', '러블리']\n",
      "Exclusive keywords for B002-C003-0026: ['티슈', '미용', '서피스', '정사각형', '펜티엄', '마우스', '지원', '윈도', '인텔', '커넥트']\n",
      "Exclusive keywords for B002-C003-0029: ['타월', '키친', '박스', '치킨', '와이퍼', '위생', '행주', '푸드', '서비스']\n",
      "Exclusive keywords for B002-C003-0048: ['세탁', '섬유', '유연제', '표백제', '중금속', '프리지어']\n",
      "Exclusive keywords for B002-C003-0006: ['원형', '클립', '비치', '풍구', '종이', '석고']\n",
      "Exclusive keywords for B002-C003-0012: ['크리', '곰팡이', '기름']\n",
      "Exclusive keywords for B002-C003-0049: ['손가락', '도회', '전모', '사과', '로고', '라운드', '밴딩', '시기', '헬로', '단모']\n",
      "Exclusive keywords for B002-C003-0028: ['성용', '패드', '요실금', '매트', '소변', '시선', '깔개', '사각형', '단면', '순환']\n",
      "Exclusive keywords for B002-C003-0044: ['빨대', '이탄', '유아식', '스카프', '양손잡이', '이유식', '머그', '보온', '보냉', '스냅']\n",
      "Exclusive keywords for B002-C003-0027: ['날개', '일자', '오버', '나이트', '팬티라이너', '삽입', '레귤러', '팩입', '체험']\n",
      "Exclusive keywords for B002-C003-0041: ['공용', '팬티', '오줌', '기성', '처리', '테이프', '밴드', '대형', '특대', '선택']\n",
      "Exclusive keywords for B002-C003-0030: ['교체', '백화점', '면도칼', '현대', '다리', '갤러리아', '타임', '월드', '테크']\n",
      "Exclusive keywords for B002-C003-0042: ['소독기']\n",
      "Exclusive keywords for B002-C003-0009: ['회용', '부직포', '폴리프로필렌', '셀룰로오스', '아크릴', '수세미', '기념품', '제작', '제조', '공장']\n",
      "Exclusive keywords for B002-C003-0033: ['헤드', '기본', '구성', '트리', '가능', '면도', '밀착', '전체', '정밀', '표시']\n",
      "Exclusive keywords for B002-C003-0043: ['젖병', '소재', '배앓이', '전자레인지', '와이드', '열탕', '유선형', '몸체', '모유', '실감']\n",
      "Exclusive keywords for B002-C003-0007: ['좀벌레', '퇴치', '내용', '목재', '캅셀']\n",
      "Exclusive keywords for B002-C003-0050: ['가성', '사료']\n",
      "Exclusive keywords for B002-C003-0031: ['이빙', '스포츠']\n",
      "Exclusive keywords for B002-C003-0051: ['분유', '성장', '기용', '조제', '타우린', '발달', '두뇌', '소화', '촉진', '프로바이오틱스']\n"
     ]
    }
   ],
   "source": [
    "exclusive_keywords = extract_exclusive_keywords(merged, '소분류')\n",
    "for category, keywords in exclusive_keywords.items():\n",
    "    print(f\"Exclusive keywords for {category}: {keywords}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 224,
   "id": "52a85b62",
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "from collections import Counter\n",
    "\n",
    "def extract_keywords(df, category_column, category_value):\n",
    "    \"\"\"\n",
    "    Extracts and returns the most common keywords for a given category.\n",
    "    \"\"\"\n",
    "    # Filter the DataFrame for the given category\n",
    "    filtered_df = df[df[category_column] == category_value]\n",
    "    \n",
    "    # Assuming 'tokenized_제품특성_cleaned' contains a list of tokens\n",
    "    all_tokens = sum(filtered_df['tokenized_제품특성_cleaned'], [])\n",
    "    token_counts = Counter(all_tokens)\n",
    "    \n",
    "    # Return the most common 30 tokens\n",
    "    return token_counts.most_common(30)\n",
    "\n",
    "# Example usage:\n",
    "# Assuming 'merged' is your DataFrame and '대분류' is the column of interest.\n",
    "# Extract keywords for each unique '소분류' value in the DataFrame\n",
    "unique_subcategories = merged['소분류'].unique()\n",
    "\n",
    "# Initialize an empty dictionary to store keywords by '소분류'\n",
    "keywords_by_subcategory = {}\n",
    "\n",
    "# Extract keywords for each '소분류'\n",
    "for subcategory in unique_subcategories:\n",
    "    keywords = extract_keywords(merged, '소분류', subcategory)\n",
    "    keywords_by_subcategory[subcategory] = [keyword[0] for keyword in keywords]\n",
    "\n",
    "# Convert the dictionary to a DataFrame for visualization\n",
    "keywords_df = pd.DataFrame(list(keywords_by_subcategory.items()), columns=['소분류', 'Keywords'])\n",
    "\n",
    "# Display the DataFrame\n",
    "keywords_df_sort = keywords_df.sort_values('소분류')\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 232,
   "id": "533ccb67",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "소분류: B002-C003-0001\n",
      "Keywords: ['성인', '남녀', '하루', '식품', '개월', '비타민', '체지방', '분말', '일반', '건강', '어류', '캡슐', '단백질', '바로', '해당', '피부', '식이섬유', '구미', '분리', '유청', '기능', '비오틴', '동물성', '개입', '셀레늄', '스푼', '개인', '판토텐산', '농축', '초코']\n",
      "\n",
      "소분류: B002-C003-0002\n",
      "Keywords: ['성인', '하루', '남녀', '개월', '영양', '보충', '캡슐', '비타민', '유아', '요오드', '크롬', '망간', '관절', '셀레늄', '츄어블', '구미', '비오틴', '분말', '바로', '여성', '아연', '건강', '남성', '임산부', '항산화', '몰리브덴', '면역', '식품', '개입', '기능']\n",
      "\n",
      "소분류: B002-C003-0003\n",
      "Keywords: ['캡슐', '하루', '성인', '남녀', '개월', '건강', '비타민', '분말', '바로', '개선', '혈행', '유아', '해당', '셀레늄', '관절', '아연', '식품', '영양', '보충', '동물성', '여성', '식물성', '일반', '임산부', '기능', '항산화', '망간', '단백질', '츄어블', '마그네슘']\n",
      "\n",
      "소분류: B002-C003-0004\n",
      "Keywords: ['단백질', '성인', '남녀', '분리', '유청', '하루', '동물성', '스푼', '웨이', '농축', '개인', '우유', '바로', '산양', '보충', '영양', '초코', '비타민', '아르기닌', '가수분해', '식물성', '딸기', '아미노산', '곡물', '해당', '개월', '분말', '개입', '식이섬유', '카제인']\n",
      "\n",
      "소분류: B002-C003-0005\n",
      "Keywords: ['바로', '성인', '남녀', '식품', '하루', '건강', '기능', '농축액', '스틱', '개월', '면역', '해당', '파우치', '개입', '유아', '스푼', '캡슐', '일반', '여성', '아연', '개인', '추출', '피로', '회복', '뚜껑', '홍삼', '비타민', '단백질', '관절', '앰플형']\n",
      "\n",
      "소분류: B002-C003-0006\n",
      "Keywords: ['액체', '원형', '스틱', '체형', '클립', '리필', '비치', '풍구', '겔형', '세대', '바이', '종이', '석고']\n",
      "\n",
      "소분류: B002-C003-0007\n",
      "Keywords: ['램프', '체형', '좀벌레', '퇴치', '식이섬유', '용기', '개월', '하루', '스푼', '파우치', '개입', '내용', '어댑터', '걸이', '목재', '단백질', '캅셀', '캡슐', '가공', '소금', '면역', '실내', '휴대', '페이스', '피부', '커버', '자외선', '차단', '리필']\n",
      "\n",
      "소분류: B002-C003-0008\n",
      "Keywords: ['피부', '일반', '파라', '튜브', '크림', '리필', '펌프', '스프레이', '영양', '공급', '흡수', '무미', '플라스틱', '세트', '성용', '우디', '에이프릴', '코튼', '핸드', '발림', '퍼퓸', '남성', '페어', '마린', '초특', '상형', '가루', '구연산', '기타', '뚜껑']\n",
      "\n",
      "소분류: B002-C003-0009\n",
      "Keywords: ['회용', '일회용', '부직포', '개입', '폴리프로필렌', '스테인리스', '스틸', '기타', '셀룰로오스', '폴리에스테르', '아크릴', '박스', '옥수수', '수세미', '기념품', '제작', '인쇄', '제조', '공장', '목적', '청수', '세미', '삼베', '친환경', '거품', '코코넛', '껍질', '양면', '스펀지', '개월']\n",
      "\n",
      "소분류: B002-C003-0010\n",
      "Keywords: ['키친', '타월']\n",
      "\n",
      "소분류: B002-C003-0011\n",
      "Keywords: ['일회용', '봉지', '용기', '걸이', '재사용', '실리카겔', '염화칼슘', '개입', '부직포', '세트', '연극', '스탠드', '습제']\n",
      "\n",
      "소분류: B002-C003-0012\n",
      "Keywords: ['스프레이', '크리', '리필', '정제', '상형', '가루', '세트', '곰팡이', '기름']\n",
      "\n",
      "소분류: B002-C003-0013\n",
      "Keywords: ['상형', '정제', '개입', '조리기구', '리필', '스프레이', '시트', '세트', '브러쉬', '함유', '핸들', '포함', '클리', '발포']\n",
      "\n",
      "소분류: B002-C003-0014\n",
      "Keywords: ['일반', '리필', '무미', '플라스틱', '파라', '무방', '부제', '상형', '색소', '백제', '무형', '광증', '드럼', '세탁', '겸용', '농축', '피부', '날개', '자극', '인산염', '정력', '바디', '초고', '섬유', '유연제', '엠보싱', '항균', '캡슐', '정전기', '방지']\n",
      "\n",
      "소분류: B002-C003-0015\n",
      "Keywords: ['상형', '일반', '리필', '탁용', '캡슐', '가루', '드럼', '개입', '농축', '백제', '일반세', '시트', '효과', '파라', '향균', '무형', '광증', '용량', '중성세제', '실내', '건조', '정제', '인산염', '세제', '무표', '스프레이', '무방', '부제', '세탁', '세트']\n",
      "\n",
      "소분류: B002-C003-0016\n",
      "Keywords: ['상형', '조리기구', '리필', '야채', '향균', '효과', '레몬', '정제', '자몽', '인산염', '무방', '부제', '가루', '파라', '식기', '용량', '과일', '피부', '허브', '백제', '스프레이', '개입', '베리', '농축', '무형', '광증', '주방', '세제', '뚜껑', '중성세제']\n",
      "\n",
      "소분류: B002-C003-0017\n",
      "Keywords: ['상형', '가루', '스프레이', '개입', '베이', '킹소', '산소', '조리기구', '리필', '일반', '용량', '함유', '정제', '레몬', '야채', '이상', '시트', '일회용', '자몽', '세탁', '버블', '워시', '드럼', '탁용', '미백', '실내', '건조', '무미', '플라스틱', '파라']\n",
      "\n",
      "소분류: B002-C003-0018\n",
      "Keywords: ['일반', '상형', '가루', '리필', '산소', '무형', '광증', '백제', '시트', '브릭', '화이트', '구연산', '베이', '킹소', '파워', '액션', '드럼', '탁용', '향균', '효과', '친환경', '농축', '세탁', '표백제']\n",
      "\n",
      "소분류: B002-C003-0019\n",
      "Keywords: ['용기', '예방', '제거', '질환', '세균', '트리클로산', '색소', '스틱', '구강', '구취', '알코올', '청결', '스프레이', '광물', '오일', '일반', '충치', '프라그', '무형', '불소', '치석', '형성', '억제', '과일', '치주염', '무사', '카린', '화학', '계면활성제', '플라스틱']\n",
      "\n",
      "소분류: B002-C003-0020\n",
      "Keywords: ['음파', '화이트', '방수', '충전', '단계', '인용', '일반세', '생활', '블루투스', '센서', '칫솔', '사용', '프리', '볼트', '기본', '구성', '잇몸', '시간', '양치', '일반', '미백', '건전지', '배터리', '본체', '치아', '압력', '마사지', '스탠드', '알림', '블랙']\n",
      "\n",
      "소분류: B002-C003-0021\n",
      "Keywords: ['치실', '플라스틱', '무향', '기타', '칫솔', '개별', '포장', '개입', '교정', '유향', '자형', '손잡이', '일반', '왁스', '코팅', '미세', '건전지', '실리콘', '스펀지', '대나무', '시스테마', '음파', '구강', '청결', '스마일', '휴대', '케이스', '화이트', '옥수수', '유아']\n",
      "\n",
      "소분류: B002-C003-0022\n",
      "Keywords: ['일반', '예방', '제거', '질환', '프라그', '구강', '청결', '치주염', '치석', '형성', '억제', '계면활성제', '충치', '화학', '세균', '구취', '파라', '개선', '체형', '잇몸', '기타', '무사', '카린', '동물성', '원료', '색소', '불소', '튜브', '트리클로산', '치약']\n",
      "\n",
      "소분류: B002-C003-0023\n",
      "Keywords: ['일반', '미세', '플라스틱', '칫솔', '기타', '항균', '어린이', '단계', '충전', '반모', '크로스', '액션', '인용', '일회용', '방수', '교정', '개입', '소형', '잇몸', '마사지', '일반세', '생활', '예방', '개월', '제거', '미백', '건전지', '세모', '초소', '친환경']\n",
      "\n",
      "소분류: B002-C003-0024\n",
      "Keywords: ['두루', '마리', '엠보싱', '데코', '무형', '무포름', '색소', '키친', '타월', '펄프', '천연', '화장지', '티슈', '파워', '인쇄', '일반', '마이크로', '무향', '플레인', '자극', '픽셀', '날개', '보습', '효과', '볼륨', '소프트', '박스', '자판', '기용', '점보롤']\n",
      "\n",
      "소분류: B002-C003-0025\n",
      "Keywords: ['엠보싱', '계정수', '효과', '보습', '플레인', '자극', '인증', '휴대', '무향', '무자', '파라', '자연', '분해', '혼합', '세트', '리필', '무방', '부제', '알코올', '항균', '물티슈', '무형', '티슈', '무페', '에탄올', '광증', '백제', '남녀', '포름알데히드', '상형']\n",
      "\n",
      "소분류: B002-C003-0026\n",
      "Keywords: ['티슈', '무형', '천연', '펄프', '무포름', '색소', '무향', '인쇄', '두루', '마리', '미용', '엠보싱', '키친', '타월', '데코', '여행', '전용', '개입', '페이스', '시트', '케어', '서피스', '정사각형', '걸이', '플라스틱', '프로', '보습', '소프트', '미니', '일반']\n",
      "\n",
      "소분류: B002-C003-0027\n",
      "Keywords: ['날개', '일자', '오버', '나이트', '팬티라이너', '삽입', '개입', '중형', '특대', '대형', '커버', '소형', '순면', '무표', '레귤러', '팩입', '체험', '세트', '남녀', '공용']\n",
      "\n",
      "소분류: B002-C003-0028\n",
      "Keywords: ['남녀', '공용', '팬티', '방지', '성용', '일자', '패드', '요실금', '남성', '매트', '밴드', '소변', '시선', '교환', '깔개', '사각형', '단면', '방수', '순환', '엠보싱', '기타', '브라운', '인용', '센서', '다이얼', '자연', '자극', '다용', '오픈', '팬티라이너']\n",
      "\n",
      "소분류: B002-C003-0029\n",
      "Keywords: ['타월', '키친', '천연', '펄프', '무형', '박스', '엠보싱', '파워', '색소', '인쇄', '일회용', '두루', '마리', '티슈', '데코', '무향', '기타', '보습', '효과', '혼합', '세트', '무페', '에탄올', '일반', '밴드', '치킨', '자극', '접이식', '무포름', '개입']\n",
      "\n",
      "소분류: B002-C003-0030\n",
      "Keywords: ['교체', '중날', '일회용', '면도날', '면도기', '윤활', '밴드', '트리', '백화점', '헤드', '세트', '면도칼', '모기', '페이스', '현대', '롯데', '레이저', '피부', '펌프', '모션', '세라믹', '방수', '리튬이온', '배터리', '빗살캡', '메뉴얼', '수동식', '자동', '정밀', '코털']\n",
      "\n",
      "소분류: B002-C003-0031\n",
      "Keywords: ['페이스', '피부', '이빙', '자극', '펌프', '크림', '튜브', '세트', '흡수', '클렌징폼', '스포츠', '중날', '교체', '터치', '민감', '뚜껑', '파우치', '액티브', '퓨어', '클렌', '비누']\n",
      "\n",
      "소분류: B002-C003-0032\n",
      "Keywords: ['펌프', '피부', '스프레이', '거품', '과일', '공급', '워시', '항균', '영양', '핸드', '파우치', '기타', '튜브', '리미티드에디션', '리필', '정력', '흡수', '베이비', '파우더', '발림', '유아', '버튼', '수분', '무향', '로럴', '겸용', '케어', '손소독제', '머스크', '한국']\n",
      "\n",
      "소분류: B002-C003-0033\n",
      "Keywords: ['헤드', '기본', '구성', '트리', '가능', '충전', '중날', '방수', '면도', '배터리', '밀착', '전체', '정밀', '단계', '표시', '방향', '무빙', '세척', '코털', '구레나룻', '티타늄', '코팅', '어댑터', '스탠드', '면도날', '보호', '교체', '리튬이온', '청소', '고정']\n",
      "\n",
      "소분류: B002-C003-0034\n",
      "Keywords: ['피부', '튜브', '펌프', '흡수', '기타', '공급', '영양', '자극', '뚜껑', '바디', '케어', '각질', '발림', '무향', '탄력', '겸용', '로럴', '정력', '크림', '클렌', '과일', '윤기', '부여', '페이스', '로션', '터치', '어린이', '핸드', '세트', '머스크']\n",
      "\n",
      "소분류: B002-C003-0035\n",
      "Keywords: ['샴푸', '펌프', '일반', '두피', '케어', '모든', '모발', '영양', '산성', '정력', '탈모', '각질', '비듬', '자극', '트리트먼트', '공급', '퀴드', '로럴', '머릿결', '개선', '손상', '린스', '수분', '퍼퓸', '제거', '기타', '실리콘', '윤기', '헤어', '피부']\n",
      "\n",
      "소분류: B002-C003-0036\n",
      "Keywords: ['모든', '윤기', '부여', '크림', '자극', '염색', '파우더', '모발', '로션', '비건', '한국', '인증', '샴푸', '영양', '손상', '브러쉬', '스틱', '민감', '퀴드', '쿠션', '공급', '해당', '사항', '펌프', '머릿결', '개선', '컬러', '산화제', '일반', '렌즈']\n",
      "\n",
      "소분류: B002-C003-0037\n",
      "Keywords: ['모든', '펌프', '영양', '윤기', '부여', '샴푸', '공급', '모발', '머릿결', '개선', '일반', '린스', '두피', '퀴드', '손상', '케어', '크림', '수분', '로럴', '정력', '강화', '퍼퓸', '각질', '자극', '탈모', '오일', '피케', '트리트먼트', '피부', '비듬']\n",
      "\n",
      "소분류: B002-C003-0038\n",
      "Keywords: ['모든', '영양', '공급', '윤기', '부여', '흡수', '오일', '머릿결', '개선', '펌프', '두피', '손상', '스프레이', '헤어', '샴푸', '크림', '케어', '모발', '퀴드', '피케', '에센스', '일반', '피부', '로션', '수분', '염색', '탈모', '자극', '각질', '페이스']\n",
      "\n",
      "소분류: B002-C003-0039\n",
      "Keywords: ['고정력', '모든', '스프레이', '효과', '크림', '볼륨', '분사', '왁스', '펌프', '영양', '공급', '페이스', '윤기', '부여', '머릿결', '개선', '퀴드', '로션', '샴푸', '피부', '일반', '무스', '모발', '두피', '자극', '헤어', '오일', '세트', '웨이브', '케어']\n",
      "\n",
      "소분류: B002-C003-0040\n",
      "Keywords: ['모든', '영양', '윤기', '부여', '모발', '공급', '머릿결', '개선', '펌프', '손상', '트리트먼트', '크림', '두피', '강화', '헤어', '샴푸', '염색', '케어', '수분', '로션', '퀴드', '탈모', '페이스', '일반', '스프레이', '웨이브', '흡수', '에센스', '각질', '단백질']\n",
      "\n",
      "소분류: B002-C003-0041\n",
      "Keywords: ['단계', '공용', '남녀', '방지', '팬티', '오줌', '기성', '처리', '테이프', '밴드', '대형', '엠보싱', '시트', '특대', '선택', '터치', '점보', '중형', '소형', '세트', '피부', '특점보형', '일자', '케어', '신생아', '페이스', '헤어', '에센스', '로션', '폴리에스테르']\n",
      "\n",
      "소분류: B002-C003-0042\n",
      "Keywords: ['상형', '자외선', '기능', '젖병', '가정', '멸균', '보관', '무형', '광증', '백제', '스팀', '휴대', '색소', '살균', '자극', '거품', '주방', '세제', '건조', '일체', '소독기', '리필', '무방', '부제', '항균', '빨대', '실리콘', '세대', '플러스', '드럼']\n",
      "\n",
      "소분류: B002-C003-0043\n",
      "Keywords: ['실리콘', '비스페놀', '젖병', '소재', '방지', '신생아', '단계', '배앓이', '전자레인지', '일반', '와이드', '열탕', '유선형', '몸체', '모유', '실감', '기타', '개월', '꼭지', '유리', '자형', '유축기', '세트', '스탠드', '온도', '감지', '수유', '쿠션', '소품', '노리개']\n",
      "\n",
      "소분류: B002-C003-0044\n",
      "Keywords: ['빨대', '방지', '실리콘', '비스페놀', '베이비', '세트', '이탄', '스테인리스', '스틸', '회용', '유아식', '스카프', '양손잡이', '이유식', '보관', '용기', '사용', '일반', '스푼', '머그', '흡착', '전자레인지', '유아', '미끄럼', '방수', '가능', '보온', '보냉', '스냅', '단추']\n",
      "\n",
      "소분류: B002-C003-0045\n",
      "Keywords: ['자극', '피부', '공급', '튜브', '세트', '장벽', '강화', '펌프', '수분', '영양', '무향', '페이스', '용기', '유아', '오일', '프리', '스틱', '크림', '바디', '무벤조페논', '진정', '흡수', '케어', '파라', '무인', '향료', '무설', '페이트', '로션', '보호']\n",
      "\n",
      "소분류: B002-C003-0046\n",
      "Keywords: ['펌프', '유아', '바디', '자극', '공급', '피부', '수분', '세트', '워시', '장벽', '강화', '샴푸', '영양', '튜브', '무설', '페이트', '무벤조페논', '무향', '진정', '정력', '케어', '페이스', '두피', '기타', '일반', '노폐물', '파라', '민감', '산성', '유연']\n",
      "\n",
      "소분류: B002-C003-0047\n",
      "Keywords: ['유아', '선크림', '자극', '공급', '피부', '스틱', '수분', '튜브', '영양', '페이스', '진정', '쿠션', '세트', '콤팩트', '무벤조페논', '로션', '오일', '프리', '무향', '무기', '장벽', '강화', '현상', '방지', '리필', '밀착', '어린이', '겸용', '쿨링감', '보정']\n",
      "\n",
      "소분류: B002-C003-0048\n",
      "Keywords: ['상형', '세탁', '겸용', '드럼', '자극', '무미', '플라스틱', '피부', '농축', '항균', '파라', '효과', '유아', '일반', '백제', '가루', '무형', '광증', '리필', '섬유', '유연제', '거품', '표백제', '중성', '색소', '얼룩', '거제', '중금속', '인산염', '스프레이']\n",
      "\n",
      "소분류: B002-C003-0049\n",
      "Keywords: ['단계', '칫솔', '일반', '개월', '튜브', '어린이', '기타', '유아', '딸기', '제거', '예방', '트리클로산', '미세', '충치', '프라그', '미백', '건전지', '파라', '항균', '방지', '플라스틱', '실리콘', '신생아', '불소', '잇몸', '기본', '폴리에스테르', '마사지', '민트', '손가락']\n",
      "\n",
      "소분류: B002-C003-0050\n",
      "Keywords: ['피부', '공급', '콤팩트', '튜브', '자극', '용기', '수분', '장벽', '강화', '영양', '진정', '세트', '탈크', '오일', '프리', '보호', '기타', '무향', '파라', '가성', '쿠션', '무인', '향료', '분말', '바로', '과일', '항산화', '히알루론산', '사료', '스틱']\n",
      "\n",
      "소분류: B002-C003-0051\n",
      "Keywords: ['단계', '분말', '분유', '성장', '개월', '일반', '기용', '조제', '신생아', '타우린', '강화', '스틱', '발달', '두뇌', '면역', '소화', '촉진', '프로바이오틱스', '인증', '기타', '칼슘', '유기농', '첫돌', '발육', '설사', '개선', '산양', '미숙아', '시력', '루테']\n",
      "\n",
      "소분류: B002-C003-0052\n",
      "Keywords: ['기타', '아기', '인증', '합성', '주스', '파우치', '향료', '과자', '유기농', '개월', '유기', '가공', '식품', '단계', '첨가', '티백', '감미료', '칼슘', '대두', '착색', '보관', '우유', '함유', '타입', '강화', '실온', '어린이', '기호식품', '개입', '소금']\n",
      "\n",
      "소분류: B002-C003-0053\n",
      "Keywords: ['기타', '개월', '단계', '파우치', '아기', '보관', '유발', '성분', '쇠고기', '냉장', '반찬', '대두', '실온', '닭고기', '진밥', '소스', '퓨레', '개입', '우유', '가루', '조개류', '간장', '냉동', '세트', '합성', '향료', '오징어', '돼지고기', '과자', '구미']\n",
      "\n"
     ]
    }
   ],
   "source": [
    "for index, row in keywords_df_sort.iterrows():\n",
    "    print(f\"소분류: {row['소분류']}\")\n",
    "    print(f\"Keywords: {row['Keywords']}\\n\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "85c87079",
   "metadata": {},
   "source": [
    "# 아래 딕셔너리 실행하시고 아래 함수 사용하시면 이름으로 대체되고\n",
    "# 이어서 원-핫 인코딩도 해놨습니다."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 315,
   "id": "20aa2d84",
   "metadata": {},
   "outputs": [],
   "source": [
    "major_category = {'B002-C001-0001': '건강식품', \n",
    "                  'B002-C001-0002':'생활용품/뷰티', \n",
    "                  'B002-C001-0003':'출산/유아동', \n",
    "                  'B002-C001-0004':\"유아 선크림\", \n",
    "                  'B002-C001-0005':'식품'}\n",
    "sub_category = {\n",
    "    'B002-C002-0001': '성인',\n",
    "    'B002-C002-0002': '용기/봉지',\n",
    "    'B002-C002-0003': '주방/세탁용품',\n",
    "    'B002-C002-0004': '구강용품',\n",
    "    'B002-C002-0005': '휴지/티슈/생리대',\n",
    "    'B002-C002-0006': '스킨케어',\n",
    "    'B002-C002-0007': '헤어케어',\n",
    "    'B002-C002-0008': '젖병/빨대',\n",
    "    'B002-C002-0009': '영유아',\n",
    "    'B002-C002-0010': '기저귀/크림',\n",
    "    'B002-C002-0011': '어린이식품'\n",
    "}\n",
    "minor_category = {\n",
    "    'B002-C003-0001': '다이어트 보조식품',\n",
    "    'B002-C003-0002': '성인용 영양제',\n",
    "    'B002-C003-0003': '남성용 영양제',\n",
    "    'B002-C003-0004': '단백질 보충제',\n",
    "    'B002-C003-0005': '면역력 강화 영양제',\n",
    "    'B002-C003-0006': '공기 청정 및 방향제',\n",
    "    'B002-C003-0007': '해충 방지',\n",
    "    'B002-C003-0008': '스킨 케어',\n",
    "    'B002-C003-0009': '청소 용품',\n",
    "    'B002-C003-0010': '키친 타월',\n",
    "    'B002-C003-0011': '습기 제거',\n",
    "    'B002-C003-0012': '곰팡이 제거',\n",
    "    'B002-C003-0013': '주방 청소 용품',\n",
    "    'B002-C003-0014': '세탁 용품',\n",
    "    'B002-C003-0015': '세탁 기타',\n",
    "    'B002-C003-0016': '주방 세제',\n",
    "    'B002-C003-0017': '다목적 발포 세정제',\n",
    "    'B002-C003-0018': '표백 및 세탁 보조제',\n",
    "    'B002-C003-0019': '구강 위생용품',\n",
    "    'B002-C003-0020': '전동 칫솔',\n",
    "    'B002-C003-0021': '치간칫솔 및 치실',\n",
    "    'B002-C003-0022': '구강 건강 및 구취 관리',\n",
    "    'B002-C003-0023': '칫솔',\n",
    "    'B002-C003-0024': '두루마리 화장지',\n",
    "    'B002-C003-0025': '물티슈',\n",
    "    'B002-C003-0026': '티슈',\n",
    "    'B002-C003-0027': '여성 위생 용품',\n",
    "    'B002-C003-0028': '성인용 기저귀',\n",
    "    'B002-C003-0029': '키친타월',\n",
    "    'B002-C003-0030': '면도기 및 액세서리',\n",
    "    'B002-C003-0031': '남성 쉐이빙 케어',\n",
    "    'B002-C003-0032': '핸드워시',\n",
    "    'B002-C003-0033': '전기 면도기',\n",
    "    'B002-C003-0034': '민감 스킨 케어',\n",
    "    'B002-C003-0035': '탈모 방지 샴푸',\n",
    "    'B002-C003-0036': '저자극 샴푸',\n",
    "    'B002-C003-0037': '일반 샴푸',\n",
    "    'B002-C003-0038': '손상 모발용 샴푸',\n",
    "    'B002-C003-0039': '헤어 스프레이',\n",
    "    'B002-C003-0040': '윤기부여 샴푸',\n",
    "    'B002-C003-0041': '유아용 기저귀',\n",
    "    'B002-C003-0042': '젖병 소독기',\n",
    "    'B002-C003-0043': '신생아 젖병',\n",
    "    'B002-C003-0044': '빨대형 젖병',\n",
    "    'B002-C003-0045': '유아용 스킨케어',\n",
    "    'B002-C003-0046': '유아 목욕용품',\n",
    "    'B002-C003-0047': '유아용 선크림',\n",
    "    'B002-C003-0048': '유아용 세탁 & 섬유 유연제',\n",
    "    'B002-C003-0049': '유아용 칫솔',\n",
    "    'B002-C003-0050': '유아 선크림 및 스킨케어',\n",
    "    'B002-C003-0051': '분유',\n",
    "    'B002-C003-0052': '유아용 간식',\n",
    "    'B002-C003-0053': '유아용 식품 및 간식'\n",
    "}\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 309,
   "id": "c95136bb",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>제품</th>\n",
       "      <th>대분류</th>\n",
       "      <th>중분류</th>\n",
       "      <th>소분류</th>\n",
       "      <th>브랜드</th>\n",
       "      <th>2022-01-01</th>\n",
       "      <th>2022-01-02</th>\n",
       "      <th>2022-01-03</th>\n",
       "      <th>2022-01-04</th>\n",
       "      <th>...</th>\n",
       "      <th>2023-03-26</th>\n",
       "      <th>2023-03-27</th>\n",
       "      <th>2023-03-28</th>\n",
       "      <th>2023-03-29</th>\n",
       "      <th>2023-03-30</th>\n",
       "      <th>2023-03-31</th>\n",
       "      <th>2023-04-01</th>\n",
       "      <th>2023-04-02</th>\n",
       "      <th>2023-04-03</th>\n",
       "      <th>2023-04-04</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>B002-00001-00001</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0007</td>\n",
       "      <td>B002-C003-0038</td>\n",
       "      <td>B002-00001</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>B002-00002-00001</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-00002</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>B002-00002-00002</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-00002</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>B002-00002-00003</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-00002</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>B002-00003-00001</td>\n",
       "      <td>B002-C001-0001</td>\n",
       "      <td>B002-C002-0001</td>\n",
       "      <td>B002-C003-0003</td>\n",
       "      <td>B002-00003</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15885</th>\n",
       "      <td>15885</td>\n",
       "      <td>B002-03799-00002</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0042</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15886</th>\n",
       "      <td>15886</td>\n",
       "      <td>B002-03799-00003</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15887</th>\n",
       "      <td>15887</td>\n",
       "      <td>B002-03799-00004</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15888</th>\n",
       "      <td>15888</td>\n",
       "      <td>B002-03799-00005</td>\n",
       "      <td>B002-C001-0003</td>\n",
       "      <td>B002-C002-0008</td>\n",
       "      <td>B002-C003-0044</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15889</th>\n",
       "      <td>15889</td>\n",
       "      <td>B002-03799-00010</td>\n",
       "      <td>B002-C001-0002</td>\n",
       "      <td>B002-C002-0004</td>\n",
       "      <td>B002-C003-0020</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>15890 rows × 465 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          ID                제품             대분류             중분류  \\\n",
       "0          0  B002-00001-00001  B002-C001-0002  B002-C002-0007   \n",
       "1          1  B002-00002-00001  B002-C001-0003  B002-C002-0008   \n",
       "2          2  B002-00002-00002  B002-C001-0003  B002-C002-0008   \n",
       "3          3  B002-00002-00003  B002-C001-0003  B002-C002-0008   \n",
       "4          4  B002-00003-00001  B002-C001-0001  B002-C002-0001   \n",
       "...      ...               ...             ...             ...   \n",
       "15885  15885  B002-03799-00002  B002-C001-0003  B002-C002-0008   \n",
       "15886  15886  B002-03799-00003  B002-C001-0003  B002-C002-0008   \n",
       "15887  15887  B002-03799-00004  B002-C001-0003  B002-C002-0008   \n",
       "15888  15888  B002-03799-00005  B002-C001-0003  B002-C002-0008   \n",
       "15889  15889  B002-03799-00010  B002-C001-0002  B002-C002-0004   \n",
       "\n",
       "                  소분류         브랜드  2022-01-01  2022-01-02  2022-01-03  \\\n",
       "0      B002-C003-0038  B002-00001           0           0           0   \n",
       "1      B002-C003-0044  B002-00002           0           0           0   \n",
       "2      B002-C003-0044  B002-00002           0           0           0   \n",
       "3      B002-C003-0044  B002-00002           0           0           0   \n",
       "4      B002-C003-0003  B002-00003           0           0           0   \n",
       "...               ...         ...         ...         ...         ...   \n",
       "15885  B002-C003-0042  B002-03799           0           0           0   \n",
       "15886  B002-C003-0044  B002-03799           0           0           0   \n",
       "15887  B002-C003-0044  B002-03799           0           0           0   \n",
       "15888  B002-C003-0044  B002-03799           0           0           0   \n",
       "15889  B002-C003-0020  B002-03799           0           0           0   \n",
       "\n",
       "       2022-01-04  ...  2023-03-26  2023-03-27  2023-03-28  2023-03-29  \\\n",
       "0               0  ...           0           0           0           0   \n",
       "1               0  ...           0           0           0           1   \n",
       "2               0  ...           0           0           0           0   \n",
       "3               0  ...           0           0           0           0   \n",
       "4               0  ...           0           0           0           0   \n",
       "...           ...  ...         ...         ...         ...         ...   \n",
       "15885           0  ...           0           0           0           0   \n",
       "15886           0  ...           0           0           0           3   \n",
       "15887           0  ...           0           0           0           0   \n",
       "15888           0  ...           0           0           0           0   \n",
       "15889           0  ...           0           0           0           0   \n",
       "\n",
       "       2023-03-30  2023-03-31  2023-04-01  2023-04-02  2023-04-03  2023-04-04  \n",
       "0               0           0           0           0           0           0  \n",
       "1               3           2           0           0           2           0  \n",
       "2               0           0           0           0           0           0  \n",
       "3               0           0           0           0           0           0  \n",
       "4               0           0           0           0           0           0  \n",
       "...           ...         ...         ...         ...         ...         ...  \n",
       "15885           0           0           0           0           0           0  \n",
       "15886           0           2           4           1           1           3  \n",
       "15887           0           0           0           0           0           0  \n",
       "15888           0           0           0           0           0           2  \n",
       "15889           0           0           0           0           0           0  \n",
       "\n",
       "[15890 rows x 465 columns]"
      ]
     },
     "execution_count": 309,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_data "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 322,
   "id": "8fb07819",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Define functions to map codes to strings\n",
    "def map_values(column, dictionary):\n",
    "    return column.replace(dictionary)\n",
    "\n",
    "# Replace values in each column using the defined dictionaries\n",
    "train_data['대분류'] = map_values(train_data['대분류'], major_category)\n",
    "train_data['중분류'] = map_values(train_data['중분류'], sub_category)\n",
    "train_data['소분류'] = map_values(train_data['소분류'], minor_category)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 323,
   "id": "b3229593",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>제품</th>\n",
       "      <th>대분류</th>\n",
       "      <th>중분류</th>\n",
       "      <th>소분류</th>\n",
       "      <th>브랜드</th>\n",
       "      <th>2022-01-01</th>\n",
       "      <th>2022-01-02</th>\n",
       "      <th>2022-01-03</th>\n",
       "      <th>2022-01-04</th>\n",
       "      <th>...</th>\n",
       "      <th>2023-03-26</th>\n",
       "      <th>2023-03-27</th>\n",
       "      <th>2023-03-28</th>\n",
       "      <th>2023-03-29</th>\n",
       "      <th>2023-03-30</th>\n",
       "      <th>2023-03-31</th>\n",
       "      <th>2023-04-01</th>\n",
       "      <th>2023-04-02</th>\n",
       "      <th>2023-04-03</th>\n",
       "      <th>2023-04-04</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>B002-00001-00001</td>\n",
       "      <td>생활용품/뷰티</td>\n",
       "      <td>헤어케어</td>\n",
       "      <td>손상 모발용 샴푸</td>\n",
       "      <td>B002-00001</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>B002-00002-00001</td>\n",
       "      <td>출산/유아동</td>\n",
       "      <td>젖병/빨대</td>\n",
       "      <td>빨대형 젖병</td>\n",
       "      <td>B002-00002</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>B002-00002-00002</td>\n",
       "      <td>출산/유아동</td>\n",
       "      <td>젖병/빨대</td>\n",
       "      <td>빨대형 젖병</td>\n",
       "      <td>B002-00002</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>B002-00002-00003</td>\n",
       "      <td>출산/유아동</td>\n",
       "      <td>젖병/빨대</td>\n",
       "      <td>빨대형 젖병</td>\n",
       "      <td>B002-00002</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>B002-00003-00001</td>\n",
       "      <td>건강식품</td>\n",
       "      <td>성인</td>\n",
       "      <td>남성용 영양제</td>\n",
       "      <td>B002-00003</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15885</th>\n",
       "      <td>15885</td>\n",
       "      <td>B002-03799-00002</td>\n",
       "      <td>출산/유아동</td>\n",
       "      <td>젖병/빨대</td>\n",
       "      <td>젖병 소독기</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15886</th>\n",
       "      <td>15886</td>\n",
       "      <td>B002-03799-00003</td>\n",
       "      <td>출산/유아동</td>\n",
       "      <td>젖병/빨대</td>\n",
       "      <td>빨대형 젖병</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15887</th>\n",
       "      <td>15887</td>\n",
       "      <td>B002-03799-00004</td>\n",
       "      <td>출산/유아동</td>\n",
       "      <td>젖병/빨대</td>\n",
       "      <td>빨대형 젖병</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15888</th>\n",
       "      <td>15888</td>\n",
       "      <td>B002-03799-00005</td>\n",
       "      <td>출산/유아동</td>\n",
       "      <td>젖병/빨대</td>\n",
       "      <td>빨대형 젖병</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15889</th>\n",
       "      <td>15889</td>\n",
       "      <td>B002-03799-00010</td>\n",
       "      <td>생활용품/뷰티</td>\n",
       "      <td>구강용품</td>\n",
       "      <td>전동 칫솔</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>15890 rows × 465 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          ID                제품      대분류    중분류        소분류         브랜드  \\\n",
       "0          0  B002-00001-00001  생활용품/뷰티   헤어케어  손상 모발용 샴푸  B002-00001   \n",
       "1          1  B002-00002-00001   출산/유아동  젖병/빨대     빨대형 젖병  B002-00002   \n",
       "2          2  B002-00002-00002   출산/유아동  젖병/빨대     빨대형 젖병  B002-00002   \n",
       "3          3  B002-00002-00003   출산/유아동  젖병/빨대     빨대형 젖병  B002-00002   \n",
       "4          4  B002-00003-00001     건강식품     성인    남성용 영양제  B002-00003   \n",
       "...      ...               ...      ...    ...        ...         ...   \n",
       "15885  15885  B002-03799-00002   출산/유아동  젖병/빨대     젖병 소독기  B002-03799   \n",
       "15886  15886  B002-03799-00003   출산/유아동  젖병/빨대     빨대형 젖병  B002-03799   \n",
       "15887  15887  B002-03799-00004   출산/유아동  젖병/빨대     빨대형 젖병  B002-03799   \n",
       "15888  15888  B002-03799-00005   출산/유아동  젖병/빨대     빨대형 젖병  B002-03799   \n",
       "15889  15889  B002-03799-00010  생활용품/뷰티   구강용품      전동 칫솔  B002-03799   \n",
       "\n",
       "       2022-01-01  2022-01-02  2022-01-03  2022-01-04  ...  2023-03-26  \\\n",
       "0               0           0           0           0  ...           0   \n",
       "1               0           0           0           0  ...           0   \n",
       "2               0           0           0           0  ...           0   \n",
       "3               0           0           0           0  ...           0   \n",
       "4               0           0           0           0  ...           0   \n",
       "...           ...         ...         ...         ...  ...         ...   \n",
       "15885           0           0           0           0  ...           0   \n",
       "15886           0           0           0           0  ...           0   \n",
       "15887           0           0           0           0  ...           0   \n",
       "15888           0           0           0           0  ...           0   \n",
       "15889           0           0           0           0  ...           0   \n",
       "\n",
       "       2023-03-27  2023-03-28  2023-03-29  2023-03-30  2023-03-31  2023-04-01  \\\n",
       "0               0           0           0           0           0           0   \n",
       "1               0           0           1           3           2           0   \n",
       "2               0           0           0           0           0           0   \n",
       "3               0           0           0           0           0           0   \n",
       "4               0           0           0           0           0           0   \n",
       "...           ...         ...         ...         ...         ...         ...   \n",
       "15885           0           0           0           0           0           0   \n",
       "15886           0           0           3           0           2           4   \n",
       "15887           0           0           0           0           0           0   \n",
       "15888           0           0           0           0           0           0   \n",
       "15889           0           0           0           0           0           0   \n",
       "\n",
       "       2023-04-02  2023-04-03  2023-04-04  \n",
       "0               0           0           0  \n",
       "1               0           2           0  \n",
       "2               0           0           0  \n",
       "3               0           0           0  \n",
       "4               0           0           0  \n",
       "...           ...         ...         ...  \n",
       "15885           0           0           0  \n",
       "15886           1           1           3  \n",
       "15887           0           0           0  \n",
       "15888           0           0           2  \n",
       "15889           0           0           0  \n",
       "\n",
       "[15890 rows x 465 columns]"
      ]
     },
     "execution_count": 323,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_data #대분류, 중분류, 소분류 코드 대체"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 324,
   "id": "0a3d3f1f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "   ID                제품         브랜드  2022-01-01  2022-01-02  2022-01-03  \\\n",
      "0   0  B002-00001-00001  B002-00001           0           0           0   \n",
      "1   1  B002-00002-00001  B002-00002           0           0           0   \n",
      "2   2  B002-00002-00002  B002-00002           0           0           0   \n",
      "3   3  B002-00002-00003  B002-00002           0           0           0   \n",
      "4   4  B002-00003-00001  B002-00003           0           0           0   \n",
      "\n",
      "   2022-01-04  2022-01-05  2022-01-06  2022-01-07  ...  소분류_치간칫솔 및 치실  소분류_칫솔  \\\n",
      "0           0           0           0           0  ...          False   False   \n",
      "1           0           0           0           0  ...          False   False   \n",
      "2           0           0           0           0  ...          False   False   \n",
      "3           0           0           0           0  ...          False   False   \n",
      "4           0           0           0           0  ...          False   False   \n",
      "\n",
      "   소분류_키친 타월  소분류_키친타월  소분류_탈모 방지 샴푸  소분류_티슈  소분류_표백 및 세탁 보조제  소분류_해충 방지  \\\n",
      "0      False     False         False   False            False      False   \n",
      "1      False     False         False   False            False      False   \n",
      "2      False     False         False   False            False      False   \n",
      "3      False     False         False   False            False      False   \n",
      "4      False     False         False   False            False      False   \n",
      "\n",
      "   소분류_핸드워시  소분류_헤어 스프레이  \n",
      "0     False        False  \n",
      "1     False        False  \n",
      "2     False        False  \n",
      "3     False        False  \n",
      "4     False        False  \n",
      "\n",
      "[5 rows x 531 columns]\n"
     ]
    }
   ],
   "source": [
    "# Perform one-hot encoding on categorical columns\n",
    "train_data = pd.get_dummies(train_data, columns=['대분류', '중분류', '소분류'])\n",
    "\n",
    "# Check the encoded DataFrame\n",
    "print(train_data.head())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 325,
   "id": "02a74d4d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>제품</th>\n",
       "      <th>브랜드</th>\n",
       "      <th>2022-01-01</th>\n",
       "      <th>2022-01-02</th>\n",
       "      <th>2022-01-03</th>\n",
       "      <th>2022-01-04</th>\n",
       "      <th>2022-01-05</th>\n",
       "      <th>2022-01-06</th>\n",
       "      <th>2022-01-07</th>\n",
       "      <th>...</th>\n",
       "      <th>소분류_치간칫솔 및 치실</th>\n",
       "      <th>소분류_칫솔</th>\n",
       "      <th>소분류_키친 타월</th>\n",
       "      <th>소분류_키친타월</th>\n",
       "      <th>소분류_탈모 방지 샴푸</th>\n",
       "      <th>소분류_티슈</th>\n",
       "      <th>소분류_표백 및 세탁 보조제</th>\n",
       "      <th>소분류_해충 방지</th>\n",
       "      <th>소분류_핸드워시</th>\n",
       "      <th>소분류_헤어 스프레이</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>B002-00001-00001</td>\n",
       "      <td>B002-00001</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>B002-00002-00001</td>\n",
       "      <td>B002-00002</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>B002-00002-00002</td>\n",
       "      <td>B002-00002</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>B002-00002-00003</td>\n",
       "      <td>B002-00002</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>B002-00003-00001</td>\n",
       "      <td>B002-00003</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15885</th>\n",
       "      <td>15885</td>\n",
       "      <td>B002-03799-00002</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15886</th>\n",
       "      <td>15886</td>\n",
       "      <td>B002-03799-00003</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15887</th>\n",
       "      <td>15887</td>\n",
       "      <td>B002-03799-00004</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15888</th>\n",
       "      <td>15888</td>\n",
       "      <td>B002-03799-00005</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15889</th>\n",
       "      <td>15889</td>\n",
       "      <td>B002-03799-00010</td>\n",
       "      <td>B002-03799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>15890 rows × 531 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          ID                제품         브랜드  2022-01-01  2022-01-02  \\\n",
       "0          0  B002-00001-00001  B002-00001           0           0   \n",
       "1          1  B002-00002-00001  B002-00002           0           0   \n",
       "2          2  B002-00002-00002  B002-00002           0           0   \n",
       "3          3  B002-00002-00003  B002-00002           0           0   \n",
       "4          4  B002-00003-00001  B002-00003           0           0   \n",
       "...      ...               ...         ...         ...         ...   \n",
       "15885  15885  B002-03799-00002  B002-03799           0           0   \n",
       "15886  15886  B002-03799-00003  B002-03799           0           0   \n",
       "15887  15887  B002-03799-00004  B002-03799           0           0   \n",
       "15888  15888  B002-03799-00005  B002-03799           0           0   \n",
       "15889  15889  B002-03799-00010  B002-03799           0           0   \n",
       "\n",
       "       2022-01-03  2022-01-04  2022-01-05  2022-01-06  2022-01-07  ...  \\\n",
       "0               0           0           0           0           0  ...   \n",
       "1               0           0           0           0           0  ...   \n",
       "2               0           0           0           0           0  ...   \n",
       "3               0           0           0           0           0  ...   \n",
       "4               0           0           0           0           0  ...   \n",
       "...           ...         ...         ...         ...         ...  ...   \n",
       "15885           0           0           0           0           0  ...   \n",
       "15886           0           0           0           0           0  ...   \n",
       "15887           0           0           0           0           0  ...   \n",
       "15888           0           0           0           0           0  ...   \n",
       "15889           0           0           0           0           0  ...   \n",
       "\n",
       "       소분류_치간칫솔 및 치실  소분류_칫솔  소분류_키친 타월  소분류_키친타월  소분류_탈모 방지 샴푸  소분류_티슈  \\\n",
       "0              False   False      False     False         False   False   \n",
       "1              False   False      False     False         False   False   \n",
       "2              False   False      False     False         False   False   \n",
       "3              False   False      False     False         False   False   \n",
       "4              False   False      False     False         False   False   \n",
       "...              ...     ...        ...       ...           ...     ...   \n",
       "15885          False   False      False     False         False   False   \n",
       "15886          False   False      False     False         False   False   \n",
       "15887          False   False      False     False         False   False   \n",
       "15888          False   False      False     False         False   False   \n",
       "15889          False   False      False     False         False   False   \n",
       "\n",
       "       소분류_표백 및 세탁 보조제  소분류_해충 방지  소분류_핸드워시  소분류_헤어 스프레이  \n",
       "0                False      False     False        False  \n",
       "1                False      False     False        False  \n",
       "2                False      False     False        False  \n",
       "3                False      False     False        False  \n",
       "4                False      False     False        False  \n",
       "...                ...        ...       ...          ...  \n",
       "15885            False      False     False        False  \n",
       "15886            False      False     False        False  \n",
       "15887            False      False     False        False  \n",
       "15888            False      False     False        False  \n",
       "15889            False      False     False        False  \n",
       "\n",
       "[15890 rows x 531 columns]"
      ]
     },
     "execution_count": 325,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7b0547e0",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
